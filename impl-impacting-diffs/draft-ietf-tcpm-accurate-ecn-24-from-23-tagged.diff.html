<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by rfcdiff 1.45: rfcdiff  -->
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux c728f7009bdd 5.14.21-150400.24.38-default #1 SMP PREEMPT_DYNAMIC Fri Dec 9 09:29:22 UTC 2022 (e9c5676) x86_64 x86_64 x86_64 GNU/Linux -->
<!-- Using awk: /usr/bin/gawk: GNU Awk 5.1.0, API: 3.0 (GNU MPFR 4.1.0, GNU MP 6.2.1) -->
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.8 -->
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta http-equiv="Content-Style-Type" content="text/css"> 
  <title>Diff: draft-ietf-tcpm-accurate-ecn-23.txt - draft-ietf-tcpm-accurate-ecn-24.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
    span.hide { display: none; color: #aaa;}    a:hover span { display: inline; }    tr.change { background-color: gray; } 
    tr.change a { text-decoration: none; color: black } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('tr[id$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk;
    old_chunk.style.outline = "1px solid red";
    window.location.hash = "#" + new_str;
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
</head> 
<body> 
  <table border="0" cellspacing="0" cellpadding="0"> 
  <tbody><tr id="part-1" bgcolor="orange"><th><br>
</th><th>&nbsp;draft-ietf-tcpm-accurate-ecn-23.txt&nbsp;</th><th> <br>
</th><th>&nbsp;draft-ietf-tcpm-accurate-ecn-24.txt&nbsp;</th><th><br>
</th></tr> 
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">TCP Maintenance &amp; Minor Extensions (tcpm)                     B. Briscoe</td><td> </td><td class="right">TCP Maintenance &amp; Minor Extensions (tcpm)                     B. Briscoe</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Internet-Draft                                               Independent</td><td> </td><td class="right">Internet-Draft                                               Independent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Updates: 3168 (if approved)                                 M. Kühlewind</td><td> </td><td class="right">Updates: 3168 (if approved)                                 M. Kühlewind</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Intended status: Standards Track                                Ericsson</td><td> </td><td class="right">Intended status: Standards Track                                Ericsson</td><td class="lineno"><br></td></tr>
      <tr id="diff0001"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">Expires: <span class="delete">27 August</span> 2023                                 R. Scheffenegger</td><td> </td><td class="rblock">Expires: <span class="insert">1 October</span> 2023                                 R. Scheffenegger</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                                                                  NetApp</td><td> </td><td class="right">                                                                  NetApp</td><td class="lineno"><br></td></tr>
      <tr id="diff0002"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                                                        <span class="delete">23 February</span> 2023</td><td> </td><td class="rblock">                                                        <span class="insert">   30 March</span> 2023</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">  More Accurate Explicit Congestion Notification (ECN) Feedback in TCP</td><td> </td><td class="right">  More Accurate Explicit Congestion Notification (ECN) Feedback in TCP</td><td class="lineno"><br></td></tr>
      <tr id="diff0003"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                    draft-ietf-tcpm-accurate-ecn-2<span class="delete">3</span></td><td> </td><td class="rblock">                    draft-ietf-tcpm-accurate-ecn-2<span class="insert">4</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Explicit Congestion Notification (ECN) is a mechanism where network</td><td> </td><td class="right">   Explicit Congestion Notification (ECN) is a mechanism where network</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   nodes can mark IP packets instead of dropping them to indicate</td><td> </td><td class="right">   nodes can mark IP packets instead of dropping them to indicate</td><td class="lineno"><br></td></tr>
      <tr id="diff0004"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   incipient congestion to the <span class="delete">end-points.</span>  Receivers with an <span class="delete">ECN-</span></td><td> </td><td class="rblock">   incipient congestion to the <span class="insert">endpoints.</span>  Receivers with an <span class="insert">ECN-capable</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   capable</span> transport protocol feed back this information to the sender.</td><td> </td><td class="rblock">   transport protocol feed back this information to the sender.  ECN was</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN was originally specified for TCP in such a way that only one</td><td> </td><td class="rblock">   originally specified for TCP in such a way that only one feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   feedback signal can be transmitted per Round-Trip Time (RTT).  Recent</td><td> </td><td class="rblock">   signal can be transmitted per Round-Trip Time (RTT).  Recent new TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   new TCP mechanisms like Congestion Exposure (ConEx), Data Center TCP</td><td> </td><td class="rblock">   mechanisms like Congestion Exposure (ConEx), Data Center TCP (DCTCP)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   (DCTCP) or Low Latency, Low Loss, and Scalable Throughput (L4S) need</td><td> </td><td class="rblock">   or Low Latency, Low Loss, and Scalable Throughput (L4S) need more</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   more accurate ECN feedback information whenever more than one marking</td><td> </td><td class="rblock">   accurate ECN feedback information whenever more than one marking is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   is received in one RTT.  This document updates the original ECN</td><td> </td><td class="rblock">   received in one RTT.  This document updates the original ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specification in RFC 3168 to specify a scheme that provides more than</td><td> </td><td class="right">   specification in RFC 3168 to specify a scheme that provides more than</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   one feedback signal per RTT in the TCP header.  Given TCP header</td><td> </td><td class="right">   one feedback signal per RTT in the TCP header.  Given TCP header</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   space is scarce, it allocates a reserved header bit previously</td><td> </td><td class="right">   space is scarce, it allocates a reserved header bit previously</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   assigned to the ECN-Nonce.  It also overloads the two existing ECN</td><td> </td><td class="right">   assigned to the ECN-Nonce.  It also overloads the two existing ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   flags in the TCP header.  The resulting extra space is exploited to</td><td> </td><td class="right">   flags in the TCP header.  The resulting extra space is exploited to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feed back the IP-ECN field received during the 3-way handshake as</td><td> </td><td class="right">   feed back the IP-ECN field received during the 3-way handshake as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   well.  Supplementary feedback information can optionally be provided</td><td> </td><td class="right">   well.  Supplementary feedback information can optionally be provided</td><td class="lineno"><br></td></tr>
      <tr id="diff0005"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in <span class="delete">a</span> new TCP <span class="delete">option,</span> which <span class="delete">is</span> never used on the TCP SYN.  The</td><td> </td><td class="rblock">   in <span class="insert">two</span> new TCP <span class="insert">option alternatives,</span> which <span class="insert">are</span> never used on the TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   document also specifies the treatment of this updated TCP wire</td><td> </td><td class="rblock">   SYN.  The document also specifies the treatment of this updated TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   protocol by middleboxes.</td><td> </td><td class="rblock">   wire protocol by middleboxes.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Status of This Memo</td><td> </td><td class="right">Status of This Memo</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This Internet-Draft is submitted in full conformance with the</td><td> </td><td class="right">   This Internet-Draft is submitted in full conformance with the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   provisions of BCP 78 and BCP 79.</td><td> </td><td class="right">   provisions of BCP 78 and BCP 79.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Internet-Drafts are draft documents valid for a maximum of six months</td><td> </td><td class="right">   Internet-Drafts are draft documents valid for a maximum of six months</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and may be updated, replaced, or obsoleted by other documents at any</td><td> </td><td class="right">   and may be updated, replaced, or obsoleted by other documents at any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   time.  It is inappropriate to use Internet-Drafts as reference</td><td> </td><td class="right">   time.  It is inappropriate to use Internet-Drafts as reference</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   material or to cite them other than as "work in progress."</td><td> </td><td class="right">   material or to cite them other than as "work in progress."</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0006"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   This Internet-Draft will expire on <span class="delete">27 August</span> 2023.</td><td> </td><td class="rblock">   This Internet-Draft will expire on <span class="insert">1 October</span> 2023.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Copyright (c) 2023 IETF Trust and the persons identified as the</td><td> </td><td class="right">   Copyright (c) 2023 IETF Trust and the persons identified as the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td> </td><td class="right">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   license-info) in effect on the date of publication of this document.</td><td> </td><td class="right">   license-info) in effect on the date of publication of this document.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Please review these documents carefully, as they describe your rights</td><td> </td><td class="right">   Please review these documents carefully, as they describe your rights</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-2" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 50<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 50<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4</td><td> </td><td class="right">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.1.  Document Roadmap  . . . . . . . . . . . . . . . . . . . .   5</td><td> </td><td class="right">     1.1.  Document Roadmap  . . . . . . . . . . . . . . . . . . . .   5</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="right">     1.2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . .   6</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.3.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="right">     1.3.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   6</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.4.  Recap of Existing ECN feedback in IP/TCP  . . . . . . . .   7</td><td> </td><td class="right">     1.4.  Recap of Existing ECN feedback in IP/TCP  . . . . . . . .   7</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   2.  AccECN Protocol Overview and Rationale  . . . . . . . . . . .   8</td><td> </td><td class="right">   2.  AccECN Protocol Overview and Rationale  . . . . . . . . . . .   8</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.1.  Capability Negotiation  . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">     2.1.  Capability Negotiation  . . . . . . . . . . . . . . . . .   9</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.2.  Feedback Mechanism  . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     2.2.  Feedback Mechanism  . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.3.  Delayed ACKs and Resilience Against ACK Loss  . . . . . .  10</td><td> </td><td class="right">     2.3.  Delayed ACKs and Resilience Against ACK Loss  . . . . . .  10</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.4.  Feedback Metrics  . . . . . . . . . . . . . . . . . . . .  11</td><td> </td><td class="right">     2.4.  Feedback Metrics  . . . . . . . . . . . . . . . . . . . .  11</td><td class="lineno"><br></td></tr>
      <tr id="diff0007"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     2.5.  Generic (<span class="delete">Dumb) Reflector  . . .</span> . . . . . . . . . . . . .  12</td><td> </td><td class="rblock">     2.5.  Generic (<span class="insert">Mechanistic) Reflector</span> . . . . . . . . . . . . .  12</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   3.  AccECN Protocol Specification . . . . . . . . . . . . . . . .  13</td><td> </td><td class="right">   3.  AccECN Protocol Specification . . . . . . . . . . . . . . . .  13</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     3.1.  Negotiating to use AccECN . . . . . . . . . . . . . . . .  13</td><td> </td><td class="right">     3.1.  Negotiating to use AccECN . . . . . . . . . . . . . . . .  13</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.1.1.  Negotiation during the TCP handshake  . . . . . . . .  13</td><td> </td><td class="right">       3.1.1.  Negotiation during the TCP handshake  . . . . . . . .  13</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.1.2.  Backward Compatibility  . . . . . . . . . . . . . . .  14</td><td> </td><td class="right">       3.1.2.  Backward Compatibility  . . . . . . . . . . . . . . .  14</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.1.3.  Forward Compatibility . . . . . . . . . . . . . . . .  17</td><td> </td><td class="right">       3.1.3.  Forward Compatibility . . . . . . . . . . . . . . . .  17</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.1.4.  Retransmission of the SYN . . . . . . . . . . . . . .  17</td><td> </td><td class="right">       3.1.4.  Retransmission of the SYN . . . . . . . . . . . . . .  17</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.1.5.  Implications of AccECN Mode . . . . . . . . . . . . .  18</td><td> </td><td class="right">       3.1.5.  Implications of AccECN Mode . . . . . . . . . . . . .  18</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     3.2.  AccECN Feedback . . . . . . . . . . . . . . . . . . . . .  20</td><td> </td><td class="right">     3.2.  AccECN Feedback . . . . . . . . . . . . . . . . . . . . .  20</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.2.1.  Initialization of Feedback Counters . . . . . . . . .  20</td><td> </td><td class="right">       3.2.1.  Initialization of Feedback Counters . . . . . . . . .  20</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.2.2.  The ACE Field . . . . . . . . . . . . . . . . . . . .  21</td><td> </td><td class="right">       3.2.2.  The ACE Field . . . . . . . . . . . . . . . . . . . .  21</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-3" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-3"><em> page 3, line 36<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-3"><em> page 3, line 36<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.3.2.  Requirements for Transparent Middleboxes and TCP</td><td> </td><td class="right">       3.3.2.  Requirements for Transparent Middleboxes and TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">               Normalizers . . . . . . . . . . . . . . . . . . . . .  40</td><td> </td><td class="right">               Normalizers . . . . . . . . . . . . . . . . . . . . .  40</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.3.3.  Requirements for TCP ACK Filtering  . . . . . . . . .  41</td><td> </td><td class="right">       3.3.3.  Requirements for TCP ACK Filtering  . . . . . . . . .  41</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.3.4.  Requirements for TCP Segmentation Offload . . . . . .  42</td><td> </td><td class="right">       3.3.4.  Requirements for TCP Segmentation Offload . . . . . .  42</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   4.  Updates to RFC 3168 . . . . . . . . . . . . . . . . . . . . .  43</td><td> </td><td class="right">   4.  Updates to RFC 3168 . . . . . . . . . . . . . . . . . . . . .  43</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   5.  Interaction with TCP Variants . . . . . . . . . . . . . . . .  44</td><td> </td><td class="right">   5.  Interaction with TCP Variants . . . . . . . . . . . . . . . .  44</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     5.1.  Compatibility with SYN Cookies  . . . . . . . . . . . . .  44</td><td> </td><td class="right">     5.1.  Compatibility with SYN Cookies  . . . . . . . . . . . . .  44</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     5.2.  Compatibility with TCP Experiments and Common TCP</td><td> </td><td class="right">     5.2.  Compatibility with TCP Experiments and Common TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">           Options . . . . . . . . . . . . . . . . . . . . . . . . .  45</td><td> </td><td class="right">           Options . . . . . . . . . . . . . . . . . . . . . . . . .  45</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     5.3.  Compatibility with Feedback Integrity Mechanisms  . . . .  45</td><td> </td><td class="right">     5.3.  Compatibility with Feedback Integrity Mechanisms  . . . .  45</td><td class="lineno"><br></td></tr>
      <tr id="diff0008"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   6.  <span class="delete">Protocol Properties . . . . .</span> . . . . . . . . . . . . . . . .  46</td><td> </td><td class="rblock">   6.  <span class="insert">Summary: Protocol Properties </span> . . . . . . . . . . . . . . . .  46</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  48</td><td> </td><td class="right">   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  48</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  50</td><td> </td><td class="right">   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  50</td><td class="lineno"><br></td></tr>
      <tr id="diff0009"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   9.  <span class="delete">Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  51</span></td><td> </td><td class="rblock">   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  51</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   10. Comments Solicited  . . . . . . . . . . . . . . . . . . . . .  51</span></td><td> </td><td class="rblock">     <span class="insert">9.1.</span>  Normative References  . . . . . . . . . . . . . . . . . .  51</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   11.</span> References  . . . . . . . . . . . . . . . . . . . . . . . . .  51</td><td> </td><td class="rblock">     <span class="insert">9.2.</span>  Informative References  . . . . . . . . . . . . . . . . .  <span class="insert">51</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     <span class="delete">11.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  51</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     <span class="delete">11.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">52</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Appendix A.  Example Algorithms . . . . . . . . . . . . . . . . .  54</td><td> </td><td class="right">   Appendix A.  Example Algorithms . . . . . . . . . . . . . . . . .  54</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     A.1.  Example Algorithm to Encode/Decode the AccECN Option  . .  54</td><td> </td><td class="right">     A.1.  Example Algorithm to Encode/Decode the AccECN Option  . .  54</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     A.2.  Example Algorithm for Safety Against Long Sequences of ACK</td><td> </td><td class="right">     A.2.  Example Algorithm for Safety Against Long Sequences of ACK</td><td class="lineno"><br></td></tr>
      <tr id="diff0010"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">           Loss  . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">56</span></td><td> </td><td class="rblock">           Loss  . . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">55</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       A.2.1.  Safety Algorithm without the AccECN Option  . . . . .  <span class="delete">56</span></td><td> </td><td class="rblock">       A.2.1.  Safety Algorithm without the AccECN Option  . . . . .  <span class="insert">55</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       A.2.2.  Safety Algorithm with the AccECN Option . . . . . . .  58</td><td> </td><td class="right">       A.2.2.  Safety Algorithm with the AccECN Option . . . . . . .  58</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     A.3.  Example Algorithm to Estimate Marked Bytes from Marked</td><td> </td><td class="right">     A.3.  Example Algorithm to Estimate Marked Bytes from Marked</td><td class="lineno"><br></td></tr>
      <tr id="diff0011"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">           Packets . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">60</span></td><td> </td><td class="rblock">           Packets . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">59</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     A.4.  Example Algorithm to Count Not-ECT Bytes  . . . . . . . .  60</td><td> </td><td class="right">     A.4.  Example Algorithm to Count Not-ECT Bytes  . . . . . . . .  60</td><td class="lineno"><br></td></tr>
      <tr id="diff0012"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Appendix B.  Rationale for Usage of TCP Header Flags  . . . . . .  <span class="delete">61</span></td><td> </td><td class="rblock">   Appendix B.  Rationale for Usage of TCP Header Flags  . . . . . .  <span class="insert">60</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     B.1.  Three TCP Header Flags in the SYN-SYN/ACK Handshake . . .  <span class="delete">61</span></td><td> </td><td class="rblock">     B.1.  Three TCP Header Flags in the SYN-SYN/ACK Handshake . . .  <span class="insert">60</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     B.2.  Four Codepoints in the SYN/ACK  . . . . . . . . . . . . .  <span class="delete">62</span></td><td> </td><td class="rblock">     B.2.  Four Codepoints in the SYN/ACK  . . . . . . . . . . . . .  <span class="insert">61</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     B.3.  Space for Future Evolution  . . . . . . . . . . . . . . .  62</td><td> </td><td class="right">     B.3.  Space for Future Evolution  . . . . . . . . . . . . . . .  62</td><td class="lineno"><br></td></tr>
      <tr id="diff0013"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  63</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Comments Solicited  . . . . . . . . . . . . . . . . . . . . . . .  64</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  64</td><td> </td><td class="right">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  64</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Explicit Congestion Notification (ECN) [RFC3168] is a mechanism where</td><td> </td><td class="right">   Explicit Congestion Notification (ECN) [RFC3168] is a mechanism where</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   network nodes can mark IP packets instead of dropping them to</td><td> </td><td class="right">   network nodes can mark IP packets instead of dropping them to</td><td class="lineno"><br></td></tr>
      <tr id="diff0014"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   indicate incipient congestion to the end<span class="delete">-</span>points.  Receivers with an</td><td> </td><td class="rblock">   indicate incipient congestion to the endpoints.  Receivers with an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN-capable transport protocol feed back this information to the</td><td> </td><td class="right">   ECN-capable transport protocol feed back this information to the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   sender.  In RFC 3168, ECN was specified for TCP in such a way that</td><td> </td><td class="right">   sender.  In RFC 3168, ECN was specified for TCP in such a way that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   only one feedback signal could be transmitted per Round-Trip Time</td><td> </td><td class="right">   only one feedback signal could be transmitted per Round-Trip Time</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (RTT).  Recently, proposed mechanisms like Congestion Exposure (ConEx</td><td> </td><td class="right">   (RTT).  Recently, proposed mechanisms like Congestion Exposure (ConEx</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC7713]), DCTCP [RFC8257] or L4S [RFC9330] need to know when more</td><td> </td><td class="right">   [RFC7713]), DCTCP [RFC8257] or L4S [RFC9330] need to know when more</td><td class="lineno"><br></td></tr>
      <tr id="diff0015"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   than one marking is received in one RTT which is information that</td><td> </td><td class="rblock">   than one marking is received in one RTT<span class="insert">,</span> which is information that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   cannot be provided by the feedback scheme as specified in [RFC3168].</td><td> </td><td class="right">   cannot be provided by the feedback scheme as specified in [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This document specifies an update to the ECN feedback scheme of RFC</td><td> </td><td class="right">   This document specifies an update to the ECN feedback scheme of RFC</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   3168 that provides more accurate information and could be used by</td><td> </td><td class="right">   3168 that provides more accurate information and could be used by</td><td class="lineno"><br></td></tr>
      <tr id="diff0016"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   these and potentially other future TCP <span class="delete">extensions.</span>  A fuller</td><td> </td><td class="rblock">   these and potentially other future TCP <span class="insert">extensions, while still also</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   treatment of the motivation for this specification is given in the</td><td> </td><td class="rblock"><span class="insert">   supporting the pre-existing TCP congestion controllers that use just</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   associated requirements document [RFC7560].</td><td> </td><td class="rblock"><span class="insert">   one feedback signal per round.</span>  A fuller treatment of the motivation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   for this specification is given in the associated requirements</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   document [RFC7560].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0017"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   This document<span class="delete">s</span> specifies a standards track scheme for ECN feedback in</td><td> </td><td class="rblock">   This document specifies a standards track scheme for ECN feedback in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the TCP header to provide more than one feedback signal per RTT.  It</td><td> </td><td class="right">   the TCP header to provide more than one feedback signal per RTT.  It</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   will be called the more accurate ECN feedback scheme, or AccECN for</td><td> </td><td class="right">   will be called the more accurate ECN feedback scheme, or AccECN for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   short.  This document updates RFC 3168 with respect to negotiation</td><td> </td><td class="right">   short.  This document updates RFC 3168 with respect to negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and use of the feedback scheme for TCP.  All aspects of RFC 3168</td><td> </td><td class="right">   and use of the feedback scheme for TCP.  All aspects of RFC 3168</td><td class="lineno"><br></td></tr>
      <tr id="diff0018"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   other than the TCP feedback <span class="delete">scheme, in</span> particular the definition of</td><td> </td><td class="rblock">   other than the TCP feedback <span class="insert">scheme and its negotiation remain</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN at the IP <span class="delete">layer, remain unchanged by this specification.</span></td><td> </td><td class="rblock"><span class="insert">   unchanged by this specification.  In</span> particular the definition of ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section 4 gives a more detailed specification of exactly which</td><td> </td><td class="rblock">   at the IP <span class="insert">layer is unaffected.</span>  Section 4 gives a more detailed</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   aspects of RFC 3168 this document updates.</td><td> </td><td class="rblock">   specification of exactly which aspects of RFC 3168 this document</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   updates.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0019"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN is intended to <span class="delete">be</span> a complete replacement for classic <span class="delete">TCP/ECN</span></td><td> </td><td class="rblock">   AccECN is intended to <span class="insert">offer</span> a complete replacement for classic <span class="insert">TCP/</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   feedback, not a fork in the design of TCP.  AccECN feedback</td><td> </td><td class="rblock"><span class="insert">   ECN</span> feedback, not a fork in the design of TCP.  AccECN feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   complements TCP's loss feedback and it can coexist alongside</td><td> </td><td class="right">   complements TCP's loss feedback and it can coexist alongside</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   'classic' [RFC3168] TCP/ECN feedback.  So its applicability is</td><td> </td><td class="right">   'classic' [RFC3168] TCP/ECN feedback.  So its applicability is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   intended to include all public and private IP networks (and even any</td><td> </td><td class="right">   intended to include all public and private IP networks (and even any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   non-IP networks over which TCP is used today), whether or not any</td><td> </td><td class="right">   non-IP networks over which TCP is used today), whether or not any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   nodes on the path support ECN, of whatever flavour.  This document</td><td> </td><td class="right">   nodes on the path support ECN, of whatever flavour.  This document</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   uses the term Classic ECN when it needs to distinguish the RFC 3168</td><td> </td><td class="right">   uses the term Classic ECN when it needs to distinguish the RFC 3168</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN TCP feedback scheme from the AccECN TCP feedback scheme.</td><td> </td><td class="right">   ECN TCP feedback scheme from the AccECN TCP feedback scheme.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN feedback overloads the two existing ECN flags in the TCP</td><td> </td><td class="right">   AccECN feedback overloads the two existing ECN flags in the TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   header and allocates the currently reserved flag (previously called</td><td> </td><td class="right">   header and allocates the currently reserved flag (previously called</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-4" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-4"><em> page 5, line 36<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-4"><em> page 5, line 40<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   It is RECOMMENDED that the AccECN protocol is implemented alongside</td><td> </td><td class="right">   It is RECOMMENDED that the AccECN protocol is implemented alongside</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SACK [RFC2018] and the experimental ECN++ protocol</td><td> </td><td class="right">   SACK [RFC2018] and the experimental ECN++ protocol</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [I-D.ietf-tcpm-generalized-ecn], which allows the ECN capability to</td><td> </td><td class="right">   [I-D.ietf-tcpm-generalized-ecn], which allows the ECN capability to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   be used on TCP control packets.  Therefore, this specification does</td><td> </td><td class="right">   be used on TCP control packets.  Therefore, this specification does</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   not discuss implementing AccECN alongside [RFC5562], which was an</td><td> </td><td class="right">   not discuss implementing AccECN alongside [RFC5562], which was an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   earlier experimental protocol with narrower scope than ECN++.</td><td> </td><td class="right">   earlier experimental protocol with narrower scope than ECN++.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">1.1.  Document Roadmap</td><td> </td><td class="right">1.1.  Document Roadmap</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The following introductory section outlines the goals of AccECN</td><td> </td><td class="right">   The following introductory section outlines the goals of AccECN</td><td class="lineno"><br></td></tr>
      <tr id="diff0020"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   (Section 1.2).  <span class="delete">Then</span> terminology is defined (Section 1.3) and a recap</td><td> </td><td class="rblock">   (Section 1.2).  <span class="insert">Then,</span> terminology is defined (Section 1.3) and a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   of existing prerequisite technology is given (Section 1.4).</td><td> </td><td class="rblock">   recap of existing prerequisite technology is given (Section 1.4).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 2 gives an informative overview of the AccECN protocol.  Then</td><td> </td><td class="right">   Section 2 gives an informative overview of the AccECN protocol.  Then</td><td class="lineno"><br></td></tr>
      <tr id="diff0021"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section 3 gives the normative protocol specification, and Section 4</td><td> </td><td class="rblock">   Section 3 gives the normative protocol specification, and Section <span class="insert">3.3</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   clarifies which aspects of RFC 3168 are updated by <span class="delete">this</span></td><td> </td><td class="rblock"><span class="insert">   collects together requirements for proxies, offload engines and other</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   specification.</span>  Section 5 assesses the interaction of AccECN with</td><td> </td><td class="rblock"><span class="insert">   middleboxes.  Section</span> 4 clarifies which aspects of RFC 3168 are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   commonly used variants of TCP, whether standardized or not.</td><td> </td><td class="rblock">   updated by <span class="insert">AccECN.</span>  Section 5 assesses the interaction of AccECN with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   commonly used variants of TCP, whether standardized or not.  <span class="insert">Then</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 6 summarizes the features and properties of AccECN.</td><td> </td><td class="right">   Section 6 summarizes the features and properties of AccECN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 7 summarizes the protocol fields and numbers that IANA will</td><td> </td><td class="right">   Section 7 summarizes the protocol fields and numbers that IANA will</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   need to assign and Section 8 points to the aspects of the protocol</td><td> </td><td class="right">   need to assign and Section 8 points to the aspects of the protocol</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that will be of interest to the security community.</td><td> </td><td class="right">   that will be of interest to the security community.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Appendix A gives pseudocode examples for the various algorithms that</td><td> </td><td class="right">   Appendix A gives pseudocode examples for the various algorithms that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN uses and Appendix B explains why AccECN uses flags in the main</td><td> </td><td class="right">   AccECN uses and Appendix B explains why AccECN uses flags in the main</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP header and quantifies the space left for future use.</td><td> </td><td class="right">   TCP header and quantifies the space left for future use.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-5" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-5"><em> page 6, line 22<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-5"><em> page 6, line 26<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   will need to satisfy, under the headings: resilience, timeliness,</td><td> </td><td class="right">   will need to satisfy, under the headings: resilience, timeliness,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   integrity, accuracy (including ordering and lack of bias),</td><td> </td><td class="right">   integrity, accuracy (including ordering and lack of bias),</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   complexity, overhead and compatibility (both backward and forward).</td><td> </td><td class="right">   complexity, overhead and compatibility (both backward and forward).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   It recognizes that a perfect scheme that fully satisfies all the</td><td> </td><td class="right">   It recognizes that a perfect scheme that fully satisfies all the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   requirements is unlikely and trade-offs between requirements are</td><td> </td><td class="right">   requirements is unlikely and trade-offs between requirements are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   likely.  Section 6 presents the properties of AccECN against these</td><td> </td><td class="right">   likely.  Section 6 presents the properties of AccECN against these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   requirements and discusses the trade-offs made.</td><td> </td><td class="right">   requirements and discusses the trade-offs made.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The requirements document recognizes that a protocol as ubiquitous as</td><td> </td><td class="right">   The requirements document recognizes that a protocol as ubiquitous as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP needs to be able to serve as-yet-unspecified requirements.</td><td> </td><td class="right">   TCP needs to be able to serve as-yet-unspecified requirements.</td><td class="lineno"><br></td></tr>
      <tr id="diff0022"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Therefore an AccECN receiver <span class="delete">aims to act</span> as a generic <span class="delete">(dumb)</span></td><td> </td><td class="rblock">   Therefore an AccECN receiver <span class="insert">acts</span> as a generic <span class="insert">(mechanistic)</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   reflector of congestion information <span class="delete">so</span> that in future new sender</td><td> </td><td class="rblock">   reflector of congestion information <span class="insert">with the aim</span> that in future new</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   behaviours can be deployed unilaterally.</td><td> </td><td class="rblock">   sender behaviours can be deployed unilaterally.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">1.3.  Terminology</td><td> </td><td class="right">1.3.  Terminology</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN:  The more accurate ECN feedback scheme will be called AccECN</td><td> </td><td class="right">   AccECN:  The more accurate ECN feedback scheme will be called AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      for short.</td><td> </td><td class="right">      for short.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0023"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Classic ECN:  <span class="delete">t</span>he ECN protocol specified in [RFC3168].</td><td> </td><td class="rblock">   Classic ECN:  <span class="insert">T</span>he ECN protocol specified in [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0024"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Classic ECN feedback:  <span class="delete">t</span>he feedback aspect of the ECN protocol</td><td> </td><td class="rblock">   Classic ECN feedback:  <span class="insert">T</span>he feedback aspect of the ECN protocol</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      specified in [RFC3168], including generation, encoding,</td><td> </td><td class="right">      specified in [RFC3168], including generation, encoding,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      transmission and decoding of feedback, but not the Data Sender's</td><td> </td><td class="right">      transmission and decoding of feedback, but not the Data Sender's</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      subsequent response to that feedback.</td><td> </td><td class="right">      subsequent response to that feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK:  A TCP acknowledgement, with or without a data payload (ACK=1).</td><td> </td><td class="right">   ACK:  A TCP acknowledgement, with or without a data payload (ACK=1).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Pure ACK:  A TCP acknowledgement without a data payload.</td><td> </td><td class="right">   Pure ACK:  A TCP acknowledgement without a data payload.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Acceptable packet / segment:  A packet or segment that passes the</td><td> </td><td class="right">   Acceptable packet / segment:  A packet or segment that passes the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      acceptability tests in [RFC9293] and [RFC5961].</td><td> </td><td class="right">      acceptability tests in [RFC9293] and [RFC5961].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0025"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   TCP <span class="delete">c</span>lient:  The TCP stack that originates a connection.</td><td> </td><td class="rblock">   TCP <span class="insert">C</span>lient:  The TCP stack that originates a connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0026"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   TCP <span class="delete">s</span>erver:  The TCP stack that responds to a connection request.</td><td> </td><td class="rblock">   TCP <span class="insert">S</span>erver:  The TCP stack that responds to a connection request.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Data Receiver:  The endpoint of a TCP half-connection that receives</td><td> </td><td class="right">   Data Receiver:  The endpoint of a TCP half-connection that receives</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      data and sends AccECN feedback.</td><td> </td><td class="right">      data and sends AccECN feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Data Sender:  The endpoint of a TCP half-connection that sends data</td><td> </td><td class="right">   Data Sender:  The endpoint of a TCP half-connection that sends data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      and receives AccECN feedback.</td><td> </td><td class="right">      and receives AccECN feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0027"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">In a mild abuse of terminology, this document sometimes refers to</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   'TCP packets' instead of 'TCP segments'.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td> </td><td class="right">   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td> </td><td class="right">   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td> </td><td class="right">   "OPTIONAL" in this document are to be interpreted as described in BCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td> </td><td class="right">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   capitals, as shown here.</td><td> </td><td class="right">   capitals, as shown here.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">1.4.  Recap of Existing ECN feedback in IP/TCP</td><td> </td><td class="right">1.4.  Recap of Existing ECN feedback in IP/TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0028"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN [RFC3168] uses two <span class="delete">bits</span> in the IP header.  Once ECN has been</td><td> </td><td class="rblock">   ECN [RFC3168] uses <span class="insert">a</span> two <span class="insert">bit field</span> in the IP header.  Once ECN has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   negotiated <span class="delete">with the receiver at the</span> transport <span class="delete">layer, an ECN sender</span></td><td> </td><td class="rblock">   been negotiated <span class="insert">for a</span> transport <span class="insert">layer connection, the Data Sender for</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   can set two possible codepoints (ECT(0) or ECT(1)) in the IP header</td><td> </td><td class="rblock"><span class="insert">   either half-connection</span> can set two possible codepoints (ECT(0) or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   to indicate an ECN-capable transport (ECT).  If <span class="delete">both</span> ECN <span class="delete">bits are</span></td><td> </td><td class="rblock">   ECT(1)) in the IP header <span class="insert">of a data packet</span> to indicate an ECN-capable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   zero,</span> the packet is considered to have been sent by a Not-ECN-capable</td><td> </td><td class="rblock">   transport (ECT).  If <span class="insert">the</span> ECN <span class="insert">codepoint is 0b00,</span> the packet is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Transport <span class="delete">(Not-ECT).</span>  When a network node experiences congestion, it</td><td> </td><td class="rblock">   considered to have been sent by a Not-ECN-capable Transport <span class="insert">(Not-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   will occasionally either drop or mark a packet, with the choice</td><td> </td><td class="rblock"><span class="insert">   ECT).</span>  When a network node experiences congestion, it will</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   depending on the packet's ECN codepoint.  If the codepoint is <span class="delete">Not-</span></td><td> </td><td class="rblock">   occasionally either drop or mark a packet, with the choice depending</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   ECT,</span> only drop is appropriate.  If the codepoint is ECT(0) or ECT(1),</td><td> </td><td class="rblock">   on the packet's ECN codepoint.  If the codepoint is <span class="insert">Not-ECT,</span> only</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the node can mark the packet by setting <span class="delete">both</span> ECN <span class="delete">bits,</span> which is</td><td> </td><td class="rblock">   drop is appropriate.  If the codepoint is ECT(0) or ECT(1), the node</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   can mark the packet by setting <span class="insert">the</span> ECN <span class="insert">codepoint to 0b11,</span> which is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   termed 'Congestion Experienced' (CE), or loosely a 'congestion mark'.</td><td> </td><td class="right">   termed 'Congestion Experienced' (CE), or loosely a 'congestion mark'.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Table 1 summarises these codepoints.</td><td> </td><td class="right">   Table 1 summarises these codepoints.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +==================+================+===========================+</td><td> </td><td class="right">     +==================+================+===========================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | IP-ECN codepoint | Codepoint name | Description               |</td><td> </td><td class="right">     | IP-ECN codepoint | Codepoint name | Description               |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +==================+================+===========================+</td><td> </td><td class="right">     +==================+================+===========================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | 0b00             | Not-ECT        | Not ECN-Capable Transport |</td><td> </td><td class="right">     | 0b00             | Not-ECT        | Not ECN-Capable Transport |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +------------------+----------------+---------------------------+</td><td> </td><td class="right">     +------------------+----------------+---------------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | 0b01             | ECT(1)         | ECN-Capable Transport (1) |</td><td> </td><td class="right">     | 0b01             | ECT(1)         | ECN-Capable Transport (1) |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +------------------+----------------+---------------------------+</td><td> </td><td class="right">     +------------------+----------------+---------------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | 0b10             | ECT(0)         | ECN-Capable Transport (0) |</td><td> </td><td class="right">     | 0b10             | ECT(0)         | ECN-Capable Transport (0) |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +------------------+----------------+---------------------------+</td><td> </td><td class="right">     +------------------+----------------+---------------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | 0b11             | CE             | Congestion Experienced    |</td><td> </td><td class="right">     | 0b11             | CE             | Congestion Experienced    |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +------------------+----------------+---------------------------+</td><td> </td><td class="right">     +------------------+----------------+---------------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                  Table 1: The ECN Field in the IP Header</td><td> </td><td class="right">                  Table 1: The ECN Field in the IP Header</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0029"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   In the TCP header the first two bits in byte 14 are defined as flags</td><td> </td><td class="rblock">   In the TCP header the first two bits in byte 14 <span class="insert">(the TCP header flags</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   for the use of ECN <span class="delete">(CWR and ECE in Figure 1 [RFC3168]).</span>  A TCP <span class="delete">client</span></td><td> </td><td class="rblock"><span class="insert">   at bit offsets 8 and 9 labelled CWR and ECE in Figure 1)</span> are defined</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   indicates it supports ECN by setting ECE=CWR=1 in the SYN, and an</td><td> </td><td class="rblock">   as flags for the use of ECN <span class="insert">[RFC3168].</span>  A TCP <span class="insert">Client</span> indicates it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN-enabled <span class="delete">server</span> confirms ECN support by setting ECE=1 and CWR=0 in</td><td> </td><td class="rblock">   supports ECN by setting ECE=CWR=1 in the SYN, and an ECN-enabled <span class="insert">TCP</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the <span class="delete">SYN/ACK.</span>  On reception of a CE-marked packet at the IP layer, the</td><td> </td><td class="rblock"><span class="insert">   Server</span> confirms ECN support by setting ECE=1 and CWR=0 in the <span class="insert">SYN/</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Data Receiver starts to set the Echo Congestion Experienced (ECE)</td><td> </td><td class="rblock"><span class="insert">   ACK.</span>  On reception of a CE-marked packet at the IP layer, the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flag continuously in the TCP header of ACKs, which <span class="delete">ensures</span> the signal</td><td> </td><td class="rblock">   Receiver <span class="insert">for that half-connection</span> starts to set the Echo Congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">is received reliably even if ACKs are lost.</span>  The <span class="delete">TCP sender</span> confirms</td><td> </td><td class="rblock">   Experienced (ECE) flag continuously in the TCP header of ACKs, which</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   that it has received at least one ECE signal by responding with the</td><td> </td><td class="rblock">   <span class="insert">gives</span> the signal <span class="insert">resilience to loss or reordering of ACKs.</span>  The <span class="insert">Data</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   congestion window reduced (CWR) flag, which allows the <span class="delete">TCP receiver</span></td><td> </td><td class="rblock"><span class="insert">   Sender for the same half-connection</span> confirms that it has received at</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   to stop repeating the <span class="delete">ECN-Echo</span> flag.  This always leads to a full RTT</td><td> </td><td class="rblock">   least one ECE signal by responding with the congestion window reduced</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   of ACKs with ECE set.  Thus any additional CE markings arriving</td><td> </td><td class="rblock">   (CWR) flag, which allows the <span class="insert">Data Receiver</span> to stop repeating the <span class="insert">ECN-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   within this RTT cannot be fed back.</td><td> </td><td class="rblock"><span class="insert">   Echo</span> flag.  This always leads to a full RTT of ACKs with ECE set.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   Thus any additional CE markings arriving within this RTT cannot be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   fed back.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0030"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The last bit in byte 13 of the TCP header was defined as the Nonce</td><td> </td><td class="rblock">   The last bit in byte 13 of the TCP header <span class="insert">(the TCP header flag at bit</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Sum (NS) for the ECN Nonce [RFC3540].  In the absence of widespread</td><td> </td><td class="rblock"><span class="insert">   offset 7 in Figure 1)</span> was defined as the Nonce Sum (NS) for the ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   deployment RFC 3540 has been reclassified as historic [RFC8311] and</td><td> </td><td class="rblock">   Nonce [RFC3540].  In the absence of widespread deployment RFC 3540</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the respective flag has been marked as "reserved", making this TCP</td><td> </td><td class="rblock">   has been reclassified as historic [RFC8311] and the respective flag</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flag available for use by <span class="delete">the</span> AccECN <span class="delete">experiment</span> instead.</td><td> </td><td class="rblock">   has been marked as "reserved", making this TCP flag available for use</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   by AccECN instead.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td> </td><td class="right">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           | N | C | E | U | A | P | R | S | F |</td><td> </td><td class="right">     |               |           | N | C | E | U | A | P | R | S | F |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | Header Length | Reserved  | S | W | C | R | C | S | S | Y | I |</td><td> </td><td class="right">     | Header Length | Reserved  | S | W | C | R | C | S | S | Y | I |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           |   | R | E | G | K | H | T | N | N |</td><td> </td><td class="right">     |               |           |   | R | E | G | K | H | T | N | N |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     Figure 1: The (post-ECN Nonce) definition of the TCP header flags</td><td> </td><td class="right">     Figure 1: The (post-ECN Nonce) definition of the TCP header flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-6" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-6"><em> page 9, line 5<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-6"><em> page 9, line 5<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   acknowledgements, reusing data packets of the other half-connection</td><td> </td><td class="right">   acknowledgements, reusing data packets of the other half-connection</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whenever possible.</td><td> </td><td class="right">   whenever possible.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The AccECN protocol has had to be designed in two parts:</td><td> </td><td class="right">   The AccECN protocol has had to be designed in two parts:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  an essential part that re-uses ECN TCP header bits for the Data</td><td> </td><td class="right">   *  an essential part that re-uses ECN TCP header bits for the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Receiver to feed back the number of packets arriving with CE in</td><td> </td><td class="right">      Receiver to feed back the number of packets arriving with CE in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the IP-ECN field.  This provides more accuracy than classic ECN</td><td> </td><td class="right">      the IP-ECN field.  This provides more accuracy than classic ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback, but limited resilience against ACK loss;</td><td> </td><td class="right">      feedback, but limited resilience against ACK loss;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0031"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  a supplementary part using <span class="delete">a</span> new AccECN TCP <span class="delete">Option</span> that <span class="delete">provides</span></td><td> </td><td class="rblock">   *  a supplementary part using <span class="insert">one of two</span> new <span class="insert">alternative</span> AccECN TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      additional feedback on the number of bytes that arrive marked with</td><td> </td><td class="rblock">      <span class="insert">Options</span> that <span class="insert">provide</span> additional feedback on the number of bytes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      each of the three ECN codepoints in the IP-ECN field (not just CE</td><td> </td><td class="rblock">      that arrive marked with each of the three ECN codepoints in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      marks).  This provides greater resilience against ACK loss than</td><td> </td><td class="rblock">      IP-ECN field (not just CE marks).  This provides greater</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      the essential feedback, but it is more likely to suffer from</td><td> </td><td class="rblock">      resilience against ACK loss than the essential feedback, but it is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      middlebox interference.</td><td> </td><td class="rblock">      <span class="insert">currently</span> more likely to suffer from middlebox interference.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The two part design was necessary, given limitations on the space</td><td> </td><td class="right">   The two part design was necessary, given limitations on the space</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available for TCP options and given the possibility that certain</td><td> </td><td class="right">   available for TCP options and given the possibility that certain</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   incorrectly designed middleboxes prevent TCP using any new options.</td><td> </td><td class="right">   incorrectly designed middleboxes prevent TCP using any new options.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The essential part overloads the previous definition of the three</td><td> </td><td class="right">   The essential part overloads the previous definition of the three</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   flags in the TCP header that had been assigned for use by ECN.  This</td><td> </td><td class="right">   flags in the TCP header that had been assigned for use by ECN.  This</td><td class="lineno"><br></td></tr>
      <tr id="diff0032"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   design choice deliberately <span class="delete">replaces</span> the classic ECN feedback</td><td> </td><td class="rblock">   design choice deliberately <span class="insert">allows AccECN peers to replace</span> the classic</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   protocol, rather than leaving classic ECN feedback intact and adding</td><td> </td><td class="rblock">   ECN feedback protocol, rather than leaving classic ECN feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   more accurate feedback separately because:</td><td> </td><td class="rblock">   intact and adding more accurate feedback separately because:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  this efficiently reuses scarce TCP header space, given TCP option</td><td> </td><td class="right">   *  this efficiently reuses scarce TCP header space, given TCP option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      space is approaching saturation;</td><td> </td><td class="right">      space is approaching saturation;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  a single upgrade path for the TCP protocol is preferable to a fork</td><td> </td><td class="right">   *  a single upgrade path for the TCP protocol is preferable to a fork</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      in the design;</td><td> </td><td class="right">      in the design;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  otherwise classic and accurate ECN feedback could give conflicting</td><td> </td><td class="right">   *  otherwise classic and accurate ECN feedback could give conflicting</td><td class="lineno"><br></td></tr>
      <tr id="diff0033"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      feedback <span class="delete">on</span> the same segment, which could open up new security</td><td> </td><td class="rblock">      feedback <span class="insert">about</span> the same segment, which could open up new security</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      concerns and make implementations unnecessarily complex;</td><td> </td><td class="right">      concerns and make implementations unnecessarily complex;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  middleboxes are more likely to faithfully forward the TCP ECN</td><td> </td><td class="right">   *  middleboxes are more likely to faithfully forward the TCP ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      flags than newly defined areas of the TCP header.</td><td> </td><td class="right">      flags than newly defined areas of the TCP header.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN is designed to work even if the supplementary part is removed</td><td> </td><td class="right">   AccECN is designed to work even if the supplementary part is removed</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   or zeroed out, as long as the essential part gets through.</td><td> </td><td class="right">   or zeroed out, as long as the essential part gets through.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.1.  Capability Negotiation</td><td> </td><td class="right">2.1.  Capability Negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN is a change to the wire protocol of the main TCP header,</td><td> </td><td class="right">   AccECN is a change to the wire protocol of the main TCP header,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   therefore it can only be used if both endpoints have been upgraded to</td><td> </td><td class="right">   therefore it can only be used if both endpoints have been upgraded to</td><td class="lineno"><br></td></tr>
      <tr id="diff0034"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   understand it.  The TCP <span class="delete">client</span> signals support for AccECN on the</td><td> </td><td class="rblock">   understand it.  The TCP <span class="insert">Client</span> signals support for AccECN on the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   initial SYN of a connection and the TCP <span class="delete">server</span> signals whether it</td><td> </td><td class="rblock">   initial SYN of a connection and the TCP <span class="insert">Server</span> signals whether it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   supports AccECN on the SYN/ACK.  The TCP flags on the SYN that the</td><td> </td><td class="right">   supports AccECN on the SYN/ACK.  The TCP flags on the SYN that the</td><td class="lineno"><br></td></tr>
      <tr id="diff0035"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">client</span> uses to signal AccECN support have been carefully chosen so</td><td> </td><td class="rblock">   <span class="insert">TCP Client</span> uses to signal AccECN support have been carefully chosen</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   that a TCP <span class="delete">server</span> will interpret them as a request to support the</td><td> </td><td class="rblock">   so that a TCP <span class="insert">Server</span> will interpret them as a request to support the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   most recent variant of ECN feedback that it supports.  Then the</td><td> </td><td class="rblock">   most recent variant of ECN feedback that it supports.  Then the <span class="insert">TCP</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">client</span> falls back to the same variant of ECN feedback.</td><td> </td><td class="rblock"><span class="insert">   Client</span> falls back to the same variant of ECN feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0036"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   An AccECN TCP <span class="delete">client</span> does not send <span class="delete">the new</span> AccECN Option on the SYN</td><td> </td><td class="rblock">   An AccECN TCP <span class="insert">Client</span> does not send <span class="insert">an</span> AccECN Option on the SYN as SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   as SYN option space is limited.  The TCP <span class="delete">server</span> sends <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">   option space is limited.  The TCP <span class="insert">Server</span> sends <span class="insert">an</span> AccECN Option on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Option on the SYN/ACK and the <span class="delete">client</span> sends <span class="delete">it</span> on the first ACK to</td><td> </td><td class="rblock">   the SYN/ACK and the <span class="insert">TCP Client</span> sends <span class="insert">one</span> on the first ACK to test</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   test whether the network path forwards <span class="delete">the option</span> correctly.</td><td> </td><td class="rblock">   whether the network path forwards <span class="insert">these options</span> correctly.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.2.  Feedback Mechanism</td><td> </td><td class="right">2.2.  Feedback Mechanism</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A Data Receiver maintains four counters initialized at the start of</td><td> </td><td class="right">   A Data Receiver maintains four counters initialized at the start of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the half-connection.  Three count the number of arriving payload</td><td> </td><td class="right">   the half-connection.  Three count the number of arriving payload</td><td class="lineno"><br></td></tr>
      <tr id="diff0037"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   bytes <span class="delete">respectively</span> marked CE, ECT(1) and ECT(0) in the IP-ECN field.</td><td> </td><td class="rblock">   bytes marked CE, ECT(1) and ECT(0) in the IP-ECN field.  The fourth</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The fourth counts the number of packets arriving marked with a CE</td><td> </td><td class="rblock">   counts the number of packets arriving marked with a CE codepoint</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   codepoint (including control packets without payload if they are <span class="delete">CE-</span></td><td> </td><td class="rblock">   (including control packets without payload if they are <span class="insert">CE-marked).</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   marked).</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The Data Sender maintains four equivalent counters for the half</td><td> </td><td class="right">   The Data Sender maintains four equivalent counters for the half</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection, and the AccECN protocol is designed to ensure they will</td><td> </td><td class="right">   connection, and the AccECN protocol is designed to ensure they will</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   match the values in the Data Receiver's counters, albeit after a</td><td> </td><td class="right">   match the values in the Data Receiver's counters, albeit after a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   little delay.</td><td> </td><td class="right">   little delay.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Each ACK carries the three least significant bits (LSBs) of the</td><td> </td><td class="right">   Each ACK carries the three least significant bits (LSBs) of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packet-based CE counter using the ECN bits in the TCP header, now</td><td> </td><td class="right">   packet-based CE counter using the ECN bits in the TCP header, now</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   renamed the Accurate ECN (ACE) field (see Figure 3 later).  The 24</td><td> </td><td class="right">   renamed the Accurate ECN (ACE) field (see Figure 3 later).  The 24</td><td class="lineno"><br></td></tr>
      <tr id="diff0038"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   LSBs of <span class="delete">each</span> byte <span class="delete">counter are</span> carried in <span class="delete">the</span> AccECN Option.</td><td> </td><td class="rblock">   LSBs of <span class="insert">some or all of the</span> byte <span class="insert">counters can be optionally</span> carried in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">an</span> AccECN Option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.3.  Delayed ACKs and Resilience Against ACK Loss</td><td> </td><td class="right">2.3.  Delayed ACKs and Resilience Against ACK Loss</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   With both the ACE and the AccECN Option mechanisms, the Data Receiver</td><td> </td><td class="right">   With both the ACE and the AccECN Option mechanisms, the Data Receiver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   continually repeats the current LSBs of each of its respective</td><td> </td><td class="right">   continually repeats the current LSBs of each of its respective</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counters.  There is no need to acknowledge these continually repeated</td><td> </td><td class="right">   counters.  There is no need to acknowledge these continually repeated</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counters, so the congestion window reduced (CWR) mechanism is no</td><td> </td><td class="right">   counters, so the congestion window reduced (CWR) mechanism is no</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   longer used.  Even if some ACKs are lost, the Data Sender ought to be</td><td> </td><td class="right">   longer used.  Even if some ACKs are lost, the Data Sender ought to be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   able to infer how much to increment its own counters, even if the</td><td> </td><td class="right">   able to infer how much to increment its own counters, even if the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   protocol field has wrapped.</td><td> </td><td class="right">   protocol field has wrapped.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The 3-bit ACE field can wrap fairly frequently.  Therefore, even if</td><td> </td><td class="right">   The 3-bit ACE field can wrap fairly frequently.  Therefore, even if</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it appears to have incremented by one (say), the field might have</td><td> </td><td class="right">   it appears to have incremented by one (say), the field might have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   actually cycled completely then incremented by one.  The Data</td><td> </td><td class="right">   actually cycled completely then incremented by one.  The Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Receiver is not allowed to delay sending an ACK to such an extent</td><td> </td><td class="right">   Receiver is not allowed to delay sending an ACK to such an extent</td><td class="lineno"><br></td></tr>
      <tr id="diff0039"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   that the ACE field would cycle.  However <span class="delete">cycling is still a</span></td><td> </td><td class="rblock">   that the ACE field would cycle.  However <span class="insert">ACKs received</span> at the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   possibility</span> at the Data Sender because a whole sequence of ACKs</td><td> </td><td class="rblock">   Sender <span class="insert">could still cycle</span> because a whole sequence of ACKs carrying</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   carrying intervening values of the field might all be lost or delayed</td><td> </td><td class="rblock">   intervening values of the field might all be lost or delayed in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in transit.</td><td> </td><td class="rblock">   transit.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0040"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The fields in <span class="delete">the</span> AccECN Option are larger, but they will increment</td><td> </td><td class="rblock">   The fields in <span class="insert">an</span> AccECN Option are larger, but they will increment in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in larger steps because they count bytes not packets.  Nonetheless,</td><td> </td><td class="rblock">   larger steps because they count bytes not packets.  Nonetheless,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   their size has been chosen such that a whole cycle of the field would</td><td> </td><td class="right">   their size has been chosen such that a whole cycle of the field would</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   never occur between ACKs unless there had been an infeasibly long</td><td> </td><td class="right">   never occur between ACKs unless there had been an infeasibly long</td><td class="lineno"><br></td></tr>
      <tr id="diff0041"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   sequence of ACK losses.  Therefore, <span class="delete">as long as the</span> AccECN Option is</td><td> </td><td class="rblock">   sequence of ACK losses.  Therefore, <span class="insert">provided that an</span> AccECN Option is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available, it can be treated as a dependable feedback channel.</td><td> </td><td class="right">   available, it can be treated as a dependable feedback channel.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0042"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If <span class="delete">the</span> AccECN Option is not available, e.g. it is being stripped by a</td><td> </td><td class="rblock">   If <span class="insert">an</span> AccECN Option is not available, e.g. it is being stripped by a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   middlebox, the AccECN protocol will only feed back information on CE</td><td> </td><td class="right">   middlebox, the AccECN protocol will only feed back information on CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   markings (using the ACE field).  Although not ideal, this will be</td><td> </td><td class="right">   markings (using the ACE field).  Although not ideal, this will be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   sufficient, because it is envisaged that neither ECT(0) nor ECT(1)</td><td> </td><td class="right">   sufficient, because it is envisaged that neither ECT(0) nor ECT(1)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   will ever indicate more severe congestion than CE, even though future</td><td> </td><td class="right">   will ever indicate more severe congestion than CE, even though future</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   uses for ECT(0) or ECT(1) are still unclear [RFC8311].  Because the</td><td> </td><td class="right">   uses for ECT(0) or ECT(1) are still unclear [RFC8311].  Because the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   3-bit ACE field is so small, when it is the only field available, the</td><td> </td><td class="right">   3-bit ACE field is so small, when it is the only field available, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Data Sender has to interpret it assuming the most likely wrap, but</td><td> </td><td class="right">   Data Sender has to interpret it assuming the most likely wrap, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with a degree of conservatism.</td><td> </td><td class="right">   with a degree of conservatism.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Certain specified events trigger the Data Receiver to include an</td><td> </td><td class="right">   Certain specified events trigger the Data Receiver to include an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN Option on an ACK.  The rules are designed to ensure that the</td><td> </td><td class="right">   AccECN Option on an ACK.  The rules are designed to ensure that the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   order in which different markings arrive at the receiver is</td><td> </td><td class="right">   order in which different markings arrive at the receiver is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   communicated to the sender (as long as options are reaching the</td><td> </td><td class="right">   communicated to the sender (as long as options are reaching the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   sender and as long as there is no ACK loss).  Implementations are</td><td> </td><td class="right">   sender and as long as there is no ACK loss).  Implementations are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   encouraged to send an AccECN Option more frequently, but this is left</td><td> </td><td class="right">   encouraged to send an AccECN Option more frequently, but this is left</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   up to the implementer.</td><td> </td><td class="right">   up to the implementer.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.4.  Feedback Metrics</td><td> </td><td class="right">2.4.  Feedback Metrics</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0043"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The CE packet counter in the ACE field and the CE byte counter in <span class="delete">the</span></td><td> </td><td class="rblock">   The CE packet counter in the ACE field and the CE byte counter in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN <span class="delete">Option</span> both provide feedback on received CE-marks.  The CE</td><td> </td><td class="rblock">   AccECN <span class="insert">Options</span> both provide feedback on received CE-marks.  The CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packet counter includes control packets that do not have payload</td><td> </td><td class="right">   packet counter includes control packets that do not have payload</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   data, while the CE byte counter solely includes marked payload bytes.</td><td> </td><td class="right">   data, while the CE byte counter solely includes marked payload bytes.</td><td class="lineno"><br></td></tr>
      <tr id="diff0044"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If both are present, the byte counter in <span class="delete">the option</span> will provide the</td><td> </td><td class="rblock">   If both are present, the byte counter in <span class="insert">an AccECN Option</span> will</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   more accurate information needed for modern congestion control and</td><td> </td><td class="rblock">   provide the more accurate information needed for modern congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   policing schemes, such as L4S, DCTCP or ConEx.  If <span class="delete">the option is</span></td><td> </td><td class="rblock">   control and policing schemes, such as L4S, DCTCP or ConEx.  If <span class="insert">AccECN</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   stripped, a simple algorithm to estimate the number of marked bytes</td><td> </td><td class="rblock"><span class="insert">   Options are</span> stripped, a simple algorithm to estimate the number of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   from the ACE field is given in Appendix A.3.</td><td> </td><td class="rblock">   marked bytes from the ACE field is given in Appendix A.3.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0045"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Feedback in bytes is provided <span class="delete">in order</span> to protect against the</td><td> </td><td class="rblock">   Feedback in bytes is provided to protect against the receiver <span class="insert">or a</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   receiver using attacks similar to 'ACK-Division' to artificially</td><td> </td><td class="rblock"><span class="insert">   middlebox</span> using attacks similar to 'ACK-Division' to artificially</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   inflate the congestion window, which is why [RFC5681] now recommends</td><td> </td><td class="right">   inflate the congestion window, which is why [RFC5681] now recommends</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that TCP counts acknowledged bytes not packets.</td><td> </td><td class="right">   that TCP counts acknowledged bytes not packets.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0046"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">2.5.  Generic (<span class="delete">Dumb</span>) Reflector</td><td> </td><td class="rblock">2.5.  Generic (<span class="insert">Mechanistic</span>) Reflector</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The ACE field provides feedback about CE markings in the IP-ECN field</td><td> </td><td class="right">   The ACE field provides feedback about CE markings in the IP-ECN field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of both data and control packets.  According to [RFC3168] the Data</td><td> </td><td class="right">   of both data and control packets.  According to [RFC3168] the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Sender is meant to set the IP-ECN field of control packets to Not-</td><td> </td><td class="right">   Sender is meant to set the IP-ECN field of control packets to Not-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECT.  However, mechanisms in certain private networks (e.g. data</td><td> </td><td class="right">   ECT.  However, mechanisms in certain private networks (e.g. data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   centres) set control packets to be ECN capable because they are</td><td> </td><td class="right">   centres) set control packets to be ECN capable because they are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   precisely the packets that performance depends on most.</td><td> </td><td class="right">   precisely the packets that performance depends on most.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   For this reason, AccECN is designed to be a generic reflector of</td><td> </td><td class="right">   For this reason, AccECN is designed to be a generic reflector of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whatever ECN markings it sees, whether or not they are compliant with</td><td> </td><td class="right">   whatever ECN markings it sees, whether or not they are compliant with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   a current standard.  Then as standards evolve, Data Senders can</td><td> </td><td class="right">   a current standard.  Then as standards evolve, Data Senders can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   upgrade unilaterally without any need for receivers to upgrade too.</td><td> </td><td class="right">   upgrade unilaterally without any need for receivers to upgrade too.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   It is also useful to be able to rely on generic reflection behaviour</td><td> </td><td class="right">   It is also useful to be able to rely on generic reflection behaviour</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   when senders need to test for unexpected interference with markings</td><td> </td><td class="right">   when senders need to test for unexpected interference with markings</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (for instance Section 3.2.2.3, Section 3.2.2.4 and Section 3.2.3.2 of</td><td> </td><td class="right">   (for instance Section 3.2.2.3, Section 3.2.2.4 and Section 3.2.3.2 of</td><td class="lineno"><br></td></tr>
      <tr id="diff0047"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the present document and para 2 of Section 20.2 of [RFC3168]).</td><td> </td><td class="rblock">   the present document and para<span class="insert">graph</span> 2 of Section 20.2 of [RFC3168]).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The initial SYN is the most critical control packet, so AccECN</td><td> </td><td class="right">   The initial SYN is the most critical control packet, so AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   provides feedback on its IP-ECN field.  Although RFC 3168 prohibits</td><td> </td><td class="right">   provides feedback on its IP-ECN field.  Although RFC 3168 prohibits</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   an ECN-capable SYN, providing feedback of ECN marking on the SYN</td><td> </td><td class="right">   an ECN-capable SYN, providing feedback of ECN marking on the SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   supports future scenarios in which SYNs might be ECN-enabled (without</td><td> </td><td class="right">   supports future scenarios in which SYNs might be ECN-enabled (without</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   prejudging whether they ought to be).  For instance, [RFC8311]</td><td> </td><td class="right">   prejudging whether they ought to be).  For instance, [RFC8311]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   updates this aspect of RFC 3168 to allow experimentation with ECN-</td><td> </td><td class="right">   updates this aspect of RFC 3168 to allow experimentation with ECN-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   capable TCP control packets.</td><td> </td><td class="right">   capable TCP control packets.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0048"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Even if the TCP <span class="delete">client (or s</span>erver) has set the SYN (or SYN/ACK) to</td><td> </td><td class="rblock">   Even if the TCP <span class="insert">Client (or S</span>erver) has set the SYN (or SYN/ACK) to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   not-ECT in compliance with RFC 3168, feedback on the state of the IP-</td><td> </td><td class="right">   not-ECT in compliance with RFC 3168, feedback on the state of the IP-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN field when it arrives at the receiver could still be useful,</td><td> </td><td class="right">   ECN field when it arrives at the receiver could still be useful,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   because middleboxes have been known to overwrite the IP-ECN field as</td><td> </td><td class="right">   because middleboxes have been known to overwrite the IP-ECN field as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   if it is still part of the old Type of Service (ToS) field</td><td> </td><td class="right">   if it is still part of the old Type of Service (ToS) field</td><td class="lineno"><br></td></tr>
      <tr id="diff0049"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   [Mandalari18].  For example, if a TCP <span class="delete">c</span>lient has set the SYN to Not-</td><td> </td><td class="rblock">   [Mandalari18].  For example, if a TCP <span class="insert">C</span>lient has set the SYN to Not-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECT, but receives feedback that the IP-ECN field on the SYN arrived</td><td> </td><td class="right">   ECT, but receives feedback that the IP-ECN field on the SYN arrived</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with a different codepoint, it can detect such middlebox</td><td> </td><td class="right">   with a different codepoint, it can detect such middlebox</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   interference.  Previously, neither end knew what IP-ECN field the</td><td> </td><td class="right">   interference.  Previously, neither end knew what IP-ECN field the</td><td class="lineno"><br></td></tr>
      <tr id="diff0050"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   other had sent.  So, if a TCP <span class="delete">s</span>erver received ECT or CE on a SYN, it</td><td> </td><td class="rblock">   other had sent.  So, if a TCP <span class="insert">S</span>erver received ECT or CE on a SYN, it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   could not know whether it was invalid (or valid) because only the TCP</td><td> </td><td class="right">   could not know whether it was invalid (or valid) because only the TCP</td><td class="lineno"><br></td></tr>
      <tr id="diff0051"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">c</span>lient knew whether it originally marked the SYN as Not-ECT (or ECT).</td><td> </td><td class="rblock">   <span class="insert">C</span>lient knew whether it originally marked the SYN as Not-ECT (or ECT).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Therefore, prior to AccECN, the server's only safe course of action</td><td> </td><td class="right">   Therefore, prior to AccECN, the server's only safe course of action</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in this example was to disable ECN for the connection.  Instead, the</td><td> </td><td class="right">   in this example was to disable ECN for the connection.  Instead, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN protocol allows the server to feed back the received ECN field</td><td> </td><td class="right">   AccECN protocol allows the server to feed back the received ECN field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to the client, which then has all the information to decide whether</td><td> </td><td class="right">   to the client, which then has all the information to decide whether</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the connection has to fall-back from supporting ECN (or not).</td><td> </td><td class="right">   the connection has to fall-back from supporting ECN (or not).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.  AccECN Protocol Specification</td><td> </td><td class="right">3.  AccECN Protocol Specification</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.  Negotiating to use AccECN</td><td> </td><td class="right">3.1.  Negotiating to use AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.1.  Negotiation during the TCP handshake</td><td> </td><td class="right">3.1.1.  Negotiation during the TCP handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Given the ECN Nonce [RFC3540] has been reclassified as historic</td><td> </td><td class="right">   Given the ECN Nonce [RFC3540] has been reclassified as historic</td><td class="lineno"><br></td></tr>
      <tr id="diff0052"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   [RFC8311], the <span class="delete">present specification re-allocates the</span> TCP flag <span class="delete">at bit</span></td><td> </td><td class="rblock">   [RFC8311], the TCP flag <span class="insert">that</span> was previously called NS (Nonce <span class="insert">Sum) is</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   7 of the TCP header, which</span> was previously called NS (Nonce <span class="delete">Sum),</span> as</td><td> </td><td class="rblock"><span class="insert">   renamed</span> as the AE (Accurate ECN) flag <span class="insert">(the TCP header flag at bit</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the AE (Accurate ECN) flag <span class="delete">(see</span> IANA Considerations in Section <span class="delete">7) as</span></td><td> </td><td class="rblock"><span class="insert">   offset 7 in Figure 2).  See the</span> IANA Considerations in Section <span class="insert">7.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   shown below.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td> </td><td class="right">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           | A | C | E | U | A | P | R | S | F |</td><td> </td><td class="right">     |               |           | A | C | E | U | A | P | R | S | F |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | Header Length | Reserved  | E | W | C | R | C | S | S | Y | I |</td><td> </td><td class="right">     | Header Length | Reserved  | E | W | C | R | C | S | S | Y | I |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           |   | R | E | G | K | H | T | N | N |</td><td> </td><td class="right">     |               |           |   | R | E | G | K | H | T | N | N |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       Figure 2: The (post-AccECN) definition of the TCP header flags</td><td> </td><td class="right">       Figure 2: The (post-AccECN) definition of the TCP header flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                          during the TCP handshake</td><td> </td><td class="right">                          during the TCP handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   During the TCP handshake at the start of a connection, to request</td><td> </td><td class="right">   During the TCP handshake at the start of a connection, to request</td><td class="lineno"><br></td></tr>
      <tr id="diff0053"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   more accurate ECN feedback the TCP <span class="delete">c</span>lient (host A) MUST set the TCP</td><td> </td><td class="rblock">   more accurate ECN feedback the TCP <span class="insert">C</span>lient (host A) MUST set the TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   flags AE=1, CWR=1 and ECE=1 in the initial SYN segment.</td><td> </td><td class="right">   flags AE=1, CWR=1 and ECE=1 in the initial SYN segment.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0054"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If a TCP <span class="delete">s</span>erver (B) that is AccECN-enabled receives a SYN with the</td><td> </td><td class="rblock">   If a TCP <span class="insert">S</span>erver (B) that is AccECN-enabled receives a SYN with the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   above three flags set, it MUST set both its half connections into</td><td> </td><td class="right">   above three flags set, it MUST set both its half connections into</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN mode.  Then it MUST set the AE, CWR and ECE TCP flags on the</td><td> </td><td class="right">   AccECN mode.  Then it MUST set the AE, CWR and ECE TCP flags on the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN/ACK to the combination in the top block of Table 2 that feeds</td><td> </td><td class="right">   SYN/ACK to the combination in the top block of Table 2 that feeds</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   back the IP-ECN field that arrived on the SYN.  This applies whether</td><td> </td><td class="right">   back the IP-ECN field that arrived on the SYN.  This applies whether</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   or not the server itself supports setting the IP-ECN field on a SYN</td><td> </td><td class="right">   or not the server itself supports setting the IP-ECN field on a SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   or SYN/ACK (see Section 2.5 for rationale).</td><td> </td><td class="right">   or SYN/ACK (see Section 2.5 for rationale).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0055"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   When the TCP <span class="delete">s</span>erver returns any of the 4 combinations in the top</td><td> </td><td class="rblock">   When the TCP <span class="insert">S</span>erver returns any of the 4 combinations in the top</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   block of Table 2, it confirms that it supports AccECN.  The TCP</td><td> </td><td class="right">   block of Table 2, it confirms that it supports AccECN.  The TCP</td><td class="lineno"><br></td></tr>
      <tr id="diff0056"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">s</span>erver MUST NOT set one of these 4 combination of flags on the SYN/</td><td> </td><td class="rblock">   <span class="insert">S</span>erver MUST NOT set one of these 4 combination of flags on the SYN/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK unless the preceding SYN requested support for AccECN as above.</td><td> </td><td class="right">   ACK unless the preceding SYN requested support for AccECN as above.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0057"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Once a TCP <span class="delete">c</span>lient (A) has sent the above SYN to declare that it</td><td> </td><td class="rblock">   Once a TCP <span class="insert">C</span>lient (A) has sent the above SYN to declare that it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   supports AccECN, and once it has received the above SYN/ACK segment</td><td> </td><td class="right">   supports AccECN, and once it has received the above SYN/ACK segment</td><td class="lineno"><br></td></tr>
      <tr id="diff0058"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   that confirms that the TCP <span class="delete">server supports AccECN, the TCP c</span>lient</td><td> </td><td class="rblock">   that confirms that the TCP <span class="insert">Server supports AccECN, the TCP C</span>lient</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   MUST set both its half connections into AccECN mode.</td><td> </td><td class="right">   MUST set both its half connections into AccECN mode.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0059"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Once in AccECN mode, a TCP <span class="delete">client or s</span>erver has the rights and</td><td> </td><td class="rblock">   Once in AccECN mode, a TCP <span class="insert">Client or S</span>erver has the rights and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   obligations to participate in the ECN protocol defined in</td><td> </td><td class="right">   obligations to participate in the ECN protocol defined in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.1.5.</td><td> </td><td class="right">   Section 3.1.5.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0060"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The procedure for the <span class="delete">client</span> to follow if a SYN/ACK does not arrive</td><td> </td><td class="rblock">   The procedure for the <span class="insert">TCP Client</span> to follow if a SYN/ACK does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   before its retransmission timer expires is given in Section 3.1.4.</td><td> </td><td class="rblock">   arrive before its retransmission timer expires is given in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If more than one SYN arrives at the TCP <span class="delete">server</span> (B), the above</td><td> </td><td class="rblock">   Section 3.1.4.  If more than one SYN arrives at the TCP <span class="insert">Server</span> (B),</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   requirement to set the TCP flags on the SYN/ACK MUST feed back the</td><td> </td><td class="rblock">   the above requirement to set the TCP flags on the SYN/ACK MUST feed</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   IP-ECN field on the latest SYN to arrive.</td><td> </td><td class="rblock">   back the IP-ECN field on the latest SYN to arrive.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.2.  Backward Compatibility</td><td> </td><td class="right">3.1.2.  Backward Compatibility</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The three flags set to 1 to indicate AccECN support on the SYN have</td><td> </td><td class="right">   The three flags set to 1 to indicate AccECN support on the SYN have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   been carefully chosen to enable natural fall-back to prior stages in</td><td> </td><td class="right">   been carefully chosen to enable natural fall-back to prior stages in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the evolution of ECN, as above.  Table 2 tabulates all the</td><td> </td><td class="right">   the evolution of ECN, as above.  Table 2 tabulates all the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   negotiation possibilities for ECN-related capabilities that involve</td><td> </td><td class="right">   negotiation possibilities for ECN-related capabilities that involve</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   at least one AccECN-capable host.  The entries in the first two</td><td> </td><td class="right">   at least one AccECN-capable host.  The entries in the first two</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   columns have been abbreviated, as follows:</td><td> </td><td class="right">   columns have been abbreviated, as follows:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-7" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-7"><em> page 15, line 35<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-7"><em> page 15, line 35<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | Broken | 1   1   1  | 1   1   1  | Not ECN              |</td><td> </td><td class="right">   | AccECN | Broken | 1   1   1  | 1   1   1  | Not ECN              |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        Table 2: ECN capability negotiation between Client (A) and</td><td> </td><td class="right">        Table 2: ECN capability negotiation between Client (A) and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                                Server (B)</td><td> </td><td class="right">                                Server (B)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Table 2 is divided into blocks each separated by an empty row.</td><td> </td><td class="right">   Table 2 is divided into blocks each separated by an empty row.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   1.  The top block shows the case already described in Section 3.1</td><td> </td><td class="right">   1.  The top block shows the case already described in Section 3.1</td><td class="lineno"><br></td></tr>
      <tr id="diff0061"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       where both endpoints support AccECN and how the TCP <span class="delete">s</span>erver (B)</td><td> </td><td class="rblock">       where both endpoints support AccECN and how the TCP <span class="insert">S</span>erver (B)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       indicates congestion feedback.</td><td> </td><td class="right">       indicates congestion feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0062"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   2.  The second block shows the cases where the TCP <span class="delete">client</span> (A)</td><td> </td><td class="rblock">   2.  The second block shows the cases where the TCP <span class="insert">Client</span> (A)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       supports AccECN but the TCP <span class="delete">server</span> (B) supports some earlier</td><td> </td><td class="rblock">       supports AccECN but the TCP <span class="insert">Server</span> (B) supports some earlier</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       variant of TCP feedback, indicated in its SYN/ACK.  Therefore, as</td><td> </td><td class="right">       variant of TCP feedback, indicated in its SYN/ACK.  Therefore, as</td><td class="lineno"><br></td></tr>
      <tr id="diff0063"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       soon as an AccECN-capable TCP <span class="delete">c</span>lient (A) receives the SYN/ACK</td><td> </td><td class="rblock">       soon as an AccECN-capable TCP <span class="insert">C</span>lient (A) receives the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       shown it MUST set both its half connections into the feedback</td><td> </td><td class="right">       shown it MUST set both its half connections into the feedback</td><td class="lineno"><br></td></tr>
      <tr id="diff0064"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       mode shown in the rightmost column.  If <span class="delete">it</span> has set itself into</td><td> </td><td class="rblock">       mode shown in the rightmost column.  If <span class="insert">the TCP Client</span> has set</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       classic ECN feedback mode it MUST then comply with [RFC3168].</td><td> </td><td class="rblock">       itself into classic ECN feedback mode it MUST then comply with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">       [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       The server response called 'Nonce' in the table is now historic.</td><td> </td><td class="right">       The server response called 'Nonce' in the table is now historic.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       For an AccECN implementation, there is no need to recognize or</td><td> </td><td class="right">       For an AccECN implementation, there is no need to recognize or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       support ECN Nonce feedback [RFC3540], which has been reclassified</td><td> </td><td class="right">       support ECN Nonce feedback [RFC3540], which has been reclassified</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       as historic [RFC8311].  AccECN is compatible with alternative ECN</td><td> </td><td class="right">       as historic [RFC8311].  AccECN is compatible with alternative ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       feedback integrity approaches (see Section 5.3).</td><td> </td><td class="right">       feedback integrity approaches (see Section 5.3).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0065"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   3.  The third block shows the cases where the TCP <span class="delete">server</span> (B) supports</td><td> </td><td class="rblock">   3.  The third block shows the cases where the TCP <span class="insert">Server</span> (B) supports</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       AccECN but the TCP <span class="delete">client</span> (A) supports some earlier variant of</td><td> </td><td class="rblock">       AccECN but the TCP <span class="insert">Client</span> (A) supports some earlier variant of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       TCP feedback, indicated in its SYN.</td><td> </td><td class="right">       TCP feedback, indicated in its SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0066"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       When an AccECN-enabled TCP <span class="delete">s</span>erver (B) receives a SYN with</td><td> </td><td class="rblock">       When an AccECN-enabled TCP <span class="insert">S</span>erver (B) receives a SYN with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       AE,CWR,ECE = 0,1,1 it MUST do one of the following:</td><td> </td><td class="right">       AE,CWR,ECE = 0,1,1 it MUST do one of the following:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       *  set both its half connections into the classic ECN feedback</td><td> </td><td class="right">       *  set both its half connections into the classic ECN feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          mode and return a SYN/ACK with AE, CWR, ECE = 0,0,1 as shown.</td><td> </td><td class="right">          mode and return a SYN/ACK with AE, CWR, ECE = 0,0,1 as shown.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          Then it MUST comply with [RFC3168].</td><td> </td><td class="right">          Then it MUST comply with [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       *  set both its half-connections into No ECN mode and return a</td><td> </td><td class="right">       *  set both its half-connections into No ECN mode and return a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          SYN/ACK with AE,CWR,ECE = 0,0,0, then continue with ECN</td><td> </td><td class="right">          SYN/ACK with AE,CWR,ECE = 0,0,0, then continue with ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          disabled.  This latter case is unlikely to be desirable, but</td><td> </td><td class="right">          disabled.  This latter case is unlikely to be desirable, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          it is allowed as a possibility, e.g. for minimal TCP</td><td> </td><td class="right">          it is allowed as a possibility, e.g. for minimal TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          implementations.</td><td> </td><td class="right">          implementations.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0067"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       When an AccECN-enabled TCP <span class="delete">s</span>erver (B) receives a SYN with</td><td> </td><td class="rblock">       When an AccECN-enabled TCP <span class="insert">S</span>erver (B) receives a SYN with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       AE,CWR,ECE = 0,0,0 it MUST set both its half connections into the</td><td> </td><td class="right">       AE,CWR,ECE = 0,0,0 it MUST set both its half connections into the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       Not ECN feedback mode, return a SYN/ACK with AE,CWR,ECE = 0,0,0</td><td> </td><td class="right">       Not ECN feedback mode, return a SYN/ACK with AE,CWR,ECE = 0,0,0</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       as shown and continue with ECN disabled.</td><td> </td><td class="right">       as shown and continue with ECN disabled.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   4.  The fourth block displays a combination labelled `Broken'.  Some</td><td> </td><td class="right">   4.  The fourth block displays a combination labelled `Broken'.  Some</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       older TCP server implementations incorrectly set the reserved</td><td> </td><td class="right">       older TCP server implementations incorrectly set the reserved</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       flags in the SYN/ACK by reflecting those in the SYN.  Such broken</td><td> </td><td class="right">       flags in the SYN/ACK by reflecting those in the SYN.  Such broken</td><td class="lineno"><br></td></tr>
      <tr id="diff0068"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       TCP <span class="delete">servers</span> (B) cannot support ECN, so as soon as an AccECN-</td><td> </td><td class="rblock">       TCP <span class="insert">Servers</span> (B) cannot support ECN, so as soon as an AccECN-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       capable TCP <span class="delete">client</span> (A) receives such a broken SYN/ACK it MUST</td><td> </td><td class="rblock">       capable TCP <span class="insert">Client</span> (A) receives such a broken SYN/ACK it MUST</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       fall back to Not ECN mode for both its half connections and</td><td> </td><td class="right">       fall back to Not ECN mode for both its half connections and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       continue with ECN disabled.</td><td> </td><td class="right">       continue with ECN disabled.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The following additional rules do not fit the structure of the table,</td><td> </td><td class="right">   The following additional rules do not fit the structure of the table,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   but they complement it:</td><td> </td><td class="right">   but they complement it:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Simultaneous Open:  An originating AccECN Host (A), having sent a SYN</td><td> </td><td class="right">   Simultaneous Open:  An originating AccECN Host (A), having sent a SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      with AE=1, CWR=1 and ECE=1, might receive another SYN from host B.</td><td> </td><td class="right">      with AE=1, CWR=1 and ECE=1, might receive another SYN from host B.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Host A MUST then enter the same feedback mode as it would have</td><td> </td><td class="right">      Host A MUST then enter the same feedback mode as it would have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      entered had it been a responding host and received the same SYN.</td><td> </td><td class="right">      entered had it been a responding host and received the same SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-8" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-8"><em> page 17, line 7<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-8"><em> page 17, line 7<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   In-window SYN during TIME-WAIT:  Many TCP implementations create a</td><td> </td><td class="right">   In-window SYN during TIME-WAIT:  Many TCP implementations create a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      new TCP connection if they receive an in-window SYN packet during</td><td> </td><td class="right">      new TCP connection if they receive an in-window SYN packet during</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      TIME-WAIT state.  When a TCP host enters TIME-WAIT or CLOSED</td><td> </td><td class="right">      TIME-WAIT state.  When a TCP host enters TIME-WAIT or CLOSED</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      state, it ought to ignore any previous state about the negotiation</td><td> </td><td class="right">      state, it ought to ignore any previous state about the negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      of AccECN for that connection and renegotiate the feedback mode</td><td> </td><td class="right">      of AccECN for that connection and renegotiate the feedback mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      according to Table 2.</td><td> </td><td class="right">      according to Table 2.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.3.  Forward Compatibility</td><td> </td><td class="right">3.1.3.  Forward Compatibility</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0069"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If a TCP <span class="delete">s</span>erver that implements AccECN receives a SYN with the three</td><td> </td><td class="rblock">   If a TCP <span class="insert">S</span>erver that implements AccECN receives a SYN with the three</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP header flags (AE, CWR and ECE) set to any combination other than</td><td> </td><td class="right">   TCP header flags (AE, CWR and ECE) set to any combination other than</td><td class="lineno"><br></td></tr>
      <tr id="diff0070"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   000, 011 or <span class="delete">111,</span> it MUST negotiate the use of AccECN as if <span class="delete">they</span> had</td><td> </td><td class="rblock">   000, 011 or <span class="insert">111 and it does not have logic specific to such a</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   been set to 111.  This ensures that future uses of the other</td><td> </td><td class="rblock"><span class="insert">   combination,</span> it MUST negotiate the use of AccECN as if <span class="insert">the three</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   combinations on a SYN can rely on consistent behaviour from the</td><td> </td><td class="rblock"><span class="insert">   flags</span> had been set to 111.  This ensures that future uses of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   installed base of AccECN servers.</td><td> </td><td class="rblock">   other combinations on a SYN can rely on consistent behaviour from the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   installed base of AccECN servers.  <span class="insert">See Appendix B.3 for related</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   discussion.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0071"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   For the avoidance of doubt, the behaviour described in the present</td><td> </td><td class="rblock">      <span class="insert">|</span>  For the avoidance of doubt, the behaviour described in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   specification applies whether or not the three remaining reserved TCP</td><td> </td><td class="rblock">      <span class="insert">|</span>  present specification applies whether or not the three</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   header flags are zero.</td><td> </td><td class="rblock">      <span class="insert">|</span>  remaining reserved TCP header flags are zero.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.4.  Retransmission of the SYN</td><td> </td><td class="right">3.1.4.  Retransmission of the SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the sender of an AccECN SYN times out before receiving the SYN/</td><td> </td><td class="right">   If the sender of an AccECN SYN times out before receiving the SYN/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK, the sender SHOULD attempt to negotiate the use of AccECN at</td><td> </td><td class="right">   ACK, the sender SHOULD attempt to negotiate the use of AccECN at</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   least one more time by continuing to set all three TCP ECN flags on</td><td> </td><td class="right">   least one more time by continuing to set all three TCP ECN flags on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the first retransmitted SYN (using the usual retransmission time-</td><td> </td><td class="right">   the first retransmitted SYN (using the usual retransmission time-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   outs).  If this first retransmission also fails to be acknowledged,</td><td> </td><td class="right">   outs).  If this first retransmission also fails to be acknowledged,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the sender SHOULD send subsequent retransmissions of the SYN with the</td><td> </td><td class="right">   the sender SHOULD send subsequent retransmissions of the SYN with the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   three TCP-ECN flags cleared (AE=CWR=ECE=0).  A retransmitted SYN MUST</td><td> </td><td class="right">   three TCP-ECN flags cleared (AE=CWR=ECE=0).  A retransmitted SYN MUST</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   use the same ISN as the original SYN.</td><td> </td><td class="right">   use the same ISN as the original SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Retrying once before fall-back adds delay in the case where a</td><td> </td><td class="right">   Retrying once before fall-back adds delay in the case where a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   middlebox drops an AccECN (or ECN) SYN deliberately.  However,</td><td> </td><td class="right">   middlebox drops an AccECN (or ECN) SYN deliberately.  However,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   current measurements imply that a drop is less likely to be due to</td><td> </td><td class="right">   current measurements imply that a drop is less likely to be due to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   middlebox interference than other intermittent causes of loss,</td><td> </td><td class="right">   middlebox interference than other intermittent causes of loss,</td><td class="lineno"><br></td></tr>
      <tr id="diff0072"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   e.g. congestion, wireless <span class="delete">interference</span>, etc.</td><td> </td><td class="rblock">   e.g. congestion, wireless <span class="insert">transmission loss</span>, etc.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Implementers MAY use other fall-back strategies if they are found to</td><td> </td><td class="right">   Implementers MAY use other fall-back strategies if they are found to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   be more effective (e.g. attempting to negotiate AccECN on the SYN</td><td> </td><td class="right">   be more effective (e.g. attempting to negotiate AccECN on the SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   only once or more than twice (most appropriate during high levels of</td><td> </td><td class="right">   only once or more than twice (most appropriate during high levels of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   congestion).  However, other fall-back strategies will need to follow</td><td> </td><td class="right">   congestion).  However, other fall-back strategies will need to follow</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   all the rules in Section 3.1.5, which concern behaviour when SYNs or</td><td> </td><td class="right">   all the rules in Section 3.1.5, which concern behaviour when SYNs or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN/ACKs negotiating different types of feedback have been sent</td><td> </td><td class="right">   SYN/ACKs negotiating different types of feedback have been sent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   within the same connection.</td><td> </td><td class="right">   within the same connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Further it might make sense to also remove any other new or</td><td> </td><td class="right">   Further it might make sense to also remove any other new or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-9" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-9"><em> page 18, line 8<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-9"><em> page 18, line 13<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   fall-back between different modules of the stack.</td><td> </td><td class="right">   fall-back between different modules of the stack.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Whichever fall-back strategy is used, the TCP initiator SHOULD cache</td><td> </td><td class="right">   Whichever fall-back strategy is used, the TCP initiator SHOULD cache</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   failed connection attempts.  If it does, it SHOULD NOT give up</td><td> </td><td class="right">   failed connection attempts.  If it does, it SHOULD NOT give up</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   attempting to negotiate AccECN on the SYN of subsequent connection</td><td> </td><td class="right">   attempting to negotiate AccECN on the SYN of subsequent connection</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   attempts until it is clear that the blockage is persistently and</td><td> </td><td class="right">   attempts until it is clear that the blockage is persistently and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specifically due to AccECN.  The cache needs to be arranged to expire</td><td> </td><td class="right">   specifically due to AccECN.  The cache needs to be arranged to expire</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   so that the initiator will infrequently attempt to check whether the</td><td> </td><td class="right">   so that the initiator will infrequently attempt to check whether the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   problem has been resolved.</td><td> </td><td class="right">   problem has been resolved.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0073"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The fall-back procedure if the TCP <span class="delete">s</span>erver receives no ACK to</td><td> </td><td class="rblock">   The fall-back procedure if the TCP <span class="insert">S</span>erver receives no ACK to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   acknowledge a SYN/ACK that tried to negotiate AccECN is specified in</td><td> </td><td class="right">   acknowledge a SYN/ACK that tried to negotiate AccECN is specified in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.3.2.</td><td> </td><td class="right">   Section 3.2.3.2.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.5.  Implications of AccECN Mode</td><td> </td><td class="right">3.1.5.  Implications of AccECN Mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.1.1 describes the only ways that a host can enter AccECN</td><td> </td><td class="right">   Section 3.1.1 describes the only ways that a host can enter AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   mode, whether as a client or as a server.</td><td> </td><td class="right">   mode, whether as a client or as a server.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0074"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">As a Data Sender, a</span> host in AccECN mode has the rights and</td><td> </td><td class="rblock">   <span class="insert">A</span> host in AccECN mode has the rights and obligations concerning the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   obligations concerning the use of ECN defined below, which build on</td><td> </td><td class="rblock">   use of ECN defined below, which build on those in [RFC3168] as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   those in [RFC3168] as updated by <span class="delete">[RFC8311]:</span></td><td> </td><td class="rblock">   updated by <span class="insert">[RFC8311].</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0075"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">*  Using ECT</span>:</td><td> </td><td class="rblock">   <span class="insert">Switching feedback negotiation (e.g. fall-back)</span>:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0076"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">-  It can set an ECT codepoint</span> in <span class="delete">the IP header of packets to</span></td><td> </td><td class="rblock">   <span class="insert">*  A host</span> in <span class="insert">AccECN mode:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         indicate to the network that the transport is capable and</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         willing to participate in ECN for this packet.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0077"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">It does not have to set ECT on any packet (for instance if it</span></td><td> </td><td class="rblock">      -  <span class="insert">MUST NOT send an ECN-setup SYN [RFC3168] and</span> a <span class="insert">SYN requesting</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         has reason to believe such</span> a <span class="delete">packet would be blocked).</span></td><td> </td><td class="rblock"><span class="insert">         AccECN feedback within the same connection;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0078"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">*  Switching</span> feedback <span class="delete">negotiation (e.g. fall-back):</span></td><td> </td><td class="rblock">      <span class="insert">-  MUST NOT send an ECN-setup SYN/ACK [RFC3168] and a SYN/ACK</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         agreeing to use AccECN</span> feedback <span class="insert">within the same connection;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0079"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">It SHOULD NOT set ECT on any packet</span> if it <span class="delete">has received at least</span></td><td> </td><td class="rblock">      -  <span class="insert">MUST reset the connection with a RST packet,</span> if it <span class="insert">receives an</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         one valid SYN or Acceptable SYN/ACK with AE=CWR=ECE=0.  A</span></td><td> </td><td class="rblock"><span class="insert">         ECN-setup SYN[RFC3168]</span> and <span class="insert">a</span> SYN <span class="insert">requesting</span> AccECN <span class="insert">feedback</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         "valid SYN" has the same port numbers</span> and <span class="delete">the same ISN as the</span></td><td> </td><td class="rblock"><span class="insert">         during the same connection;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         SYN <span class="delete">that caused the server to enter</span> AccECN <span class="delete">mode.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0080"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">It</span> MUST <span class="delete">NOT send an ECN-setup SYN [RFC3168] within</span> the <span class="delete">same</span></td><td> </td><td class="rblock">      -  MUST <span class="insert">reset</span> the connection <span class="insert">with a RST packet, if</span> it <span class="insert">receives an</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         connection <span class="delete">as</span> it <span class="delete">has sent</span> a <span class="delete">SYN requesting</span> AccECN <span class="delete">feedback.</span></td><td> </td><td class="rblock"><span class="insert">         ECN-setup SYN/ACK [RFC3168] and</span> a <span class="insert">SYN/ACK agreeing to use</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">         AccECN <span class="insert">feedback during the same connection;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0081"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">It MUST</span> NOT <span class="delete">send an ECN-setup</span> SYN/ACK <span class="delete">[RFC3168] within</span> the same</td><td> </td><td class="rblock">      -  <span class="insert">SHOULD</span> NOT <span class="insert">set ECT on any packet if it has received at least</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         <span class="delete">connection</span> as <span class="delete">it has sent a SYN/ACK agreeing</span> to <span class="delete">use</span> AccECN</td><td> </td><td class="rblock"><span class="insert">         one valid SYN or Acceptable</span> SYN/ACK <span class="insert">with AE=CWR=ECE=0.  A</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         <span class="delete">feedback.</span></td><td> </td><td class="rblock"><span class="insert">         "valid SYN" has the same port numbers and</span> the same <span class="insert">ISN</span> as <span class="insert">the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         SYN that caused the server</span> to <span class="insert">enter</span> AccECN <span class="insert">mode;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      The above rules are necessary because, if one peer were to</td><td> </td><td class="right">      The above rules are necessary because, if one peer were to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      negotiate the feedback mode in two different types of handshake,</td><td> </td><td class="right">      negotiate the feedback mode in two different types of handshake,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      it would not be possible for the other peer to know for certain</td><td> </td><td class="right">      it would not be possible for the other peer to know for certain</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      which handshake packet(s) the other end had eventually received or</td><td> </td><td class="right">      which handshake packet(s) the other end had eventually received or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      in which order it received them.  So, in the absence of these</td><td> </td><td class="right">      in which order it received them.  So, in the absence of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      rules, the two peers could end up using different feedback modes</td><td> </td><td class="right">      rules, the two peers could end up using different feedback modes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      without knowing it.</td><td> </td><td class="right">      without knowing it.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0082"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">*  Congestion response:</span></td><td> </td><td class="rblock">   <span class="insert">If for any reason a host is not willing to provide ECN feedback on a</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   particular TCP connection, it SHOULD clear the AE, CWR and ECE flags</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   in all SYN and/or SYN/ACK packets that it sends.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0083"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">It</span> is still obliged to respond appropriately to AccECN feedback</td><td> </td><td class="rblock">   <span class="insert">Sending ECT:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   *  A Data Sender in AccECN mode:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">      -  can set an ECT codepoint in the IP header of packets to</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         indicate to the network that the transport is capable and</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         willing to participate in ECN for this packet;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">      -  does not have to set ECT on any packet (for instance if it has</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         reason to believe such a packet would be blocked).</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Congestion response:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   *  A Data Sender in AccECN mode:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">      -  is still obliged to respond appropriately to AccECN feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         that indicates there were ECN marks on packets it had</td><td> </td><td class="right">         that indicates there were ECN marks on packets it had</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         previously sent, as defined in Section 6.1 of [RFC3168] and</td><td> </td><td class="right">         previously sent, as defined in Section 6.1 of [RFC3168] and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         updated by Sections 2.1 and 4.1 of [RFC8311].</td><td> </td><td class="right">         updated by Sections 2.1 and 4.1 of [RFC8311].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0084"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         In general, <span class="delete">it</span> is obliged to respond to congestion feedback</td><td> </td><td class="rblock">         In general, <span class="insert">a Data Sender</span> is obliged to respond to congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         even when it is solely sending non-ECN-capable packets (for</td><td> </td><td class="rblock">         feedback even when it is solely sending non-ECN-capable packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         rationale, some examples and some exceptions see</td><td> </td><td class="rblock">         (for rationale, some examples and some exceptions see</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         Section 3.2.2.3, Section 3.2.2.4).</td><td> </td><td class="right">         Section 3.2.2.3, Section 3.2.2.4).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0085"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">The commitment</span> to respond appropriately to incoming indications</td><td> </td><td class="rblock">      -  <span class="insert">commits</span> to respond appropriately to incoming indications of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         of <span class="delete">congestion remains</span> even if it sends a SYN packet with</td><td> </td><td class="rblock">         <span class="insert">congestion,</span> even if it sends a SYN packet with <span class="insert">AE=CWR=ECE=0</span> in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         <span class="delete">AE=CWR=ECE=0,</span> in a later transmission within the same TCP</td><td> </td><td class="rblock">         a later transmission within the same TCP <span class="insert">connection;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         <span class="delete">connection.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0086"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">Unlike an RFC 3168 data sender, it</span> MUST NOT set CWR to indicate</td><td> </td><td class="rblock">      -  MUST NOT set CWR to indicate it has received and responded to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         it has received and responded to indications of <span class="delete">congestion (for</span></td><td> </td><td class="rblock">         indications of <span class="insert">congestion.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         the avoidance of doubt, this does not preclude it from setting</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         the bits of the ACE counter field, which includes an overloaded</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         use of the same bit).</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0087"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">As a</span> Data <span class="delete">Receiver:</span></td><td> </td><td class="rblock">         <span class="insert">For the avoidance of doubt, this is unlike an RFC 3168 data</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         sender and this does not preclude the</span> Data <span class="insert">Sender from setting</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         the bits of the ACE counter field, which includes an overloaded</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         use of the same bit.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0088"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">*  a host in AccECN mode MUST feed back the information in the IP-ECN</span></td><td> </td><td class="rblock">   <span class="insert">Receiving ECT:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      field of incoming packets using Accurate ECN feedback, as</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      specified in Section 3.2 below.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0089"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  <span class="delete">if it receives an ECN-setup SYN or ECN-setup SYN/ACK [RFC3168]</span></td><td> </td><td class="rblock">   *  <span class="insert">A Data Receiver in</span> AccECN <span class="insert">mode:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      during the same connection as it receives a SYN requesting</span> AccECN</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">feedback or a SYN/ACK agreeing to use AccECN feedback, it MUST</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      reset the connection with a RST packet.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0090"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">*  If for any reason it is not willing to provide ECN feedback on a</span></td><td> </td><td class="rblock">      <span class="insert">-  MUST feed back</span> the <span class="insert">information</span> in <span class="insert">the IP-ECN field of incoming</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      particular TCP connection, to indicate this unwillingness it</span></td><td> </td><td class="rblock">         packets <span class="insert">using Accurate ECN feedback, as specified in</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      SHOULD clear</span> the <span class="delete">AE, CWR and ECE flags</span> in <span class="delete">all SYN and/or SYN/ACK</span></td><td> </td><td class="rblock"><span class="insert">         Section 3.2 below.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      packets <span class="delete">that it sends.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0091"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">*  it</span> MUST NOT use reception of packets with ECT set in the IP-ECN</td><td> </td><td class="rblock">      <span class="insert">-</span>  MUST NOT use reception of packets with ECT set in the IP-ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      field as an implicit signal that the peer is ECN-capable.  Reason:</td><td> </td><td class="rblock">         field as an implicit signal that the peer is ECN-capable.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      ECT at the IP layer does not explicitly confirm the peer has the</td><td> </td><td class="rblock">         Reason: ECT at the IP layer does not explicitly confirm the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      correct ECN feedback logic, <span class="delete">as</span> the packets could have been mangled</td><td> </td><td class="rblock">         peer has the correct ECN feedback logic, <span class="insert">because</span> the packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      at the IP layer.</td><td> </td><td class="rblock">         could have been mangled at the IP layer.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.  AccECN Feedback</td><td> </td><td class="right">3.2.  AccECN Feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Each Data Receiver of each half connection maintains four counters,</td><td> </td><td class="right">   Each Data Receiver of each half connection maintains four counters,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   r.cep, r.ceb, r.e0b and r.e1b:</td><td> </td><td class="right">   r.cep, r.ceb, r.e0b and r.e1b:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The Data Receiver MUST increment the CE packet counter (r.cep),</td><td> </td><td class="right">   *  The Data Receiver MUST increment the CE packet counter (r.cep),</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      for every Acceptable packet that it receives with the CE code</td><td> </td><td class="right">      for every Acceptable packet that it receives with the CE code</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      point in the IP ECN field, including CE marked control packets but</td><td> </td><td class="right">      point in the IP ECN field, including CE marked control packets but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      excluding CE on SYN packets (SYN=1; ACK=0).</td><td> </td><td class="right">      excluding CE on SYN packets (SYN=1; ACK=0).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0092"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  A Data Receiver that supports sending of <span class="delete">the</span> AccECN TCP <span class="delete">Option</span></td><td> </td><td class="rblock">   *  A Data Receiver that supports sending of AccECN TCP <span class="insert">Options</span> MUST</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      MUST increment the r.ceb, r.e0b or r.e1b byte counters by the</td><td> </td><td class="rblock">      increment the r.ceb, r.e0b or r.e1b byte counters by the number of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      number of TCP payload octets in Acceptable packets marked</td><td> </td><td class="rblock">      TCP payload octets in Acceptable packets marked with the CE,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">respectively</span> with the CE, ECT(0) and ECT(1) codepoint in their <span class="delete">IP-</span></td><td> </td><td class="rblock">      ECT(0) and ECT(1) codepoint in their <span class="insert">IP-ECN</span> field, including any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      ECN</span> field, including any payload octets on control packets, but</td><td> </td><td class="rblock">      payload octets on control packets, but not including any payload</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      not including any payload octets on SYN packets (SYN=1; ACK=0).</td><td> </td><td class="rblock">      octets on SYN packets (SYN=1; ACK=0).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Each Data Sender of each half connection maintains four counters,</td><td> </td><td class="right">   Each Data Sender of each half connection maintains four counters,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   s.cep, s.ceb, s.e0b and s.e1b intended to track the equivalent</td><td> </td><td class="right">   s.cep, s.ceb, s.e0b and s.e1b intended to track the equivalent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counters at the Data Receiver.</td><td> </td><td class="right">   counters at the Data Receiver.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A Data Receiver feeds back the CE packet counter using the Accurate</td><td> </td><td class="right">   A Data Receiver feeds back the CE packet counter using the Accurate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN (ACE) field, as explained in Section 3.2.2.  And it optionally</td><td> </td><td class="right">   ECN (ACE) field, as explained in Section 3.2.2.  And it optionally</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feeds back all the byte counters using the AccECN TCP Option, as</td><td> </td><td class="right">   feeds back all the byte counters using the AccECN TCP Option, as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specified in Section 3.2.3.</td><td> </td><td class="right">   specified in Section 3.2.3.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0093"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Whenever a <span class="delete">host</span> feeds back the value of any counter, it MUST report</td><td> </td><td class="rblock">   Whenever a <span class="insert">Data Receiver</span> feeds back the value of any counter, it MUST</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the most recent value, no matter whether it is in a pure ACK, an ACK</td><td> </td><td class="rblock">   report the most recent value, no matter whether it is in a pure ACK,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">with</span> new payload data or a retransmission.  Therefore the feedback</td><td> </td><td class="rblock">   <span class="insert">or</span> an ACK <span class="insert">piggybacked on a packet used by the other half-connection,</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">carried</span> on a retransmitted packet is unlikely to be the same as the</td><td> </td><td class="rblock"><span class="insert">   whether</span> new payload data or a retransmission.  Therefore the feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   feedback on the original packet.</td><td> </td><td class="rblock">   <span class="insert">piggybacked</span> on a retransmitted packet is unlikely to be the same as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   the feedback on the original packet.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.1.  Initialization of Feedback Counters</td><td> </td><td class="right">3.2.1.  Initialization of Feedback Counters</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When a host first enters AccECN mode, in its role as a Data Receiver</td><td> </td><td class="right">   When a host first enters AccECN mode, in its role as a Data Receiver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it initializes its counters to r.cep = 5, r.e0b = r.e1b = 1 and r.ceb</td><td> </td><td class="right">   it initializes its counters to r.cep = 5, r.e0b = r.e1b = 1 and r.ceb</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   = 0,</td><td> </td><td class="right">   = 0,</td><td class="lineno"><br></td></tr>
      <tr id="diff0094"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">                                                                         </span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Non-zero initial values are used to support a stateless handshake</td><td> </td><td class="right">   Non-zero initial values are used to support a stateless handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (see Section 5.1) and to be distinct from cases where the fields are</td><td> </td><td class="right">   (see Section 5.1) and to be distinct from cases where the fields are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   incorrectly zeroed (e.g. by middleboxes - see Section 3.2.3.2.4).</td><td> </td><td class="right">   incorrectly zeroed (e.g. by middleboxes - see Section 3.2.3.2.4).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When a host enters AccECN mode, in its role as a Data Sender it</td><td> </td><td class="right">   When a host enters AccECN mode, in its role as a Data Sender it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   initializes its counters to s.cep = 5, s.e0b = s.e1b = 1 and s.ceb =</td><td> </td><td class="right">   initializes its counters to s.cep = 5, s.e0b = s.e1b = 1 and s.ceb =</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   0.</td><td> </td><td class="right">   0.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.2.  The ACE Field</td><td> </td><td class="right">3.2.2.  The ACE Field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-10" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-10"><em> page 21, line 34<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-10"><em> page 21, line 41<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   comparison in Figure 1.  This specification does not rename these</td><td> </td><td class="right">   comparison in Figure 1.  This specification does not rename these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   three TCP flags to ACE unconditionally; it merely overloads them with</td><td> </td><td class="right">   three TCP flags to ACE unconditionally; it merely overloads them with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   another name and definition once an AccECN connection has been</td><td> </td><td class="right">   another name and definition once an AccECN connection has been</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   established.</td><td> </td><td class="right">   established.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   With one exception (Section 3.2.2.1), a host with both of its half-</td><td> </td><td class="right">   With one exception (Section 3.2.2.1), a host with both of its half-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connections in AccECN mode MUST interpret the AE, CWR and ECE flags</td><td> </td><td class="right">   connections in AccECN mode MUST interpret the AE, CWR and ECE flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   as the 3-bit ACE counter on a segment with the SYN flag cleared</td><td> </td><td class="right">   as the 3-bit ACE counter on a segment with the SYN flag cleared</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (SYN=0).  On such a packet, a Data Receiver MUST encode the three</td><td> </td><td class="right">   (SYN=0).  On such a packet, a Data Receiver MUST encode the three</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   least significant bits of its r.cep counter into the ACE field that</td><td> </td><td class="right">   least significant bits of its r.cep counter into the ACE field that</td><td class="lineno"><br></td></tr>
      <tr id="diff0095"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   it feeds back to the Data Sender.  A host MUST NOT interpret the 3</td><td> </td><td class="rblock">   it feeds back to the Data Sender.  <span class="insert">The least significant bit is at</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flags as a 3-bit ACE field on any segment with SYN=1 (whether ACK is</td><td> </td><td class="rblock"><span class="insert">   bit offset 9 in Figure 3.</span>  A host MUST NOT interpret the 3 flags as a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   0 or 1), or if AccECN negotiation is incomplete or has not succeeded.</td><td> </td><td class="rblock">   3-bit ACE field on any segment with SYN=1 (whether ACK is 0 or 1), or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   if AccECN negotiation is incomplete or has not succeeded.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Both parts of each of these conditions are equally important.  For</td><td> </td><td class="right">   Both parts of each of these conditions are equally important.  For</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   instance, even if AccECN negotiation has been successful, the ACE</td><td> </td><td class="right">   instance, even if AccECN negotiation has been successful, the ACE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field is not defined on any segments with SYN=1 (e.g. a</td><td> </td><td class="right">   field is not defined on any segments with SYN=1 (e.g. a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   retransmission of an unacknowledged SYN/ACK, or when both ends send</td><td> </td><td class="right">   retransmission of an unacknowledged SYN/ACK, or when both ends send</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN/ACKs after AccECN support has been successfully negotiated during</td><td> </td><td class="right">   SYN/ACKs after AccECN support has been successfully negotiated during</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   a simultaneous open).</td><td> </td><td class="right">   a simultaneous open).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.2.1.  ACE Field on the ACK of the SYN/ACK</td><td> </td><td class="right">3.2.2.1.  ACE Field on the ACK of the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0096"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   A TCP <span class="delete">c</span>lient (A) in AccECN mode MUST feed back which of the 4</td><td> </td><td class="rblock">   A TCP <span class="insert">C</span>lient (A) in AccECN mode MUST feed back which of the 4</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   possible values of the IP-ECN field was on the SYN/ACK by writing it</td><td> </td><td class="right">   possible values of the IP-ECN field was on the SYN/ACK by writing it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   into the ACE field of a pure ACK with no SACK blocks using the binary</td><td> </td><td class="right">   into the ACE field of a pure ACK with no SACK blocks using the binary</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   encoding in Table 3 (which is the same as that used on the SYN/ACK in</td><td> </td><td class="right">   encoding in Table 3 (which is the same as that used on the SYN/ACK in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Table 2).  This shall be called the handshake encoding of the ACE</td><td> </td><td class="right">   Table 2).  This shall be called the handshake encoding of the ACE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field, and it is the only exception to the rule that the ACE field</td><td> </td><td class="right">   field, and it is the only exception to the rule that the ACE field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   carries the 3 least significant bits of the r.cep counter on packets</td><td> </td><td class="right">   carries the 3 least significant bits of the r.cep counter on packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with SYN=0.</td><td> </td><td class="right">   with SYN=0.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0097"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The TCP <span class="delete">c</span>lient MUST also use the handshake encoding for the pure ACK</td><td> </td><td class="rblock">   The TCP <span class="insert">C</span>lient MUST also use the handshake encoding for the pure ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of any retransmitted SYN/ACK.</td><td> </td><td class="right">   of any retransmitted SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0098"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Normally, a TCP <span class="delete">c</span>lient acknowledges a SYN/ACK with an ACK that</td><td> </td><td class="rblock">   Normally, a TCP <span class="insert">C</span>lient acknowledges a SYN/ACK with an ACK that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   satisfies the above conditions anyway (SYN=0, no data, no SACK</td><td> </td><td class="right">   satisfies the above conditions anyway (SYN=0, no data, no SACK</td><td class="lineno"><br></td></tr>
      <tr id="diff0099"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   blocks).  If an AccECN TCP <span class="delete">c</span>lient intends to acknowledge the SYN/ACK</td><td> </td><td class="rblock">   blocks).  If an AccECN TCP <span class="insert">C</span>lient intends to acknowledge the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with a packet that does not satisfy these conditions (e.g. it has</td><td> </td><td class="right">   with a packet that does not satisfy these conditions (e.g. it has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   data to include on the ACK), it SHOULD first send a pure ACK that</td><td> </td><td class="right">   data to include on the ACK), it SHOULD first send a pure ACK that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   does satisfy these conditions (see Section 5.2), so that it can feed</td><td> </td><td class="right">   does satisfy these conditions (see Section 5.2), so that it can feed</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   back which of the four values of the IP-ECN field arrived on the SYN/</td><td> </td><td class="right">   back which of the four values of the IP-ECN field arrived on the SYN/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK.  A valid exception to this "SHOULD" would be where the</td><td> </td><td class="right">   ACK.  A valid exception to this "SHOULD" would be where the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   implementation will only be used in an environment where mangling of</td><td> </td><td class="right">   implementation will only be used in an environment where mangling of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the ECN field is unlikely.</td><td> </td><td class="right">   the ECN field is unlikely.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0100"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    <span class="delete">+=============================+================+=================+</span></td><td> </td><td class="rblock">        <span class="insert">+==================+================+=====================+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    | IP-ECN codepoint <span class="delete">on SYN/ACK</span> | ACE on pure    | r.cep of <span class="delete">client</span> |</td><td> </td><td class="rblock">        | IP-ECN codepoint | ACE on pure    | r.cep of <span class="insert">TCP Client</span> |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    |                             | ACK of SYN/ACK | in AccECN mode  |</td><td> </td><td class="rblock">        | <span class="insert">on SYN/ACK</span>       | ACK of SYN/ACK | in AccECN mode      |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    <span class="delete">+=============================+================+=================+</span></td><td> </td><td class="rblock">        <span class="insert">+==================+================+=====================+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    | Not-ECT                     | 0b010          | 5               |</td><td> </td><td class="rblock">        | Not-ECT          | 0b010          | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    <span class="delete">+-----------------------------+----------------+-----------------+</span></td><td> </td><td class="rblock">        <span class="insert">+------------------+----------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    | ECT(1)                      | 0b011          | 5               |</td><td> </td><td class="rblock">        | ECT(1)           | 0b011          | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    <span class="delete">+-----------------------------+----------------+-----------------+</span></td><td> </td><td class="rblock">        <span class="insert">+------------------+----------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    | ECT(0)                      | 0b100          | 5               |</td><td> </td><td class="rblock">        | ECT(0)           | 0b100          | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    <span class="delete">+-----------------------------+----------------+-----------------+</span></td><td> </td><td class="rblock">        <span class="insert">+------------------+----------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    | CE                          | 0b110          | 6               |</td><td> </td><td class="rblock">        | CE               | 0b110          | 6                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">    <span class="delete">+-----------------------------+----------------+-----------------+</span></td><td> </td><td class="rblock">        <span class="insert">+------------------+----------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0101"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Table 3: The encoding of the ACE field in the ACK of the <span class="delete">SYN-</span></td><td> </td><td class="rblock">            Table 3: The encoding of the ACE field in the ACK of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">                ACK</span> to reflect the SYN-ACK's IP-ECN field</td><td> </td><td class="rblock">             the <span class="insert">SYN-ACK</span> to reflect the SYN-ACK's IP-ECN field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When an AccECN server in SYN-RCVD state receives a pure ACK with</td><td> </td><td class="right">   When an AccECN server in SYN-RCVD state receives a pure ACK with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN=0 and no SACK blocks, instead of treating the ACE field as a</td><td> </td><td class="right">   SYN=0 and no SACK blocks, instead of treating the ACE field as a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counter, it MUST infer the meaning of each possible value of the ACE</td><td> </td><td class="right">   counter, it MUST infer the meaning of each possible value of the ACE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field from Table 4, which also shows the value that an AccECN server</td><td> </td><td class="right">   field from Table 4, which also shows the value that an AccECN server</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   MUST set s.cep to as a result.</td><td> </td><td class="right">   MUST set s.cep to as a result.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Given this encoding of the ACE field on the ACK of a SYN/ACK is</td><td> </td><td class="right">   Given this encoding of the ACE field on the ACK of a SYN/ACK is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   exceptional, an AccECN server using large receive offload (LRO) might</td><td> </td><td class="right">   exceptional, an AccECN server using large receive offload (LRO) might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   prefer to disable LRO until such an ACK has transitioned it out of</td><td> </td><td class="right">   prefer to disable LRO until such an ACK has transitioned it out of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN-RCVD state.</td><td> </td><td class="right">   SYN-RCVD state.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0102"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+============+==========================+=================+</span></td><td> </td><td class="rblock">      <span class="insert">+============+==========================+=====================+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | ACE on ACK | IP-ECN codepoint on SYN/ | s.cep of <span class="delete">server</span> |</td><td> </td><td class="rblock">      | ACE on ACK | IP-ECN codepoint on SYN/ | s.cep of <span class="insert">TCP Server</span> |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | of SYN/ACK | ACK inferred by server   | in AccECN mode  |</td><td> </td><td class="rblock">      | of SYN/ACK | ACK inferred by server   | in AccECN mode      |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+============+==========================+=================+</span></td><td> </td><td class="rblock">      <span class="insert">+============+==========================+=====================+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b000      | {Notes 1, 3}             | Disable ECN     |</td><td> </td><td class="rblock">      | 0b000      | {Notes 1, 3}             | Disable ECN         |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b001      | {Notes 2, 3}             | 5               |</td><td> </td><td class="rblock">      | 0b001      | {Notes 2, 3}             | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b010      | Not-ECT                  | 5               |</td><td> </td><td class="rblock">      | 0b010      | Not-ECT                  | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b011      | ECT(1)                   | 5               |</td><td> </td><td class="rblock">      | 0b011      | ECT(1)                   | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b100      | ECT(0)                   | 5               |</td><td> </td><td class="rblock">      | 0b100      | ECT(0)                   | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b101      | Currently Unused {Note   | 5               |</td><td> </td><td class="rblock">      | 0b101      | Currently Unused {Note   | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        |            | 2}                       |                 |</td><td> </td><td class="rblock">      |            | 2}                       |                     |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b110      | CE                       | 6               |</td><td> </td><td class="rblock">      | 0b110      | CE                       | 6                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        | 0b111      | Currently Unused {Note   | 5               |</td><td> </td><td class="rblock">      | 0b111      | Currently Unused {Note   | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        |            | 2}                       |                 |</td><td> </td><td class="rblock">      |            | 2}                       |                     |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">        <span class="delete">+------------+--------------------------+-----------------+</span></td><td> </td><td class="rblock">      <span class="insert">+------------+--------------------------+---------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        Table 4: Meaning of the ACE field on the ACK of the SYN/ACK</td><td> </td><td class="right">        Table 4: Meaning of the ACE field on the ACK of the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   {Note 1}: If the server is in AccECN mode, the value of zero raises</td><td> </td><td class="right">   {Note 1}: If the server is in AccECN mode, the value of zero raises</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   suspicion of zeroing of the ACE field on the path (see</td><td> </td><td class="right">   suspicion of zeroing of the ACE field on the path (see</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.2.4).</td><td> </td><td class="right">   Section 3.2.2.4).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   {Note 2}: If the server is in AccECN mode, these values are Currently</td><td> </td><td class="right">   {Note 2}: If the server is in AccECN mode, these values are Currently</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Unused but the AccECN server's behaviour is still defined for forward</td><td> </td><td class="right">   Unused but the AccECN server's behaviour is still defined for forward</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   compatibility.  Then the designer of a future protocol can know for</td><td> </td><td class="right">   compatibility.  Then the designer of a future protocol can know for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   certain what AccECN servers will do with these codepoints.</td><td> </td><td class="right">   certain what AccECN servers will do with these codepoints.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   {Note 3}: In the case where a server that implements AccECN is also</td><td> </td><td class="right">   {Note 3}: In the case where a server that implements AccECN is also</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   using a stateless handshake (termed a SYN cookie) it will not</td><td> </td><td class="right">   using a stateless handshake (termed a SYN cookie) it will not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   remember whether it entered AccECN mode.  The values 0b000 or 0b001</td><td> </td><td class="right">   remember whether it entered AccECN mode.  The values 0b000 or 0b001</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   will remind it that it did not enter AccECN mode, because AccECN does</td><td> </td><td class="right">   will remind it that it did not enter AccECN mode, because AccECN does</td><td class="lineno"><br></td></tr>
      <tr id="diff0103"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   not use them (see Section 5.1 for details).  If a <span class="delete">stateless</span> server</td><td> </td><td class="rblock">   not use them (see Section 5.1 for details).  If a server that <span class="insert">uses a</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   that implements AccECN receives either of these two values in the</td><td> </td><td class="rblock"><span class="insert">   stateless handshake and</span> implements AccECN receives either of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ACK, its action is implementation-dependent and outside the scope of</td><td> </td><td class="rblock">   two values in the ACK, its action is implementation-dependent and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   this <span class="delete">spec,</span> It will certainly not take the action in the third column</td><td> </td><td class="rblock">   outside the scope of this <span class="insert">spec.</span>  It will certainly not take the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   because, after it receives either of these values, it is not in</td><td> </td><td class="rblock">   action in the third column because, after it receives either of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN mode.  I.e., it will not disable ECN (at least not just</td><td> </td><td class="rblock">   values, it is not in AccECN mode.  I.e., it will not disable ECN (at</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   because ACE is 0b000) and it will not set s.cep.</td><td> </td><td class="rblock">   least not just because ACE is 0b000) and it will not set s.cep.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.2.2.  Encoding and Decoding Feedback in the ACE Field</td><td> </td><td class="right">3.2.2.2.  Encoding and Decoding Feedback in the ACE Field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Whenever the Data Receiver sends an ACK with SYN=0 (with or without</td><td> </td><td class="right">   Whenever the Data Receiver sends an ACK with SYN=0 (with or without</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   data), unless the handshake encoding in Section 3.2.2.1 applies, the</td><td> </td><td class="right">   data), unless the handshake encoding in Section 3.2.2.1 applies, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Data Receiver MUST encode the least significant 3 bits of its r.cep</td><td> </td><td class="right">   Data Receiver MUST encode the least significant 3 bits of its r.cep</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counter into the ACE field (see Appendix A.2).</td><td> </td><td class="right">   counter into the ACE field (see Appendix A.2).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Whenever the Data Sender receives an ACK with SYN=0 (with or without</td><td> </td><td class="right">   Whenever the Data Sender receives an ACK with SYN=0 (with or without</td><td class="lineno"><br></td></tr>
      <tr id="diff0104"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   data), it first checks whether it has already been superseded by</td><td> </td><td class="rblock">   data), it first checks whether it has already been superseded</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   another ACK in which case it ignores the ECN feedback.  If the ACK</td><td> </td><td class="rblock">   <span class="insert">(defined in Appendix A.1)</span> by another ACK in which case it ignores the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   has not been superseded, and if the special handshake encoding in</td><td> </td><td class="rblock">   ECN feedback.  If the ACK has not been superseded, and if the special</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section 3.2.2.1 does not apply, the Data Sender decodes the ACE field</td><td> </td><td class="rblock">   handshake encoding in Section 3.2.2.1 does not apply, the Data Sender</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   as follows (see Appendix A.2 for examples).</td><td> </td><td class="rblock">   decodes the ACE field as follows (see Appendix A.2 for examples).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  It takes the least significant 3 bits of its local s.cep counter</td><td> </td><td class="right">   *  It takes the least significant 3 bits of its local s.cep counter</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      and subtracts them from the incoming ACE counter to work out the</td><td> </td><td class="right">      and subtracts them from the incoming ACE counter to work out the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      minimum positive increment it could apply to s.cep (assuming the</td><td> </td><td class="right">      minimum positive increment it could apply to s.cep (assuming the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ACE field only wrapped at most once).</td><td> </td><td class="right">      ACE field only wrapped at most once).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  It then follows the safety procedures in Section 3.2.2.5.2 to</td><td> </td><td class="right">   *  It then follows the safety procedures in Section 3.2.2.5.2 to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      calculate or estimate how many packets the ACK could have</td><td> </td><td class="right">      calculate or estimate how many packets the ACK could have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      acknowledged under the prevailing conditions to determine whether</td><td> </td><td class="right">      acknowledged under the prevailing conditions to determine whether</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the ACE field might have wrapped more than once.</td><td> </td><td class="right">      the ACE field might have wrapped more than once.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The encode/decode procedures during the three-way handshake are</td><td> </td><td class="right">   The encode/decode procedures during the three-way handshake are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   exceptions to the general rules given so far, so they are spelled out</td><td> </td><td class="right">   exceptions to the general rules given so far, so they are spelled out</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   step by step below for clarity:</td><td> </td><td class="right">   step by step below for clarity:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0105"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  If a TCP <span class="delete">s</span>erver in AccECN mode receives a CE mark in the IP-ECN</td><td> </td><td class="rblock">   *  If a TCP <span class="insert">S</span>erver in AccECN mode receives a CE mark in the IP-ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      field of a SYN (SYN=1, ACK=0), it MUST NOT increment r.cep (it</td><td> </td><td class="right">      field of a SYN (SYN=1, ACK=0), it MUST NOT increment r.cep (it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      remains at its initial value of 5).</td><td> </td><td class="right">      remains at its initial value of 5).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Reason: It would be redundant for the server to include CE-marked</td><td> </td><td class="right">      Reason: It would be redundant for the server to include CE-marked</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      SYNs in its r.cep counter, because it already reliably delivers</td><td> </td><td class="right">      SYNs in its r.cep counter, because it already reliably delivers</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback of any CE marking using the encoding in Table 2 in the</td><td> </td><td class="right">      feedback of any CE marking using the encoding in Table 2 in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      SYN/ACK.  This also ensures that, when the server starts using the</td><td> </td><td class="right">      SYN/ACK.  This also ensures that, when the server starts using the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ACE field, it has not unnecessarily consumed more than one initial</td><td> </td><td class="right">      ACE field, it has not unnecessarily consumed more than one initial</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      value, given they can be used to negotiate variants of the AccECN</td><td> </td><td class="right">      value, given they can be used to negotiate variants of the AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      protocol (see Appendix B.3).</td><td> </td><td class="right">      protocol (see Appendix B.3).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0106"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  If a TCP <span class="delete">c</span>lient in AccECN mode receives CE feedback in the TCP</td><td> </td><td class="rblock">   *  If a TCP <span class="insert">C</span>lient in AccECN mode receives CE feedback in the TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      flags of a SYN/ACK, it MUST NOT increment s.cep (it remains at its</td><td> </td><td class="right">      flags of a SYN/ACK, it MUST NOT increment s.cep (it remains at its</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      initial value of 5), so that it stays in step with r.cep on the</td><td> </td><td class="right">      initial value of 5), so that it stays in step with r.cep on the</td><td class="lineno"><br></td></tr>
      <tr id="diff0107"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      server.  Nonetheless, the TCP <span class="delete">c</span>lient still triggers the congestion</td><td> </td><td class="rblock">      server.  Nonetheless, the TCP <span class="insert">C</span>lient still triggers the congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      control actions necessary to respond to the CE feedback.</td><td> </td><td class="right">      control actions necessary to respond to the CE feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0108"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  If a TCP <span class="delete">c</span>lient in AccECN mode receives a CE mark in the IP-ECN</td><td> </td><td class="rblock">   *  If a TCP <span class="insert">C</span>lient in AccECN mode receives a CE mark in the IP-ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      field of a SYN/ACK, it MUST increment r.cep, but no more than once</td><td> </td><td class="right">      field of a SYN/ACK, it MUST increment r.cep, but no more than once</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      no matter how many CE-marked SYN/ACKs it receives</td><td> </td><td class="right">      no matter how many CE-marked SYN/ACKs it receives</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      (i.e. incremented from 5 to 6, but no further).</td><td> </td><td class="right">      (i.e. incremented from 5 to 6, but no further).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Reason: Incrementing r.cep ensures the client will eventually</td><td> </td><td class="right">      Reason: Incrementing r.cep ensures the client will eventually</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      deliver any CE marking to the server reliably when it starts using</td><td> </td><td class="right">      deliver any CE marking to the server reliably when it starts using</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the ACE field.  Even though the client also feeds back any CE</td><td> </td><td class="right">      the ACE field.  Even though the client also feeds back any CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      marking on the ACK of the SYN/ACK using the encoding in Table 3,</td><td> </td><td class="right">      marking on the ACK of the SYN/ACK using the encoding in Table 3,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      this ACK is not delivered reliably, so it can be considered as a</td><td> </td><td class="right">      this ACK is not delivered reliably, so it can be considered as a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      timely notification that is redundant but unreliable.  The client</td><td> </td><td class="right">      timely notification that is redundant but unreliable.  The client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      does not increment r.cep more than once, because the server can</td><td> </td><td class="right">      does not increment r.cep more than once, because the server can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      only increment s.cep once (see next bullet).  Also, this limits</td><td> </td><td class="right">      only increment s.cep once (see next bullet).  Also, this limits</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the unnecessarily consumed initial values of the ACE field to two.</td><td> </td><td class="right">      the unnecessarily consumed initial values of the ACE field to two.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0109"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  If a TCP <span class="delete">s</span>erver in AccECN mode and in SYN-RCVD state receives CE</td><td> </td><td class="rblock">   *  If a TCP <span class="insert">S</span>erver in AccECN mode and in SYN-RCVD state receives CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback in the TCP flags of a pure ACK with no SACK blocks, it</td><td> </td><td class="right">      feedback in the TCP flags of a pure ACK with no SACK blocks, it</td><td class="lineno"><br></td></tr>
      <tr id="diff0110"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      MUST increment s.cep (from 5 to 6).  The TCP <span class="delete">s</span>erver then triggers</td><td> </td><td class="rblock">      MUST increment s.cep (from 5 to 6).  The TCP <span class="insert">S</span>erver then triggers</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the congestion control actions necessary to respond to the CE</td><td> </td><td class="right">      the congestion control actions necessary to respond to the CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback.</td><td> </td><td class="right">      feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0111"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Reasoning: The TCP <span class="delete">s</span>erver can only increment s.cep once, because</td><td> </td><td class="rblock">      Reasoning: The TCP <span class="insert">S</span>erver can only increment s.cep once, because</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the first ACK it receives will cause it to transition out of SYN-</td><td> </td><td class="right">      the first ACK it receives will cause it to transition out of SYN-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      RCVD state.  The server's congestion response would be no</td><td> </td><td class="right">      RCVD state.  The server's congestion response would be no</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      different even if it could receive feedback of more than one CE-</td><td> </td><td class="right">      different even if it could receive feedback of more than one CE-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      marked SYN/ACK.</td><td> </td><td class="right">      marked SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0112"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Once the TCP <span class="delete">s</span>erver transitions to ESTABLISHED state, it might</td><td> </td><td class="rblock">      Once the TCP <span class="insert">S</span>erver transitions to ESTABLISHED state, it might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      later receive other pure ACK(s) with the handshake encoding in the</td><td> </td><td class="right">      later receive other pure ACK(s) with the handshake encoding in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ACE field.  A server MAY implement a test for such a case, but it</td><td> </td><td class="right">      ACE field.  A server MAY implement a test for such a case, but it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      is not required.  Therefore, once in the ESTABLISHED state, it</td><td> </td><td class="right">      is not required.  Therefore, once in the ESTABLISHED state, it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      will be sufficient for the server to consider the ACE field to be</td><td> </td><td class="right">      will be sufficient for the server to consider the ACE field to be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      encoded as the normal ACE counter on all packets with SYN=0.</td><td> </td><td class="right">      encoded as the normal ACE counter on all packets with SYN=0.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Reasoning: Such ACKs will be quite unusual, e.g. a SYN/ACK (or ACK</td><td> </td><td class="right">      Reasoning: Such ACKs will be quite unusual, e.g. a SYN/ACK (or ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      of the SYN/ACK) that is delayed for longer than the server's</td><td> </td><td class="right">      of the SYN/ACK) that is delayed for longer than the server's</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      retransmission timeout; or packet duplication by the network.  And</td><td> </td><td class="right">      retransmission timeout; or packet duplication by the network.  And</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the impact of any error in the feedback on such ACKs will only be</td><td> </td><td class="right">      the impact of any error in the feedback on such ACKs will only be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      temporary.</td><td> </td><td class="right">      temporary.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.2.3.  Testing for Mangling of the IP/ECN Field</td><td> </td><td class="right">3.2.2.3.  Testing for Mangling of the IP/ECN Field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The value of the ACE field on the SYN/ACK indicates the value of the</td><td> </td><td class="right">   The value of the ACE field on the SYN/ACK indicates the value of the</td><td class="lineno"><br></td></tr>
      <tr id="diff0113"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   IP/ECN field when the SYN arrived at the server.  The <span class="delete">c</span>lient can</td><td> </td><td class="rblock">   IP/ECN field when the SYN arrived at the server.  The <span class="insert">TCP C</span>lient can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   compare this with how it originally set the IP/ECN field on the SYN.</td><td> </td><td class="right">   compare this with how it originally set the IP/ECN field on the SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If this comparison implies an invalid transition (defined below) of</td><td> </td><td class="right">   If this comparison implies an invalid transition (defined below) of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the IP/ECN field, for the remainder of the half-connection the client</td><td> </td><td class="right">   the IP/ECN field, for the remainder of the half-connection the client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   is advised to send non-ECN-capable packets, but it still ought to</td><td> </td><td class="right">   is advised to send non-ECN-capable packets, but it still ought to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   respond to any feedback of CE markings (explained below).  However,</td><td> </td><td class="right">   respond to any feedback of CE markings (explained below).  However,</td><td class="lineno"><br></td></tr>
      <tr id="diff0114"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the <span class="delete">c</span>lient MUST remain in the AccECN feedback mode and it MUST</td><td> </td><td class="rblock">   the <span class="insert">TCP C</span>lient MUST remain in the AccECN feedback mode and it MUST</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   continue to feed back any ECN markings on arriving packets (in its</td><td> </td><td class="right">   continue to feed back any ECN markings on arriving packets (in its</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   role as Data Receiver).</td><td> </td><td class="right">   role as Data Receiver).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The value of the ACE field on the last ACK of the 3WHS indicates the</td><td> </td><td class="right">   The value of the ACE field on the last ACK of the 3WHS indicates the</td><td class="lineno"><br></td></tr>
      <tr id="diff0115"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   value of the IP/ECN field when the SYN/ACK arrived at the <span class="delete">c</span>lient.</td><td> </td><td class="rblock">   value of the IP/ECN field when the SYN/ACK arrived at the <span class="insert">TCP C</span>lient.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The server can compare this with how it originally set the IP/ECN</td><td> </td><td class="right">   The server can compare this with how it originally set the IP/ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field on the SYN/ACK.  If this comparison implies an invalid</td><td> </td><td class="right">   field on the SYN/ACK.  If this comparison implies an invalid</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   transition of the IP/ECN field, for the remainder of the half-</td><td> </td><td class="right">   transition of the IP/ECN field, for the remainder of the half-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection the server is advised to send non-ECN-capable packets, but</td><td> </td><td class="right">   connection the server is advised to send non-ECN-capable packets, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it still ought to respond to any feedback of CE markings (explained</td><td> </td><td class="right">   it still ought to respond to any feedback of CE markings (explained</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   below).  However, the server MUST remain in the AccECN feedback mode</td><td> </td><td class="right">   below).  However, the server MUST remain in the AccECN feedback mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and it MUST continue to feed back any ECN markings on arriving</td><td> </td><td class="right">   and it MUST continue to feed back any ECN markings on arriving</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets (in its role as Data Receiver).</td><td> </td><td class="right">   packets (in its role as Data Receiver).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If a Data Sender in AccECN mode starts sending non-ECN-capable</td><td> </td><td class="right">   If a Data Sender in AccECN mode starts sending non-ECN-capable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets because it has detected mangling, it is still advised to</td><td> </td><td class="right">   packets because it has detected mangling, it is still advised to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   respond to CE feedback.  Reason: any CE-marking arriving at the Data</td><td> </td><td class="right">   respond to CE feedback.  Reason: any CE-marking arriving at the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Receiver could be due to something early in the path mangling the</td><td> </td><td class="right">   Receiver could be due to something early in the path mangling the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   non-ECN-capable IP/ECN field into an ECN-capable codepoint and then,</td><td> </td><td class="right">   non-ECN-capable IP/ECN field into an ECN-capable codepoint and then,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   later in the path, a network bottleneck might be applying CE-markings</td><td> </td><td class="right">   later in the path, a network bottleneck might be applying CE-markings</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to indicate genuine congestion.  This argument applies whether the</td><td> </td><td class="right">   to indicate genuine congestion.  This argument applies whether the</td><td class="lineno"><br></td></tr>
      <tr id="diff0116"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   handshake packet originally sent by the <span class="delete">client</span> or <span class="delete">server</span> was <span class="delete">non-ECN-</span></td><td> </td><td class="rblock">   handshake packet originally sent by the <span class="insert">TCP Client</span> or <span class="insert">Server</span> was <span class="insert">non-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   capable</span> or ECN-capable because, in either case, an unsafe transition</td><td> </td><td class="rblock"><span class="insert">   ECN-capable</span> or ECN-capable because, in either case, an unsafe</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   could imply that future non-ECN-capable packets might get mangled.</td><td> </td><td class="rblock">   transition could imply that future non-ECN-capable packets might get</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   mangled.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Once a Data Sender has entered AccECN mode it is advised to check</td><td> </td><td class="right">   Once a Data Sender has entered AccECN mode it is advised to check</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whether it is receiving continuous CE marking.  Specifying exactly</td><td> </td><td class="right">   whether it is receiving continuous CE marking.  Specifying exactly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   how to do this is beyond the scope of the present specification, but</td><td> </td><td class="right">   how to do this is beyond the scope of the present specification, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the sender might check whether the feedback for every packet it sends</td><td> </td><td class="right">   the sender might check whether the feedback for every packet it sends</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   for the first three or four rounds indicates CE-marking.  If</td><td> </td><td class="right">   for the first three or four rounds indicates CE-marking.  If</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   continuous CE-marking is detected, for the remainder of the half-</td><td> </td><td class="right">   continuous CE-marking is detected, for the remainder of the half-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection, the Data Sender ought to send non-ECN-capable packets and</td><td> </td><td class="right">   connection, the Data Sender ought to send non-ECN-capable packets and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it is advised not to respond to any feedback of CE markings.  The</td><td> </td><td class="right">   it is advised not to respond to any feedback of CE markings.  The</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Data Sender might occasionally test whether it can resume sending</td><td> </td><td class="right">   Data Sender might occasionally test whether it can resume sending</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-11" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-11"><em> page 29, line 22<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-11"><em> page 29, line 16<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      apply solely when _data_ packets arrive, but the comparison with</td><td> </td><td class="right">      apply solely when _data_ packets arrive, but the comparison with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the previous packet includes any packet, not just data packets.</td><td> </td><td class="right">      the previous packet includes any packet, not just data packets.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Increment-Triggered ACKs:  An AccECN Data Receiver MUST emit an ACK</td><td> </td><td class="right">   Increment-Triggered ACKs:  An AccECN Data Receiver MUST emit an ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      if 'n' CE marks have arrived since the previous ACK.  If there is</td><td> </td><td class="right">      if 'n' CE marks have arrived since the previous ACK.  If there is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      newly delivered data to acknowledge, 'n' SHOULD be 2.  If there is</td><td> </td><td class="right">      newly delivered data to acknowledge, 'n' SHOULD be 2.  If there is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      no newly delivered data to acknowledge, 'n' SHOULD be 3 and MUST</td><td> </td><td class="right">      no newly delivered data to acknowledge, 'n' SHOULD be 3 and MUST</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      be no less than 3.  In either case, 'n' MUST be no greater than 7.</td><td> </td><td class="right">      be no less than 3.  In either case, 'n' MUST be no greater than 7.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The above rules for when to send an ACK are designed to be</td><td> </td><td class="right">   The above rules for when to send an ACK are designed to be</td><td class="lineno"><br></td></tr>
      <tr id="diff0117"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   complemented by those in Section 3.2.3.3, which concern whether <span class="delete">the</span></td><td> </td><td class="rblock">   complemented by those in Section 3.2.3.3, which concern whether <span class="insert">an</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN TCP Option ought to be included on ACKs.</td><td> </td><td class="right">   AccECN TCP Option ought to be included on ACKs.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the arrivals of a number of data packets are all processed as one</td><td> </td><td class="right">   If the arrivals of a number of data packets are all processed as one</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   event, e.g. using large receive offload (LRO) or generic receive</td><td> </td><td class="right">   event, e.g. using large receive offload (LRO) or generic receive</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   offload (GRO), both the above rules SHOULD be interpreted as</td><td> </td><td class="right">   offload (GRO), both the above rules SHOULD be interpreted as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   requiring multiple ACKs to be emitted back-to-back (for each</td><td> </td><td class="right">   requiring multiple ACKs to be emitted back-to-back (for each</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   transition and for each repetition by 'n' CE marks).  If this is</td><td> </td><td class="right">   transition and for each repetition by 'n' CE marks).  If this is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   problematic for high performance, either rule can be interpreted as</td><td> </td><td class="right">   problematic for high performance, either rule can be interpreted as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   requiring just a single ACK at the end of the whole receive event.</td><td> </td><td class="right">   requiring just a single ACK at the end of the whole receive event.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-12" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-12"><em> page 30, line 5<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-12"><em> page 30, line 5<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACKs but it feeds back the timing and the order in which ECN marks</td><td> </td><td class="right">   ACKs but it feeds back the timing and the order in which ECN marks</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   are received with minimal additional complexity.  If CE marks are</td><td> </td><td class="right">   are received with minimal additional complexity.  If CE marks are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   infrequent, as is the case for most AQMs at the time of writing, or</td><td> </td><td class="right">   infrequent, as is the case for most AQMs at the time of writing, or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   there are multiple marks in a row, the additional load will be low.</td><td> </td><td class="right">   there are multiple marks in a row, the additional load will be low.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   However, marking patterns with numerous non-contiguous CE marks could</td><td> </td><td class="right">   However, marking patterns with numerous non-contiguous CE marks could</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   increase the load significantly.  One possible compromise would be</td><td> </td><td class="right">   increase the load significantly.  One possible compromise would be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   for the receiver to heuristically detect whether the sender is in</td><td> </td><td class="right">   for the receiver to heuristically detect whether the sender is in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   slow-start, then to implement change-triggered ACKs while the sender</td><td> </td><td class="right">   slow-start, then to implement change-triggered ACKs while the sender</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   is in slow-start, and offload otherwise.</td><td> </td><td class="right">   is in slow-start, and offload otherwise.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0118"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">With ECN-capable</span> pure ACKs <span class="delete">[I-D.ietf-tcpm-generalized-ecn],</span> the</td><td> </td><td class="rblock">   <span class="insert">In a unidirectional data scenario from host A to B where both hosts</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   'Increment-Triggered ACKs' rule <span class="delete">could cause ECN-marked pure ACKs to</span></td><td> </td><td class="rblock"><span class="insert">   support AccECN, if the Data Receiver (B) has chosen to use ECN-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   trigger further ACKs.  Although TCP normally only ACKs newly</span></td><td> </td><td class="rblock"><span class="insert">   capable</span> pure ACKs <span class="insert">[I-D.ietf-tcpm-generalized-ecn] and enough of these</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   delivered data, in this case</span> the <span class="delete">ACKs of ACKs would feed back new</span></td><td> </td><td class="rblock"><span class="insert">   ACKs become CE-marked, then</span> the 'Increment-Triggered ACKs' rule</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   congestion state.  The minimum of 3 for 'n' in</span> this <span class="delete">case ensures</span></td><td> </td><td class="rblock">   <span class="insert">ensures that</span> the <span class="insert">Data Sender (A) gives B sufficient feedback about</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   that, even if there is pathological congestion in both directions,</span></td><td> </td><td class="rblock">   this <span class="insert">congestion.  Normally, the Data Sender (A) can piggyback</span> that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   any resulting ping-pong of ACKs will be rapidly damped.</span></td><td> </td><td class="rblock">   <span class="insert">feedback on its data.  But if A stops</span> sending <span class="insert">data, the second part</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock">   of the <span class="insert">'Increment-Triggered ACKs' rule ensures that A emits a</span> pure</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   These ACKs of ACKs could be misidentified as duplicate ACKs in</span></td><td> </td><td class="rblock">   ACK for <span class="insert">at least every third CE-marked</span> incoming <span class="insert">ACK over the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   certain circumstances described below.  Therefore, a host in AccECN</span></td><td> </td><td class="rblock"><span class="insert">   subsequent round trip.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   mode</span> that <span class="delete">is</span> sending <span class="delete">ECN-capable pure ACKs SHOULD add one</span> of the</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">following additional checks when it tests whether an incoming</span> pure</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ACK <span class="delete">is a duplicate:</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   *  If SACK has been negotatiated</span> for <span class="delete">the connection, but there is no</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      SACK option on the</span> incoming <span class="delete">pure ACK, it is not a duplicate;</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0119"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">*  If timestamps are in use, and the incoming pure ACK echoes a</span></td><td> </td><td class="rblock">   <span class="insert">Although TCP normally only ACKs newly delivered</span> data, <span class="insert">in this case</span> it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      timestamp older than the oldest unacknowledged</span> data, it is <span class="delete">not a</span></td><td> </td><td class="rblock">   is <span class="insert">mandatory for A to emit ACKs of ACKs because they feed back new</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      duplicate.</span></td><td> </td><td class="rblock"><span class="insert">   congestion state (useful in case B starts sending).  The minimum of 3</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   for 'n' in this case ensures that, even if A also uses ECN-capable</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   pure ACKs, and even if there is pathological congestion in both</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   directions, any resulting ping-pong of ACKs will be rapidly damped.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0120"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">In the unlikely event that neither SACK nor timestamps</span> are <span class="delete">in use, or</span></td><td> </td><td class="rblock">   <span class="insert">Certain measures</span> are <span class="insert">necessary</span> to <span class="insert">prevent incoming ACKs</span> of <span class="insert">ACKs being</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   if the implementation has opted not</span> to <span class="delete">include either of the above</span></td><td> </td><td class="rblock"><span class="insert">   mistaken for</span> duplicate <span class="insert">ACKs</span> in <span class="insert">some</span> circumstances.  <span class="insert">However, ACKs of</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   two checks, it SHOULD NOT send ECN-capable pure ACKs.  If it does, it</span></td><td> </td><td class="rblock"><span class="insert">   ACKs can only arise</span> if the <span class="insert">original</span> ACKs <span class="insert">are ECN-capable.  Therefore</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   could lead to false detection</span> of duplicate <span class="delete">ACKs, causing spurious</span></td><td> </td><td class="rblock">   the <span class="insert">necessary measures are specified in [I-D.ietf-tcpm-generalized-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   retransmission(s) with a resulting unnecessary reduction in</span></td><td> </td><td class="rblock"><span class="insert">   ecn]</span> as <span class="insert">a prerequisite for sending ECN-capable ACKs in</span> the <span class="insert">first</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   congestion window; but only</span> in <span class="delete">certain</span> circumstances.  <span class="delete">Specifically,</span></td><td> </td><td class="rblock"><span class="insert">   place.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   if <span class="delete">TCP peer A has been sending data, then receiving, then within one</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   round trip it starts sending again, and</span> the <span class="delete">ECN-capable pure</span> ACKs <span class="delete">it</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   sent in the previous round encounter heavy enough congestion to</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   trigger peer B to invoke</span> the <span class="delete">above 'n'-CE-mark rule.  Also note that</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   falsely considering these ACKs</span> as <span class="delete">duplicates would incorrectly imply</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   that data left</span> the <span class="delete">network.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.2.5.2.  Data Sender Safety Procedures</td><td> </td><td class="right">3.2.2.5.2.  Data Sender Safety Procedures</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the Data Sender has not received AccECN TCP Options to give it</td><td> </td><td class="right">   If the Data Sender has not received AccECN TCP Options to give it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   more dependable information, and it detects that the ACE field could</td><td> </td><td class="right">   more dependable information, and it detects that the ACE field could</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   have cycled, it SHOULD deem whether it cycled by taking the safest</td><td> </td><td class="right">   have cycled, it SHOULD deem whether it cycled by taking the safest</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   likely case under the prevailing conditions.  It can detect if the</td><td> </td><td class="right">   likely case under the prevailing conditions.  It can detect if the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counter could have cycled by using the jump in the acknowledgement</td><td> </td><td class="right">   counter could have cycled by using the jump in the acknowledgement</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   number since the last ACK to calculate or estimate how many segments</td><td> </td><td class="right">   number since the last ACK to calculate or estimate how many segments</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   could have been acknowledged.  An example algorithm to implement this</td><td> </td><td class="right">   could have been acknowledged.  An example algorithm to implement this</td><td class="lineno"><br></td></tr>
      <tr id="diff0121"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   policy is given in Appendix A.2.  An <span class="delete">implementer</span> MAY <span class="delete">develop</span> an</td><td> </td><td class="rblock">   policy is given in Appendix A.2.  An <span class="insert">implementation</span> MAY <span class="insert">use</span> an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   alternative algorithm as long as it satisfies <span class="delete">these requirements.</span></td><td> </td><td class="rblock">   alternative algorithm as long as it satisfies <span class="insert">the requirements in</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   this subsection.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If missing acknowledgement numbers arrive later (reordering) and</td><td> </td><td class="right">   If missing acknowledgement numbers arrive later (reordering) and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   prove that the counter did not cycle, the Data Sender MAY attempt to</td><td> </td><td class="right">   prove that the counter did not cycle, the Data Sender MAY attempt to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   neutralize the effect of any action it took based on a conservative</td><td> </td><td class="right">   neutralize the effect of any action it took based on a conservative</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   assumption that it later found to be incorrect.</td><td> </td><td class="right">   assumption that it later found to be incorrect.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The Data Sender can estimate how many packets (of any marking) an ACK</td><td> </td><td class="right">   The Data Sender can estimate how many packets (of any marking) an ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   acknowledges.  If the ACE counter on an ACK seems to imply that the</td><td> </td><td class="right">   acknowledges.  If the ACE counter on an ACK seems to imply that the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   minimum number of newly CE-marked packets is greater than the number</td><td> </td><td class="right">   minimum number of newly CE-marked packets is greater than the number</td><td class="lineno"><br></td></tr>
      <tr id="diff0122"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   of newly acknowledged packets, the Data Sender SHOULD <span class="delete">believe</span> the ACE</td><td> </td><td class="rblock">   of newly acknowledged packets, the Data Sender SHOULD <span class="insert">consider</span> the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">counter,</span> unless it can be sure that it is counting all control</td><td> </td><td class="rblock">   ACE <span class="insert">counter to be correct (and its count of control packets to be</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   incomplete),</span> unless it can be sure that it is counting all control</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets correctly.</td><td> </td><td class="right">   packets correctly.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.  The AccECN Option</td><td> </td><td class="right">3.2.3.  The AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0123"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">The</span> AccECN <span class="delete">Option is</span> defined as shown in Figure 4.  The initial 'E'</td><td> </td><td class="rblock">   <span class="insert">Two alternative</span> AccECN <span class="insert">Options are</span> defined as shown in Figure 4.  The</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   of each field name stands for 'Echo'.</td><td> </td><td class="rblock">   initial 'E' of each field name stands for 'Echo'.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">    0                   1                   2                   3</td><td> </td><td class="right">    0                   1                   2                   3</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</td><td> </td><td class="right">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr id="diff0124"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   |  Kind = <span class="delete">TBD0</span>  |  Length = 11  |          EE0B field           |</td><td> </td><td class="rblock">   |  Kind = <span class="insert">172 </span>  |  Length = 11  |          EE0B field           |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | EE0B (cont'd) |           ECEB field                          |</td><td> </td><td class="right">   | EE0B (cont'd) |           ECEB field                          |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   |                  EE1B field                   |             Order 0</td><td> </td><td class="right">   |                  EE1B field                   |             Order 0</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">    0                   1                   2                   3</td><td> </td><td class="right">    0                   1                   2                   3</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</td><td> </td><td class="right">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr id="diff0125"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   |  Kind = <span class="delete">TBD1</span>  |  Length = 11  |          EE1B field           |</td><td> </td><td class="rblock">   |  Kind = <span class="insert">173 </span>  |  Length = 11  |          EE1B field           |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | EE1B (cont'd) |           ECEB field                          |</td><td> </td><td class="right">   | EE1B (cont'd) |           ECEB field                          |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   |                  EE0B field                   |             Order 1</td><td> </td><td class="right">   |                  EE0B field                   |             Order 1</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                      Figure 4: The AccECN TCP Option</td><td> </td><td class="right">                      Figure 4: The AccECN TCP Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Figure 4 shows two option field orders; order 0 and order 1.  They</td><td> </td><td class="right">   Figure 4 shows two option field orders; order 0 and order 1.  They</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   both consists of three 24-bit fields.  Order 0 provides the 24 least</td><td> </td><td class="right">   both consists of three 24-bit fields.  Order 0 provides the 24 least</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   significant bits of the r.e0b, r.ceb and r.e1b counters,</td><td> </td><td class="right">   significant bits of the r.e0b, r.ceb and r.e1b counters,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   respectively.  Order 1 provides the same fields, but in the opposite</td><td> </td><td class="right">   respectively.  Order 1 provides the same fields, but in the opposite</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   order.  On each packet, the Data Receiver can use whichever order is</td><td> </td><td class="right">   order.  On each packet, the Data Receiver can use whichever order is</td><td class="lineno"><br></td></tr>
      <tr id="diff0126"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   more efficient.</td><td> </td><td class="rblock">   more efficient.  <span class="insert">In either case, the bytes within the fields are in</span></td><td class="lineno">!!<br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   network byte order (big-endian).</span></td><td class="lineno">!!<br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When a Data Receiver sends an AccECN Option, it MUST set the Kind</td><td> </td><td class="right">   When a Data Receiver sends an AccECN Option, it MUST set the Kind</td><td class="lineno"><br></td></tr>
      <tr id="diff0127"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   field to <span class="delete">TBD0</span> if using Order 0, or to <span class="delete">TBD1</span> if using Order 1.  These</td><td> </td><td class="rblock">   field to <span class="insert">172</span> if using Order 0, or to <span class="insert">173</span> if using Order 1.  These two</td><td class="lineno">!!<br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   two new TCP Option Kinds are registered in Section 7 and called</td><td> </td><td class="rblock">   new TCP Option Kinds are registered in Section 7 and called</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   respectively AccECN0 and AccECN1.</td><td> </td><td class="right">   respectively AccECN0 and AccECN1.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Note that there is no field to feed back Not-ECT bytes.  Nonetheless</td><td> </td><td class="right">   Note that there is no field to feed back Not-ECT bytes.  Nonetheless</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   an algorithm for the Data Sender to calculate the number of payload</td><td> </td><td class="right">   an algorithm for the Data Sender to calculate the number of payload</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   bytes received as Not-ECT is given in Appendix A.4.</td><td> </td><td class="right">   bytes received as Not-ECT is given in Appendix A.4.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Whenever a Data Receiver sends an AccECN Option, the rules in</td><td> </td><td class="right">   Whenever a Data Receiver sends an AccECN Option, the rules in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.3.3 allow it to omit unchanged fields from the tail of</td><td> </td><td class="right">   Section 3.2.3.3 allow it to omit unchanged fields from the tail of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the option, to help cope with option space limitations, as long as it</td><td> </td><td class="right">   the option, to help cope with option space limitations, as long as it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   preserves the order of the remaining fields and includes any field</td><td> </td><td class="right">   preserves the order of the remaining fields and includes any field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-13" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-13"><em> page 32, line 41<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-13"><em> page 32, line 36<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">             +--------+------------------+------------------+</td><td> </td><td class="right">             +--------+------------------+------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                  Table 5: Fields included in AccECN TCP</td><td> </td><td class="right">                  Table 5: Fields included in AccECN TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                     Options of each length and type</td><td> </td><td class="right">                     Options of each length and type</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The empty option of Length=2 is provided to allow for a case where an</td><td> </td><td class="right">   The empty option of Length=2 is provided to allow for a case where an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN Option has to be sent (e.g. on the SYN/ACK to test the path),</td><td> </td><td class="right">   AccECN Option has to be sent (e.g. on the SYN/ACK to test the path),</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   but there is very limited space for the option.</td><td> </td><td class="right">   but there is very limited space for the option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   All implementations of a Data Sender that read any AccECN Option MUST</td><td> </td><td class="right">   All implementations of a Data Sender that read any AccECN Option MUST</td><td class="lineno"><br></td></tr>
      <tr id="diff0128"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   be able to read <span class="delete">in </span>AccECN Options of any of the above lengths.  For</td><td> </td><td class="rblock">   be able to read AccECN Options of any of the above lengths.  For</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   forward compatibility, if the AccECN Option is of any other length,</td><td> </td><td class="right">   forward compatibility, if the AccECN Option is of any other length,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   implementations MUST use those whole 3-octet fields that fit within</td><td> </td><td class="right">   implementations MUST use those whole 3-octet fields that fit within</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the length and ignore the remainder of the option, treating it as</td><td> </td><td class="right">   the length and ignore the remainder of the option, treating it as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   padding.</td><td> </td><td class="right">   padding.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0129"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">The</span> AccECN <span class="delete">Option has</span> to be optional to implement, because both</td><td> </td><td class="rblock">   AccECN <span class="insert">Options have</span> to be optional to implement, because both sender</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   sender and receiver have to be able to cope without <span class="delete">the option</span> anyway</td><td> </td><td class="rblock">   and receiver have to be able to cope without <span class="insert">options</span> anyway - in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   - in cases where <span class="delete">it does</span> not traverse a network path.  It is</td><td> </td><td class="rblock">   cases where <span class="insert">they do</span> not traverse a network path.  It is RECOMMENDED</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   RECOMMENDED to implement both sending and receiving of <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">   to implement both sending and receiving of AccECN <span class="insert">Options.</span>  Support</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Option.</span>  Support for <span class="delete">the</span> AccECN <span class="delete">Option</span> is particularly valuable over</td><td> </td><td class="rblock">   for AccECN <span class="insert">Options</span> is particularly valuable over paths that introduce</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   paths that introduce a high degree of ACK filtering, where the 3-bit</td><td> </td><td class="rblock">   a high degree of ACK filtering, where the 3-bit ACE counter alone</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ACE counter alone might sometimes be insufficient, when it is</td><td> </td><td class="rblock">   might sometimes be insufficient, when it is ambiguous whether it has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ambiguous whether it has wrapped.  If sending of <span class="delete">the</span> AccECN <span class="delete">Option</span> is</td><td> </td><td class="rblock">   wrapped.  If sending of AccECN <span class="insert">Options</span> is implemented, the fall-backs</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   implemented, the fall-backs described in this document will need to</td><td> </td><td class="rblock">   described in this document will need to be implemented as well</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   be implemented as well (unless solely for a controlled environment</td><td> </td><td class="rblock">   (unless solely for a controlled environment where path traversal is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   where path traversal is not considered a problem).  Even if a</td><td> </td><td class="rblock">   not considered a problem).  Even if a developer does not implement</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   developer does not implement logic to understand received AccECN</td><td> </td><td class="rblock">   logic to understand received AccECN Options, it is RECOMMENDED that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Options, it is RECOMMENDED that they implement logic to send AccECN</td><td> </td><td class="rblock">   they implement logic to send AccECN Options.  Otherwise, those remote</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Options.  Otherwise, those remote peers that implement the receiving</td><td> </td><td class="rblock">   peers that implement the receiving logic will still be excluded from</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   logic will still be excluded from congestion feedback that is robust</td><td> </td><td class="rblock">   congestion feedback that is robust against the increasingly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   against the increasingly aggressive ACK filtering in the Internet.</td><td> </td><td class="rblock">   aggressive ACK filtering in the Internet.  The logic to send AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The logic to send AccECN Options is the simpler to implement of the</td><td> </td><td class="rblock">   Options is the simpler to implement of the two sides.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   two sides.</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0130"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If a Data Receiver intends to send <span class="delete">the</span> AccECN Option at any time</td><td> </td><td class="rblock">   If a Data Receiver intends to send <span class="insert">an</span> AccECN Option at any time</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   during the rest of the connection it is RECOMMENDED to also test path</td><td> </td><td class="right">   during the rest of the connection it is RECOMMENDED to also test path</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   traversal of the AccECN Option as specified in Section 3.2.3.2.</td><td> </td><td class="right">   traversal of the AccECN Option as specified in Section 3.2.3.2.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.1.  Encoding and Decoding Feedback in the AccECN Option Fields</td><td> </td><td class="right">3.2.3.1.  Encoding and Decoding Feedback in the AccECN Option Fields</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Whenever the Data Receiver includes any of the counter fields (ECEB,</td><td> </td><td class="right">   Whenever the Data Receiver includes any of the counter fields (ECEB,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   EE0B, EE1B) in an AccECN Option, it MUST encode the 24 least</td><td> </td><td class="right">   EE0B, EE1B) in an AccECN Option, it MUST encode the 24 least</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   significant bits of the current value of the associated counter into</td><td> </td><td class="right">   significant bits of the current value of the associated counter into</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the field (respectively r.ceb, r.e0b, r.e1b).</td><td> </td><td class="right">   the field (respectively r.ceb, r.e0b, r.e1b).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0131"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Whenever the Data Sender receives ACK carrying an AccECN Option, it</td><td> </td><td class="rblock">   Whenever the Data Sender receives <span class="insert">an</span> ACK carrying an AccECN Option,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   first checks whether the ACK has already been superseded by another</td><td> </td><td class="rblock">   it first checks whether the ACK has already been superseded by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ACK in which case it ignores the ECN feedback.  If the ACK has not</td><td> </td><td class="rblock">   another ACK in which case it ignores the ECN feedback.  If the ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   been superseded, the Data Sender normally decodes the fields in the</td><td> </td><td class="rblock">   has not been superseded, the Data Sender normally decodes the fields</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN Option as follows.  For each field, it takes the least</td><td> </td><td class="rblock">   in the AccECN Option as follows.  For each field, it takes the least</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   significant 24 bits of its associated local counter (s.ceb, s.e0b or</td><td> </td><td class="right">   significant 24 bits of its associated local counter (s.ceb, s.e0b or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   s.e1b) and subtracts them from the counter in the associated field of</td><td> </td><td class="right">   s.e1b) and subtracts them from the counter in the associated field of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the incoming AccECN Option (respectively ECEB, EE0B, EE1B), to work</td><td> </td><td class="right">   the incoming AccECN Option (respectively ECEB, EE0B, EE1B), to work</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   out the minimum positive increment it could apply to s.ceb, s.e0b or</td><td> </td><td class="right">   out the minimum positive increment it could apply to s.ceb, s.e0b or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   s.e1b (assuming the field in the option only wrapped at most once).</td><td> </td><td class="right">   s.e1b (assuming the field in the option only wrapped at most once).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Appendix A.1 gives an example algorithm for the Data Receiver to</td><td> </td><td class="right">   Appendix A.1 gives an example algorithm for the Data Receiver to</td><td class="lineno"><br></td></tr>
      <tr id="diff0132"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   encode its byte counters into <span class="delete">the</span> AccECN Option, and for the Data</td><td> </td><td class="rblock">   encode its byte counters into <span class="insert">an</span> AccECN Option, and for the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Sender to decode the AccECN Option fields into its byte counters.</td><td> </td><td class="right">   Sender to decode the AccECN Option fields into its byte counters.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Note that, as specified in Section 3.2, any data on the SYN (SYN=1,</td><td> </td><td class="right">   Note that, as specified in Section 3.2, any data on the SYN (SYN=1,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK=0) is not included in any of the byte counters held locally for</td><td> </td><td class="right">   ACK=0) is not included in any of the byte counters held locally for</td><td class="lineno"><br></td></tr>
      <tr id="diff0133"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   each ECN marking nor in <span class="delete">the</span> AccECN Option on the wire.</td><td> </td><td class="rblock">   each ECN marking nor in <span class="insert">an</span> AccECN Option on the wire.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.  Path Traversal of the AccECN Option</td><td> </td><td class="right">3.2.3.2.  Path Traversal of the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr id="diff0134"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.1.  Testing the AccECN Option during the Handshake</td><td> </td><td class="right">3.2.3.2.1.  Testing the AccECN Option during the Handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0135"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The TCP <span class="delete">client MUST NOT include the</span> AccECN TCP Option on the SYN.  If</td><td> </td><td class="rblock">   The TCP <span class="insert">Client MUST NOT include an</span> AccECN TCP Option on the SYN.  If</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   there is somehow an AccECN Option on a SYN, it MUST be ignored when</td><td> </td><td class="right">   there is somehow an AccECN Option on a SYN, it MUST be ignored when</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   forwarded or received.  (A fall-back strategy for the loss of the</td><td> </td><td class="right">   forwarded or received.  (A fall-back strategy for the loss of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN, possibly due to middlebox interference, is specified in</td><td> </td><td class="right">   SYN, possibly due to middlebox interference, is specified in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.1.4.)</td><td> </td><td class="right">   Section 3.1.4.)</td><td class="lineno"><br></td></tr>
      <tr id="diff0136"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                                                                         </td><td> </td><td class="rblock">   A TCP <span class="insert">Server</span> that confirms its support for AccECN (in response to an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   A TCP <span class="delete">server</span> that confirms its support for AccECN (in response to an</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN SYN from the client as described in Section 3.1) SHOULD</td><td> </td><td class="right">   AccECN SYN from the client as described in Section 3.1) SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   include an AccECN TCP Option on the SYN/ACK.</td><td> </td><td class="right">   include an AccECN TCP Option on the SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0137"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   A TCP <span class="delete">c</span>lient that has successfully negotiated AccECN SHOULD include</td><td> </td><td class="rblock">   A TCP <span class="insert">C</span>lient that has successfully negotiated AccECN SHOULD include</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   an AccECN Option in the first ACK at the end of the 3WHS.  However,</td><td> </td><td class="right">   an AccECN Option in the first ACK at the end of the 3WHS.  However,</td><td class="lineno"><br></td></tr>
      <tr id="diff0138"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   this first ACK is not delivered reliably, so the TCP <span class="delete">c</span>lient SHOULD</td><td> </td><td class="rblock">   this first ACK is not delivered reliably, so the TCP <span class="insert">C</span>lient SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   also include an AccECN Option on the first data segment it sends (if</td><td> </td><td class="right">   also include an AccECN Option on the first data segment it sends (if</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it ever sends one).</td><td> </td><td class="right">   it ever sends one).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0139"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   A host MAY omit <span class="delete">the</span> AccECN Option in any of the above three cases due</td><td> </td><td class="rblock">   A host MAY omit <span class="insert">an</span> AccECN Option in any of the above three cases due</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to insufficient option space or if it has cached knowledge that the</td><td> </td><td class="right">   to insufficient option space or if it has cached knowledge that the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packet would be likely to be blocked on the path to the other host if</td><td> </td><td class="right">   packet would be likely to be blocked on the path to the other host if</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it included an AccECN Option.</td><td> </td><td class="right">   it included an AccECN Option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.2.  Testing for Loss of Packets Carrying the AccECN Option</td><td> </td><td class="right">3.2.3.2.2.  Testing for Loss of Packets Carrying the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0140"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If the TCP <span class="delete">s</span>erver has not received an ACK to acknowledge its SYN/ACK</td><td> </td><td class="rblock">   If the TCP <span class="insert">S</span>erver has not received an ACK to acknowledge its SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   after the normal TCP timeout or it receives a second SYN with a</td><td> </td><td class="right">   after the normal TCP timeout or it receives a second SYN with a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   request for AccECN support, then either the SYN/ACK might just have</td><td> </td><td class="right">   request for AccECN support, then either the SYN/ACK might just have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   been lost, e.g. due to congestion, or a middlebox might be blocking</td><td> </td><td class="right">   been lost, e.g. due to congestion, or a middlebox might be blocking</td><td class="lineno"><br></td></tr>
      <tr id="diff0141"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">the</span> AccECN <span class="delete">Option.</span>  To expedite connection setup, the TCP <span class="delete">server</span></td><td> </td><td class="rblock">   AccECN <span class="insert">Options.</span>  To expedite connection setup, the TCP <span class="insert">Server</span> SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   SHOULD retransmit the SYN/ACK repeating the same AE, CWR and ECE TCP</td><td> </td><td class="rblock">   retransmit the SYN/ACK repeating the same AE, CWR and ECE TCP flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flags as on the original SYN/ACK but with no AccECN Option.  If this</td><td> </td><td class="rblock">   as on the original SYN/ACK but with no AccECN Option.  If this</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   retransmission times out, to expedite connection setup, the TCP</td><td> </td><td class="right">   retransmission times out, to expedite connection setup, the TCP</td><td class="lineno"><br></td></tr>
      <tr id="diff0142"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">s</span>erver SHOULD disable AccECN and ECN for this connection by</td><td> </td><td class="rblock">   <span class="insert">S</span>erver SHOULD disable AccECN and ECN for this connection by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   retransmitting the SYN/ACK with AE=CWR=ECE=0 and no AccECN Option.</td><td> </td><td class="right">   retransmitting the SYN/ACK with AE=CWR=ECE=0 and no AccECN Option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This approach limits any interference by middleboxes that might drop</td><td> </td><td class="right">   This approach limits any interference by middleboxes that might drop</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets with unknown options, even though it is more likely that SYN/</td><td> </td><td class="right">   packets with unknown options, even though it is more likely that SYN/</td><td class="lineno"><br></td></tr>
      <tr id="diff0143"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ACK loss is due to congestion.  The TCP <span class="delete">server</span> MAY try to send</td><td> </td><td class="rblock">   ACK loss is due to congestion.  The TCP <span class="insert">Server</span> MAY try to send</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   another packet with <span class="delete">the</span> AccECN Option at a later point during the</td><td> </td><td class="rblock">   another packet with <span class="insert">an</span> AccECN Option at a later point during the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection but it ought to monitor if that packet got lost as well,</td><td> </td><td class="right">   connection but it ought to monitor if that packet got lost as well,</td><td class="lineno"><br></td></tr>
      <tr id="diff0144"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in which case it SHOULD disable the sending of <span class="delete">the AccECN Option</span> for</td><td> </td><td class="rblock">   in which case it SHOULD disable the sending of <span class="insert">AccECN Options</span> for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this half-connection.</td><td> </td><td class="right">   this half-connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Implementers MAY use other fall-back strategies if they are found to</td><td> </td><td class="right">   Implementers MAY use other fall-back strategies if they are found to</td><td class="lineno"><br></td></tr>
      <tr id="diff0145"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   be more effective (e.g. retrying <span class="delete">the</span> AccECN Option for a second time</td><td> </td><td class="rblock">   be more effective (e.g. retrying <span class="insert">an</span> AccECN Option for a second time</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   before fall-back - most appropriate during high levels of</td><td> </td><td class="right">   before fall-back - most appropriate during high levels of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   congestion).  However, other fall-back strategies will need to follow</td><td> </td><td class="right">   congestion).  However, other fall-back strategies will need to follow</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   all the rules in Section 3.1.5, which concern behaviour when SYNs or</td><td> </td><td class="right">   all the rules in Section 3.1.5, which concern behaviour when SYNs or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN/ACKs negotiating different types of feedback have been sent</td><td> </td><td class="right">   SYN/ACKs negotiating different types of feedback have been sent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   within the same connection.</td><td> </td><td class="right">   within the same connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0146"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If the TCP <span class="delete">client</span> detects that the first data segment it sent with</td><td> </td><td class="rblock">   If the TCP <span class="insert">Client</span> detects that the first data segment it sent with <span class="insert">an</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">the</span> AccECN Option was lost, it SHOULD fall back to no AccECN Option</td><td> </td><td class="rblock">   AccECN Option was lost, it SHOULD fall back to no AccECN Option on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   on the retransmission.  Again, implementers MAY use other fall-back</td><td> </td><td class="rblock">   the retransmission.  Again, implementers MAY use other fall-back</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   strategies such as attempting to retransmit a second segment with <span class="delete">the</span></td><td> </td><td class="rblock">   strategies such as attempting to retransmit a second segment with <span class="insert">an</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN Option before fall-back, and/or caching whether <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">   AccECN Option before fall-back, and/or caching whether AccECN <span class="insert">Options</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Option is</span> blocked for subsequent connections.  [RFC9040] further</td><td> </td><td class="rblock"><span class="insert">   are</span> blocked for subsequent connections.  [RFC9040] further discusses</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   discusses caching of TCP parameters and status information.</td><td> </td><td class="rblock">   caching of TCP parameters and status information.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If a middlebox is dropping packets with options it does not</td><td> </td><td class="right">   If a middlebox is dropping packets with options it does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   recognize, a host that is sending little or no data but mostly pure</td><td> </td><td class="right">   recognize, a host that is sending little or no data but mostly pure</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACKs will not inherently detect such losses.  Such a host MAY detect</td><td> </td><td class="right">   ACKs will not inherently detect such losses.  Such a host MAY detect</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   loss of ACKs carrying the AccECN Option by detecting whether the</td><td> </td><td class="right">   loss of ACKs carrying the AccECN Option by detecting whether the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   acknowledged data always reappears as a retransmission.  In such</td><td> </td><td class="right">   acknowledged data always reappears as a retransmission.  In such</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   cases, the host SHOULD disable the sending of the AccECN Option for</td><td> </td><td class="right">   cases, the host SHOULD disable the sending of the AccECN Option for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this half-connection.</td><td> </td><td class="right">   this half-connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0147"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If a host falls back to not sending <span class="delete">the</span> AccECN <span class="delete">Option,</span> it will</td><td> </td><td class="rblock">   If a host falls back to not sending AccECN <span class="insert">Options,</span> it will continue</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   continue to process any incoming AccECN Options as normal.</td><td> </td><td class="rblock">   to process any incoming AccECN Options as normal.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0148"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Either host MAY include <span class="delete">the</span> AccECN <span class="delete">Option</span> in a subsequent segment or</td><td> </td><td class="rblock">   Either host MAY include AccECN <span class="insert">Options</span> in a subsequent segment or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   segments to retest whether <span class="delete">the</span> AccECN <span class="delete">Option</span> can traverse the path.</td><td> </td><td class="rblock">   segments to retest whether AccECN <span class="insert">Options</span> can traverse the path.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0149"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Similarly, an AccECN end<span class="delete">-</span>point MAY separately memorize which data</td><td> </td><td class="rblock">   Similarly, an AccECN endpoint MAY separately memorize which data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets carried an AccECN Option and disable the sending of AccECN</td><td> </td><td class="right">   packets carried an AccECN Option and disable the sending of AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Options if the loss probability of those packets is significantly</td><td> </td><td class="right">   Options if the loss probability of those packets is significantly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   higher than that of all other data packets in the same connection.</td><td> </td><td class="right">   higher than that of all other data packets in the same connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.3.  Testing for Absence of the AccECN Option</td><td> </td><td class="right">3.2.3.2.3.  Testing for Absence of the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0150"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If the TCP <span class="delete">c</span>lient has successfully negotiated AccECN but does not</td><td> </td><td class="rblock">   If the TCP <span class="insert">C</span>lient has successfully negotiated AccECN but does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   receive an AccECN Option on the SYN/ACK (e.g. because is has been</td><td> </td><td class="right">   receive an AccECN Option on the SYN/ACK (e.g. because is has been</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   stripped by a middlebox or not sent by the server), the client</td><td> </td><td class="right">   stripped by a middlebox or not sent by the server), the client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   switches into a mode that assumes that the AccECN Option is not</td><td> </td><td class="right">   switches into a mode that assumes that the AccECN Option is not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available for this half connection.</td><td> </td><td class="right">   available for this half connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0151"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Similarly, if the TCP <span class="delete">s</span>erver has successfully negotiated AccECN but</td><td> </td><td class="rblock">   Similarly, if the TCP <span class="insert">S</span>erver has successfully negotiated AccECN but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   does not receive an AccECN Option on the first segment that</td><td> </td><td class="right">   does not receive an AccECN Option on the first segment that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   acknowledges sequence space at least covering the ISN, it switches</td><td> </td><td class="right">   acknowledges sequence space at least covering the ISN, it switches</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   into a mode that assumes that the AccECN Option is not available for</td><td> </td><td class="right">   into a mode that assumes that the AccECN Option is not available for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this half connection.</td><td> </td><td class="right">   this half connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   While a host is in this mode that assumes incoming AccECN Options are</td><td> </td><td class="right">   While a host is in this mode that assumes incoming AccECN Options are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   not available, it MUST adopt the conservative interpretation of the</td><td> </td><td class="right">   not available, it MUST adopt the conservative interpretation of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACE field discussed in Section 3.2.2.5.  However, it cannot make any</td><td> </td><td class="right">   ACE field discussed in Section 3.2.2.5.  However, it cannot make any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   assumption about support of outgoing AccECN Options on the other half</td><td> </td><td class="right">   assumption about support of outgoing AccECN Options on the other half</td><td class="lineno"><br></td></tr>
      <tr id="diff0152"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   connection, so it SHOULD continue to send <span class="delete">the</span> AccECN <span class="delete">Option</span> itself</td><td> </td><td class="rblock">   connection, so it SHOULD continue to send AccECN <span class="insert">Options</span> itself</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   (unless it has established that sending <span class="delete">the</span> AccECN <span class="delete">Option</span> is causing</td><td> </td><td class="rblock">   (unless it has established that sending AccECN <span class="insert">Options</span> is causing</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets to be blocked as in Section 3.2.3.2.2).</td><td> </td><td class="right">   packets to be blocked as in Section 3.2.3.2.2).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If a host is in the mode that assumes incoming AccECN Options are not</td><td> </td><td class="right">   If a host is in the mode that assumes incoming AccECN Options are not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available, but it receives an AccECN Option at any later point during</td><td> </td><td class="right">   available, but it receives an AccECN Option at any later point during</td><td class="lineno"><br></td></tr>
      <tr id="diff0153"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the connection, this clearly indicates that <span class="delete">the</span> AccECN <span class="delete">Option is not</span></td><td> </td><td class="rblock">   the connection, this clearly indicates that AccECN <span class="insert">Options are no</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   blocked on the respective path, and the AccECN endpoint MAY switch</td><td> </td><td class="rblock"><span class="insert">   longer</span> blocked on the respective path, and the AccECN endpoint MAY</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   out of the mode that assumes <span class="delete">the</span> AccECN <span class="delete">Option is</span> not available for</td><td> </td><td class="rblock">   switch out of the mode that assumes AccECN <span class="insert">Options are</span> not available</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   this half connection.</td><td> </td><td class="rblock">   for this half connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.4.  Test for Zeroing of the AccECN Option</td><td> </td><td class="right">3.2.3.2.4.  Test for Zeroing of the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   For a related test for invalid initialization of the ACE field, see</td><td> </td><td class="right">   For a related test for invalid initialization of the ACE field, see</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.2.4</td><td> </td><td class="right">   Section 3.2.2.4</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.1 required the Data Receiver to initialize the r.e0b and</td><td> </td><td class="right">   Section 3.2.1 required the Data Receiver to initialize the r.e0b and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   r.e1b counters to a non-zero value.  Therefore, in either direction</td><td> </td><td class="right">   r.e1b counters to a non-zero value.  Therefore, in either direction</td><td class="lineno"><br></td></tr>
      <tr id="diff0154"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the initial value of the EE0B field or EE1B field in <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">   the initial value of the EE0B field or EE1B field in <span class="insert">an</span> AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Option (if one exists) ought to be non-zero.  If AccECN has been</td><td> </td><td class="rblock">   (if one exists) ought to be non-zero.  If AccECN has been negotiated:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   negotiated:</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0155"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  the TCP <span class="delete">s</span>erver MAY check that the initial value of the EE0B field</td><td> </td><td class="rblock">   *  the TCP <span class="insert">S</span>erver MAY check that the initial value of the EE0B field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      or the EE1B field is non-zero in the first segment that</td><td> </td><td class="right">      or the EE1B field is non-zero in the first segment that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      acknowledges sequence space that at least covers the ISN plus 1.</td><td> </td><td class="right">      acknowledges sequence space that at least covers the ISN plus 1.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      If it runs a test and either initial value is zero, the server</td><td> </td><td class="right">      If it runs a test and either initial value is zero, the server</td><td class="lineno"><br></td></tr>
      <tr id="diff0156"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      will switch into a mode that ignores <span class="delete">the</span> AccECN <span class="delete">Option</span> for this</td><td> </td><td class="rblock">      will switch into a mode that ignores AccECN <span class="insert">Options</span> for this half</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      half connection.</td><td> </td><td class="rblock">      connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0157"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  the TCP <span class="delete">c</span>lient MAY check the initial value of the EE0B field or</td><td> </td><td class="rblock">   *  the TCP <span class="insert">C</span>lient MAY check the initial value of the EE0B field or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the EE1B field is non-zero on the SYN/ACK.  If it runs a test and</td><td> </td><td class="right">      the EE1B field is non-zero on the SYN/ACK.  If it runs a test and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      either initial value is zero, the client will switch into a mode</td><td> </td><td class="right">      either initial value is zero, the client will switch into a mode</td><td class="lineno"><br></td></tr>
      <tr id="diff0158"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      that ignores <span class="delete">the AccECN Option</span> for this half connection.</td><td> </td><td class="rblock">      that ignores <span class="insert">AccECN Options</span> for this half connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0159"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   While a host is in the mode that ignores <span class="delete">the</span> AccECN <span class="delete">Option</span> it MUST</td><td> </td><td class="rblock">   While a host is in the mode that ignores AccECN <span class="insert">Options</span> it MUST adopt</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   adopt the conservative interpretation of the ACE field discussed in</td><td> </td><td class="rblock">   the conservative interpretation of the ACE field discussed in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.2.5.</td><td> </td><td class="right">   Section 3.2.2.5.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Note that the Data Sender MUST NOT test whether the arriving byte</td><td> </td><td class="right">   Note that the Data Sender MUST NOT test whether the arriving byte</td><td class="lineno"><br></td></tr>
      <tr id="diff0160"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   counters in <span class="delete">the</span> initial AccECN Option have been initialized to</td><td> </td><td class="rblock">   counters in <span class="insert">an</span> initial AccECN Option have been initialized to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specific valid values - the above checks solely test whether these</td><td> </td><td class="right">   specific valid values - the above checks solely test whether these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   fields have been incorrectly zeroed.  This allows hosts to use</td><td> </td><td class="right">   fields have been incorrectly zeroed.  This allows hosts to use</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   different initial values as an additional signalling channel in</td><td> </td><td class="right">   different initial values as an additional signalling channel in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   future.  Also note that the initial value of either field might be</td><td> </td><td class="right">   future.  Also note that the initial value of either field might be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   greater than its expected initial value, because the counters might</td><td> </td><td class="right">   greater than its expected initial value, because the counters might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   already have been incremented.  Nonetheless, the initial values of</td><td> </td><td class="right">   already have been incremented.  Nonetheless, the initial values of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the counters have been chosen so that they cannot wrap to zero on</td><td> </td><td class="right">   the counters have been chosen so that they cannot wrap to zero on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   these initial segments.</td><td> </td><td class="right">   these initial segments.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.5.  Consistency between AccECN Feedback Fields</td><td> </td><td class="right">3.2.3.2.5.  Consistency between AccECN Feedback Fields</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0161"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   When <span class="delete">the</span> AccECN <span class="delete">Option is</span> available <span class="delete">it</span> ought to provide more</td><td> </td><td class="rblock">   When AccECN <span class="insert">Options are</span> available <span class="insert">they</span> ought to provide more</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   unambiguous feedback.  However, <span class="delete">it supplements</span> but <span class="delete">does</span> not replace</td><td> </td><td class="rblock">   unambiguous feedback.  However, <span class="insert">they supplement</span> but <span class="insert">do</span> not replace</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the ACE field.  An endpoint using AccECN feedback MUST always</td><td> </td><td class="right">   the ACE field.  An endpoint using AccECN feedback MUST always</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   reconcile the information provided in the ACE field with that in any</td><td> </td><td class="right">   reconcile the information provided in the ACE field with that in any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN Option, so that the state of the ACE-related packet counter</td><td> </td><td class="right">   AccECN Option, so that the state of the ACE-related packet counter</td><td class="lineno"><br></td></tr>
      <tr id="diff0162"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   can be relied on if future feedback does not carry <span class="delete">the</span> AccECN Option.</td><td> </td><td class="rblock">   can be relied on if future feedback does not carry <span class="insert">an</span> AccECN Option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0163"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If <span class="delete">the</span> AccECN <span class="delete">option</span> is present, the s.cep counter might increase</td><td> </td><td class="rblock">   If <span class="insert">an</span> AccECN <span class="insert">Option</span> is present, the s.cep counter might increase more</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   more than expected from the increase of the s.ceb counter (e.g. due</td><td> </td><td class="rblock">   than expected from the increase of the s.ceb counter (e.g. due to a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   to a CE-marked control packet).  The sender's response to such a</td><td> </td><td class="rblock">   CE-marked control packet).  The sender's response to such a situation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   situation is out of scope, and needs to be dealt with in a</td><td> </td><td class="rblock">   is out of scope, and needs to be dealt with in a specification that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   specification that uses ECN-capable control packets.  Theoretically,</td><td> </td><td class="rblock">   uses ECN-capable control packets.  Theoretically, this situation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   this situation could also occur if a middlebox mangled <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">   could also occur if a middlebox mangled <span class="insert">an</span> AccECN Option but not the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Option but not the ACE field.  However, the Data Sender has to assume</td><td> </td><td class="rblock">   ACE field.  However, the Data Sender has to assume that the integrity</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   that the integrity of <span class="delete">the</span> AccECN <span class="delete">Option</span> is sound, based on the above</td><td> </td><td class="rblock">   of AccECN <span class="insert">Options</span> is sound, based on the above test of the well-known</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   test of the well-known initial values and optionally other integrity</td><td> </td><td class="rblock">   initial values and optionally other integrity tests (Section 5.3).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   tests (Section 5.3).</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0164"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If either end<span class="delete">-</span>point detects that the s.ceb counter has increased but</td><td> </td><td class="rblock">   If either endpoint detects that the s.ceb counter has increased but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the s.cep has not (and by testing ACK coverage it is certain how much</td><td> </td><td class="right">   the s.cep has not (and by testing ACK coverage it is certain how much</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the ACE field has wrapped), and if there is no explanation other than</td><td> </td><td class="right">   the ACE field has wrapped), and if there is no explanation other than</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   an invalid protocol transition due to some form of feedback mangling,</td><td> </td><td class="right">   an invalid protocol transition due to some form of feedback mangling,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the Data Sender MUST disable sending ECN-capable packets for the</td><td> </td><td class="right">   the Data Sender MUST disable sending ECN-capable packets for the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   remainder of the half-connection by setting the IP/ECN field in all</td><td> </td><td class="right">   remainder of the half-connection by setting the IP/ECN field in all</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   subsequent packets to Not-ECT.</td><td> </td><td class="right">   subsequent packets to Not-ECT.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.3.  Usage of the AccECN TCP Option</td><td> </td><td class="right">3.2.3.3.  Usage of the AccECN TCP Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0165"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If a Data Receiver in AccECN mode intends to use <span class="delete">the</span> AccECN TCP</td><td> </td><td class="rblock">   If a Data Receiver in AccECN mode intends to use AccECN TCP <span class="insert">Options</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Option</span> to provide feedback, the rules below determine when it</td><td> </td><td class="rblock">   to provide feedback, the rules below determine when it includes an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   includes an AccECN TCP Option, and which fields to include, given</td><td> </td><td class="rblock">   AccECN TCP Option, and which fields to include, given other options</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   other options might be competing for limited option space:</td><td> </td><td class="rblock">   might be competing for limited option space:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Importance of Congestion Control:  AccECN is for congestion control,</td><td> </td><td class="right">   Importance of Congestion Control:  AccECN is for congestion control,</td><td class="lineno"><br></td></tr>
      <tr id="diff0166"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      which SHOULD generally <span class="delete">be considered important relative to</span> other</td><td> </td><td class="rblock">      which <span class="insert">implementations</span> SHOULD generally <span class="insert">prioritize over</span> other TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      TCP <span class="delete">options.</span></td><td> </td><td class="rblock">      <span class="insert">options when there is insufficient space for all the options in</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">      use.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      If SACK has been negotiated, and the smallest recommended AccECN</td><td> </td><td class="right">      If SACK has been negotiated, and the smallest recommended AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Option would leave insufficient space for two SACK blocks on a</td><td> </td><td class="right">      Option would leave insufficient space for two SACK blocks on a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      particular ACK, the Data Receiver MUST give precedence to the SACK</td><td> </td><td class="right">      particular ACK, the Data Receiver MUST give precedence to the SACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      option (total 18 octets), because loss feedback is more critical.</td><td> </td><td class="right">      option (total 18 octets), because loss feedback is more critical.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Recommended Simple Scheme:  The Data Receiver SHOULD include an</td><td> </td><td class="right">   Recommended Simple Scheme:  The Data Receiver SHOULD include an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      AccECN TCP Option on every scheduled ACK if any byte counter has</td><td> </td><td class="right">      AccECN TCP Option on every scheduled ACK if any byte counter has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      incremented since the last ACK.  Whenever possible, it SHOULD</td><td> </td><td class="right">      incremented since the last ACK.  Whenever possible, it SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      include a field for every byte counter that has changed at some</td><td> </td><td class="right">      include a field for every byte counter that has changed at some</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-14" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-14"><em> page 40, line 6<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-14"><em> page 39, line 45<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the r.e0b counter has never changed during the connection.</td><td> </td><td class="right">   the r.e0b counter has never changed during the connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   With the recommended scheme, if the data sending direction switches</td><td> </td><td class="right">   With the recommended scheme, if the data sending direction switches</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   during a connection, there can be cases where the AccECN TCP Option</td><td> </td><td class="right">   during a connection, there can be cases where the AccECN TCP Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that is meant to feed back the counter values at the end of a volley</td><td> </td><td class="right">   that is meant to feed back the counter values at the end of a volley</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in one direction never reaches the other peer, due to packet loss.</td><td> </td><td class="right">   in one direction never reaches the other peer, due to packet loss.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACE feedback ought to be sufficient to fill this gap, given accurate</td><td> </td><td class="right">   ACE feedback ought to be sufficient to fill this gap, given accurate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feedback becomes moot after data transmission has paused.</td><td> </td><td class="right">   feedback becomes moot after data transmission has paused.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Appendix A.3 gives an example algorithm to estimate the number of</td><td> </td><td class="right">   Appendix A.3 gives an example algorithm to estimate the number of</td><td class="lineno"><br></td></tr>
      <tr id="diff0167"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   marked bytes from the ACE field alone, if <span class="delete">the AccECN Option is</span> not</td><td> </td><td class="rblock">   marked bytes from the ACE field alone, if <span class="insert">AccECN Options are</span> not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available.</td><td> </td><td class="right">   available.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0168"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If a host has determined that segments with <span class="delete">the AccECN Option</span> always</td><td> </td><td class="rblock">   If a host has determined that segments with <span class="insert">AccECN Options</span> always</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   seem to be discarded somewhere along the path, it is no longer</td><td> </td><td class="right">   seem to be discarded somewhere along the path, it is no longer</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   obliged to follow any of the rules in this section.</td><td> </td><td class="right">   obliged to follow any of the rules in this section.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.3.  AccECN Compliance Requirements for TCP Proxies, Offload Engines</td><td> </td><td class="right">3.3.  AccECN Compliance Requirements for TCP Proxies, Offload Engines</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      and other Middleboxes</td><td> </td><td class="right">      and other Middleboxes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0169"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">Given AccECN alters the TCP protocol on the wire, this section</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   specifies new requirements on certain networking equipment that</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   forwards TCP and inspects TCP header information.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.3.1.  Requirements for TCP Proxies</td><td> </td><td class="right">3.3.1.  Requirements for TCP Proxies</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A large class of middleboxes split TCP connections.  Such a middlebox</td><td> </td><td class="right">   A large class of middleboxes split TCP connections.  Such a middlebox</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   would be compliant with the AccECN protocol if the TCP implementation</td><td> </td><td class="right">   would be compliant with the AccECN protocol if the TCP implementation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   on each side complied with the present AccECN specification and each</td><td> </td><td class="right">   on each side complied with the present AccECN specification and each</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   side negotiated AccECN independently of the other side.</td><td> </td><td class="right">   side negotiated AccECN independently of the other side.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.3.2.  Requirements for Transparent Middleboxes and TCP Normalizers</td><td> </td><td class="right">3.3.2.  Requirements for Transparent Middleboxes and TCP Normalizers</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Another large class of middleboxes intervenes to some degree at the</td><td> </td><td class="right">   Another large class of middleboxes intervenes to some degree at the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   transport layer, but attempts to be transparent (invisible) to the</td><td> </td><td class="right">   transport layer, but attempts to be transparent (invisible) to the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   end-to-end connection.  A subset of this class of middleboxes</td><td> </td><td class="right">   end-to-end connection.  A subset of this class of middleboxes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   attempts to `normalize' the TCP wire protocol by checking that all</td><td> </td><td class="right">   attempts to `normalize' the TCP wire protocol by checking that all</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   values in header fields comply with a rather narrow interpretation of</td><td> </td><td class="right">   values in header fields comply with a rather narrow interpretation of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the TCP specifications that is also not always up to date.</td><td> </td><td class="right">   the TCP specifications that is also not always up to date.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A middlebox that is not normalizing the TCP protocol and does not</td><td> </td><td class="right">   A middlebox that is not normalizing the TCP protocol and does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   itself act as a back-to-back pair of TCP endpoints (i.e. a middlebox</td><td> </td><td class="right">   itself act as a back-to-back pair of TCP endpoints (i.e. a middlebox</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that intends to be transparent or invisible at the transport layer)</td><td> </td><td class="right">   that intends to be transparent or invisible at the transport layer)</td><td class="lineno"><br></td></tr>
      <tr id="diff0170"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ought to forward <span class="delete">the AccECN TCP Option</span> unaltered, whether or not the</td><td> </td><td class="rblock">   ought to forward <span class="insert">AccECN TCP Options</span> unaltered, whether or not the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   length value matches one of those specified in Section 3.2.3, and</td><td> </td><td class="right">   length value matches one of those specified in Section 3.2.3, and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whether or not the initial values of the byte-counter fields match</td><td> </td><td class="right">   whether or not the initial values of the byte-counter fields match</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   those in Section 3.2.1.  This is because blocking apparently invalid</td><td> </td><td class="right">   those in Section 3.2.1.  This is because blocking apparently invalid</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   values prevents the standardized set of values being extended in</td><td> </td><td class="right">   values prevents the standardized set of values being extended in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   future (given outdated normalizers would block updated hosts from</td><td> </td><td class="right">   future (given outdated normalizers would block updated hosts from</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   using the extended AccECN standard).</td><td> </td><td class="right">   using the extended AccECN standard).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A TCP normalizer is likely to block or alter an AccECN TCP Option if</td><td> </td><td class="right">   A TCP normalizer is likely to block or alter an AccECN TCP Option if</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the length value or the initial values of its byte-counter fields do</td><td> </td><td class="right">   the length value or the initial values of its byte-counter fields do</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   not match one of those specified in Section 3.2.3 or Section 3.2.1.</td><td> </td><td class="right">   not match one of those specified in Section 3.2.3 or Section 3.2.1.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   However, to comply with the present AccECN specification, a middlebox</td><td> </td><td class="right">   However, to comply with the present AccECN specification, a middlebox</td><td class="lineno"><br></td></tr>
      <tr id="diff0171"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   MUST NOT change the ACE field; or those fields of <span class="delete">the</span> AccECN Option</td><td> </td><td class="rblock">   MUST NOT change the ACE field; or those fields of <span class="insert">an</span> AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that are currently specified in Section 3.2.3; or any AccECN field</td><td> </td><td class="right">   that are currently specified in Section 3.2.3; or any AccECN field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   covered by integrity protection (e.g. [RFC5925]).</td><td> </td><td class="right">   covered by integrity protection (e.g. [RFC5925]).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.3.3.  Requirements for TCP ACK Filtering</td><td> </td><td class="right">3.3.3.  Requirements for TCP ACK Filtering</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 5.2.1 of BCP 69 [RFC3449] gives best current practice on</td><td> </td><td class="right">   Section 5.2.1 of BCP 69 [RFC3449] gives best current practice on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   filtering (aka. thinning or coalescing) of pure TCP ACKs.  It advises</td><td> </td><td class="right">   filtering (aka. thinning or coalescing) of pure TCP ACKs.  It advises</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that filtering ACKs carrying ECN feedback ought to preserve the</td><td> </td><td class="right">   that filtering ACKs carrying ECN feedback ought to preserve the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   correct operation of ECN feedback.  As the present specification</td><td> </td><td class="right">   correct operation of ECN feedback.  As the present specification</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   updates the operation of ECN feedback, this section discusses how an</td><td> </td><td class="right">   updates the operation of ECN feedback, this section discusses how an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-15" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-15"><em> page 41, line 37<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-15"><em> page 41, line 37<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      only deployment experience will tell.  Also, TCP ACKs might be</td><td> </td><td class="right">      only deployment experience will tell.  Also, TCP ACKs might be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ECN-capable owing to some scheme other than AccECN, e.g. [RFC5690]</td><td> </td><td class="right">      ECN-capable owing to some scheme other than AccECN, e.g. [RFC5690]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      or some future standards action.  Again, only deployment</td><td> </td><td class="right">      or some future standards action.  Again, only deployment</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      experience will tell.</td><td> </td><td class="right">      experience will tell.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The main concern with preserving correct AccECN operation involves</td><td> </td><td class="right">   *  The main concern with preserving correct AccECN operation involves</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      leaving enough ACKs for the Data Sender to work out whether the</td><td> </td><td class="right">      leaving enough ACKs for the Data Sender to work out whether the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      3-bit ACE field has wrapped.  In the worst case, in feedback about</td><td> </td><td class="right">      3-bit ACE field has wrapped.  In the worst case, in feedback about</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      a run of received packets that were all ECN-marked, the ACE field</td><td> </td><td class="right">      a run of received packets that were all ECN-marked, the ACE field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      will wrap every 8 acknowledged packets.  ACE field wrap might be</td><td> </td><td class="right">      will wrap every 8 acknowledged packets.  ACE field wrap might be</td><td class="lineno"><br></td></tr>
      <tr id="diff0172"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      of less concern if packets also carry <span class="delete">the AccECN TCP Option</span>.</td><td> </td><td class="rblock">      of less concern if packets also carry <span class="insert">AccECN TCP Options</span>.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      However, note that logic to read an AccECN TCP Option is optional</td><td> </td><td class="right">      However, note that logic to read an AccECN TCP Option is optional</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      to implement (albeit recommended -- see Section 3.2.3).  So one</td><td> </td><td class="right">      to implement (albeit recommended -- see Section 3.2.3).  So one</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      end writing an AccECN TCP Option into a packet does not</td><td> </td><td class="right">      end writing an AccECN TCP Option into a packet does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      necessarily imply that the other end will read it.</td><td> </td><td class="right">      necessarily imply that the other end will read it.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Note that the present specification of AccECN in TCP does not presume</td><td> </td><td class="right">   Note that the present specification of AccECN in TCP does not presume</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to rely on any of the above ACK filtering behaviour in the network,</td><td> </td><td class="right">   to rely on any of the above ACK filtering behaviour in the network,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   because it has to be robust against pre-existing network nodes that</td><td> </td><td class="right">   because it has to be robust against pre-existing network nodes that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   do not distinguish AccECN ACKs, and robust against ACK loss during</td><td> </td><td class="right">   do not distinguish AccECN ACKs, and robust against ACK loss during</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   overload more generally.</td><td> </td><td class="right">   overload more generally.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-16" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-16"><em> page 43, line 7<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-16"><em> page 43, line 7<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   control.  Once offload hardware supports AccECN, it will be able to</td><td> </td><td class="right">   control.  Once offload hardware supports AccECN, it will be able to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   coalesce efficiently for any sequence of marks, instead of relying</td><td> </td><td class="right">   coalesce efficiently for any sequence of marks, instead of relying</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   for efficiency on the long marking sequences from step marking.  In</td><td> </td><td class="right">   for efficiency on the long marking sequences from step marking.  In</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the next stage, marking can evolve from a step to a ramp function.</td><td> </td><td class="right">   the next stage, marking can evolve from a step to a ramp function.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   That in turn will allow host congestion control algorithms to respond</td><td> </td><td class="right">   That in turn will allow host congestion control algorithms to respond</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   faster to dynamics, while being backwards compatible with existing</td><td> </td><td class="right">   faster to dynamics, while being backwards compatible with existing</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   host algorithms.</td><td> </td><td class="right">   host algorithms.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">4.  Updates to RFC 3168</td><td> </td><td class="right">4.  Updates to RFC 3168</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0173"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Normative statements in the following sections</span> of RFC3168 are updated</td><td> </td><td class="rblock">   <span class="insert">This section clarifies which parts</span> of RFC3168 are updated <span class="insert">and maps</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">by</span> the present AccECN <span class="delete">specification:</span></td><td> </td><td class="rblock"><span class="insert">   them to the sections of</span> the present AccECN <span class="insert">specification that update</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   them:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The whole of "6.1.1 TCP Initialization" of [RFC3168] is updated by</td><td> </td><td class="right">   *  The whole of "6.1.1 TCP Initialization" of [RFC3168] is updated by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Section 3.1 of the present specification.</td><td> </td><td class="right">      Section 3.1 of the present specification.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  In "6.1.2.  The TCP Sender" of [RFC3168], all mentions of a</td><td> </td><td class="right">   *  In "6.1.2.  The TCP Sender" of [RFC3168], all mentions of a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      congestion response to an ECN-Echo (ECE) ACK packet are updated by</td><td> </td><td class="right">      congestion response to an ECN-Echo (ECE) ACK packet are updated by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Section 3.2 of the present specification to mean an increment to</td><td> </td><td class="right">      Section 3.2 of the present specification to mean an increment to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the sender's count of CE-marked packets, s.cep.  And the</td><td> </td><td class="right">      the sender's count of CE-marked packets, s.cep.  And the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      requirements to set the CWR flag no longer apply, as specified in</td><td> </td><td class="right">      requirements to set the CWR flag no longer apply, as specified in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Section 3.1.5 of the present specification.  Otherwise, the</td><td> </td><td class="right">      Section 3.1.5 of the present specification.  Otherwise, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-17" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-17"><em> page 43, line 35<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-17"><em> page 43, line 36<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      RFC 8311 enables experimentation with alternative responses to ECN</td><td> </td><td class="right">      RFC 8311 enables experimentation with alternative responses to ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      marking, if specified for instance by an experimental RFC on the</td><td> </td><td class="right">      marking, if specified for instance by an experimental RFC on the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      IETF document stream.  RFC 8311 also strengthened the statement</td><td> </td><td class="right">      IETF document stream.  RFC 8311 also strengthened the statement</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      that "ECT(0) SHOULD be used" to a "MUST" (see [RFC8311] for the</td><td> </td><td class="right">      that "ECT(0) SHOULD be used" to a "MUST" (see [RFC8311] for the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      details).</td><td> </td><td class="right">      details).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The whole of "6.1.3.  The TCP Receiver" of [RFC3168] is updated by</td><td> </td><td class="right">   *  The whole of "6.1.3.  The TCP Receiver" of [RFC3168] is updated by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Section 3.2 of the present specification, with the exception of</td><td> </td><td class="right">      Section 3.2 of the present specification, with the exception of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the last paragraph (about congestion response to drop and ECN in</td><td> </td><td class="right">      the last paragraph (about congestion response to drop and ECN in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the same round trip), which still stands.  Incidentally, this last</td><td> </td><td class="right">      the same round trip), which still stands.  Incidentally, this last</td><td class="lineno"><br></td></tr>
      <tr id="diff0174"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      paragraph is in the wrong section, because it relates to <span class="delete">TCP</span></td><td> </td><td class="rblock">      paragraph is in the wrong section, because it relates to <span class="insert">"TCP</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      sender</span> behaviour.</td><td> </td><td class="rblock"><span class="insert">      Sender"</span> behaviour.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The following text within "6.1.5.  Retransmitted TCP packets":</td><td> </td><td class="right">   *  The following text within "6.1.5.  Retransmitted TCP packets":</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         "the TCP data receiver SHOULD ignore the ECN field on arriving</td><td> </td><td class="right">         "the TCP data receiver SHOULD ignore the ECN field on arriving</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         data packets that are outside of the receiver's current</td><td> </td><td class="right">         data packets that are outside of the receiver's current</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         window."</td><td> </td><td class="right">         window."</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      is updated by more stringent acceptability tests for any packet</td><td> </td><td class="right">      is updated by more stringent acceptability tests for any packet</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      (not just data packets) in the present specification.</td><td> </td><td class="right">      (not just data packets) in the present specification.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Specifically, in the normative specification of AccECN (Section 3)</td><td> </td><td class="right">      Specifically, in the normative specification of AccECN (Section 3)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-18" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-18"><em> page 44, line 20<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-18"><em> page 44, line 20<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      This ensures AccECN is forward compatible with any future scheme</td><td> </td><td class="right">      This ensures AccECN is forward compatible with any future scheme</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      that allows ECN on these packets, as provided for in section 4.3</td><td> </td><td class="right">      that allows ECN on these packets, as provided for in section 4.3</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      of [RFC8311] and as proposed in [I-D.ietf-tcpm-generalized-ecn].</td><td> </td><td class="right">      of [RFC8311] and as proposed in [I-D.ietf-tcpm-generalized-ecn].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">5.  Interaction with TCP Variants</td><td> </td><td class="right">5.  Interaction with TCP Variants</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This section is informative, not normative.</td><td> </td><td class="right">   This section is informative, not normative.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">5.1.  Compatibility with SYN Cookies</td><td> </td><td class="right">5.1.  Compatibility with SYN Cookies</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0175"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   A TCP <span class="delete">s</span>erver can use SYN Cookies (see Appendix A of [RFC4987]) to</td><td> </td><td class="rblock">   A TCP <span class="insert">S</span>erver can use SYN Cookies (see Appendix A of [RFC4987]) to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   protect itself from SYN flooding attacks.  It places minimal commonly</td><td> </td><td class="right">   protect itself from SYN flooding attacks.  It places minimal commonly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   used connection state in the SYN/ACK, and deliberately does not hold</td><td> </td><td class="right">   used connection state in the SYN/ACK, and deliberately does not hold</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   any state while waiting for the subsequent ACK (e.g. it closes the</td><td> </td><td class="right">   any state while waiting for the subsequent ACK (e.g. it closes the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   thread).  Therefore it cannot record the fact that it entered AccECN</td><td> </td><td class="right">   thread).  Therefore it cannot record the fact that it entered AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   mode for both half-connections.  Indeed, it cannot even remember</td><td> </td><td class="right">   mode for both half-connections.  Indeed, it cannot even remember</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whether it negotiated the use of classic ECN [RFC3168].</td><td> </td><td class="right">   whether it negotiated the use of classic ECN [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Nonetheless, such a server can determine that it negotiated AccECN as</td><td> </td><td class="right">   Nonetheless, such a server can determine that it negotiated AccECN as</td><td class="lineno"><br></td></tr>
      <tr id="diff0176"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   follows.  If a TCP <span class="delete">s</span>erver using SYN Cookies supports AccECN and if it</td><td> </td><td class="rblock">   follows.  If a TCP <span class="insert">S</span>erver using SYN Cookies supports AccECN and if it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   receives a pure ACK that acknowledges an ISN that is a valid SYN</td><td> </td><td class="right">   receives a pure ACK that acknowledges an ISN that is a valid SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   cookie, and if the ACK contains an ACE field with the value 0b010 to</td><td> </td><td class="right">   cookie, and if the ACK contains an ACE field with the value 0b010 to</td><td class="lineno"><br></td></tr>
      <tr id="diff0177"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   0b111 (decimal 2 to 7), <span class="delete">it</span> can <span class="delete">assume that:</span></td><td> </td><td class="rblock">   0b111 (decimal 2 to 7), <span class="insert">the server</span> can <span class="insert">infer the first two stages of</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   the handshake:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0178"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  the TCP <span class="delete">client has to have requested AccECN support on the SYN</span></td><td> </td><td class="rblock">   *  the TCP <span class="insert">Client has to have requested AccECN support on the SYN;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0179"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  it <span class="delete">(the server)</span> has to have confirmed that it supported <span class="delete">AccECN</span></td><td> </td><td class="rblock">   *  <span class="insert">then, even though the server kept no state,</span> it has to have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">      confirmed that it supported <span class="insert">AccECN.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Therefore the server can switch itself into AccECN mode, and continue</td><td> </td><td class="right">   Therefore the server can switch itself into AccECN mode, and continue</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   as if it had never forgotten that it switched itself into AccECN mode</td><td> </td><td class="right">   as if it had never forgotten that it switched itself into AccECN mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   earlier.</td><td> </td><td class="right">   earlier.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the pure ACK that acknowledges a SYN cookie contains an ACE field</td><td> </td><td class="right">   If the pure ACK that acknowledges a SYN cookie contains an ACE field</td><td class="lineno"><br></td></tr>
      <tr id="diff0180"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   with the value 0b000 or 0b001, these values indicate that the <span class="delete">client</span></td><td> </td><td class="rblock">   with the value 0b000 or 0b001, these values indicate that the <span class="insert">TCP</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   did not request support for AccECN and therefore the server does not</td><td> </td><td class="rblock"><span class="insert">   Client</span> did not request support for AccECN and therefore the server</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   enter AccECN mode for this connection.  Further, 0b001 on the ACK</td><td> </td><td class="rblock">   does not enter AccECN mode for this connection.  Further, 0b001 on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   implies that the server sent an ECN-capable SYN/ACK, which was marked</td><td> </td><td class="rblock">   the ACK implies that the server sent an ECN-capable SYN/ACK, which</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   CE in the network, and the non-AccECN <span class="delete">client</span> fed this back by setting</td><td> </td><td class="rblock">   was marked CE in the network, and the non-AccECN <span class="insert">TCP Client</span> fed this</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECE on the ACK of the SYN/ACK.</td><td> </td><td class="rblock">   back by setting ECE on the ACK of the SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">5.2.  Compatibility with TCP Experiments and Common TCP Options</td><td> </td><td class="right">5.2.  Compatibility with TCP Experiments and Common TCP Options</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN is compatible (at least on paper) with the most commonly used</td><td> </td><td class="right">   AccECN is compatible (at least on paper) with the most commonly used</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP options: MSS, time-stamp, window scaling, SACK and TCP-AO.  It is</td><td> </td><td class="right">   TCP options: MSS, time-stamp, window scaling, SACK and TCP-AO.  It is</td><td class="lineno"><br></td></tr>
      <tr id="diff0181"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   also compatible with the <span class="delete">recent promising</span> experimental TCP <span class="delete">options</span></td><td> </td><td class="rblock">   also compatible with <span class="insert">Multipath TCP (MPTCP [RFC8684]) and</span> the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   TCP Fast Open (TFO <span class="delete">[RFC7413]) and Multipath TCP (MPTCP [RFC8684]).</span></td><td> </td><td class="rblock">   experimental TCP <span class="insert">option</span> TCP Fast Open (TFO <span class="insert">[RFC7413]).</span>  AccECN is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN is friendly to all these protocols, because space for TCP</td><td> </td><td class="rblock">   friendly to all these protocols, because space for TCP options is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   options is particularly scarce on the SYN, where AccECN consumes zero</td><td> </td><td class="rblock">   particularly scarce on the SYN, where AccECN consumes zero additional</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   additional header space.</td><td> </td><td class="rblock">   header space.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When option space is under pressure from other options,</td><td> </td><td class="right">   When option space is under pressure from other options,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.3.3 provides guidance on how important it is to send an</td><td> </td><td class="right">   Section 3.2.3.3 provides guidance on how important it is to send an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN Option relative to other options, and which fields are more</td><td> </td><td class="right">   AccECN Option relative to other options, and which fields are more</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   important to include.</td><td> </td><td class="right">   important to include.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Implementers of TFO need to take careful note of the recommendation</td><td> </td><td class="right">   Implementers of TFO need to take careful note of the recommendation</td><td class="lineno"><br></td></tr>
      <tr id="diff0182"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in Section 3.2.2.1.  That section recommends that, if the <span class="delete">client</span> has</td><td> </td><td class="rblock">   in Section 3.2.2.1.  That section recommends that, if the <span class="insert">TCP Client</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   successfully negotiated AccECN, when acknowledging the SYN/ACK, even</td><td> </td><td class="rblock">   has successfully negotiated AccECN, when acknowledging the SYN/ACK,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   if it has data to send, it sends a pure ACK immediately before the</td><td> </td><td class="rblock">   even if it has data to send, it sends a pure ACK immediately before</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   data.  Then it can reflect the IP-ECN field of the SYN/ACK on this</td><td> </td><td class="rblock">   the data.  Then it can reflect the IP-ECN field of the SYN/ACK on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   pure ACK, which allows the server to detect ECN mangling.  Note that,</td><td> </td><td class="rblock">   this pure ACK, which allows the server to detect ECN mangling.  Note</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   as specified in Section 3.2, any data on the SYN (SYN=1, ACK=0) is</td><td> </td><td class="rblock">   that, as specified in Section 3.2, any data on the SYN (SYN=1, ACK=0)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   not included in any of the byte counters held locally for each ECN</td><td> </td><td class="rblock">   is not included in any of the byte counters held locally for each ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   marking, nor in the AccECN Option on the wire.</td><td> </td><td class="right">   marking, nor in the AccECN Option on the wire.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">5.3.  Compatibility with Feedback Integrity Mechanisms</td><td> </td><td class="right">5.3.  Compatibility with Feedback Integrity Mechanisms</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Three alternative mechanisms are available to assure the integrity of</td><td> </td><td class="right">   Three alternative mechanisms are available to assure the integrity of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN and/or loss signals.  AccECN is compatible with any of these</td><td> </td><td class="right">   ECN and/or loss signals.  AccECN is compatible with any of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   approaches:</td><td> </td><td class="right">   approaches:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The Data Sender can test the integrity of the receiver's ECN (or</td><td> </td><td class="right">   *  The Data Sender can test the integrity of the receiver's ECN (or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      loss) feedback by occasionally setting the IP-ECN field to a value</td><td> </td><td class="right">      loss) feedback by occasionally setting the IP-ECN field to a value</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      normally only set by the network (and/or deliberately leaving a</td><td> </td><td class="right">      normally only set by the network (and/or deliberately leaving a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      sequence number gap).  Then it can test whether the Data</td><td> </td><td class="right">      sequence number gap).  Then it can test whether the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Receiver's feedback faithfully reports what it expects (similar to</td><td> </td><td class="right">      Receiver's feedback faithfully reports what it expects (similar to</td><td class="lineno"><br></td></tr>
      <tr id="diff0183"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      para 2 of Section 20.2 of [RFC3168]).  Unlike the ECN Nonce</td><td> </td><td class="rblock">      para<span class="insert">graph</span> 2 of Section 20.2 of [RFC3168]).  Unlike the ECN Nonce</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      [RFC3540], this approach does not waste the ECT(1) codepoint in</td><td> </td><td class="right">      [RFC3540], this approach does not waste the ECT(1) codepoint in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the IP header, it does not require standardization and it does not</td><td> </td><td class="right">      the IP header, it does not require standardization and it does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      rely on misbehaving receivers volunteering to reveal feedback</td><td> </td><td class="right">      rely on misbehaving receivers volunteering to reveal feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      information that allows them to be detected.  However, setting the</td><td> </td><td class="right">      information that allows them to be detected.  However, setting the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      CE mark by the sender might conceal actual congestion feedback</td><td> </td><td class="right">      CE mark by the sender might conceal actual congestion feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      from the network and therefore ought to only be done sparingly.</td><td> </td><td class="right">      from the network and therefore ought to only be done sparingly.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  Networks generate congestion signals when they are becoming</td><td> </td><td class="right">   *  Networks generate congestion signals when they are becoming</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      congested, so networks are more likely than Data Senders to be</td><td> </td><td class="right">      congested, so networks are more likely than Data Senders to be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      concerned about the integrity of the receiver's feedback of these</td><td> </td><td class="right">      concerned about the integrity of the receiver's feedback of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-19" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-19"><em> page 46, line 22<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-19"><em> page 46, line 22<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      behaviour of a Data Sender would have to be more conservative than</td><td> </td><td class="right">      behaviour of a Data Sender would have to be more conservative than</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      would be necessary if it had the accurate feedback of AccECN.</td><td> </td><td class="right">      would be necessary if it had the accurate feedback of AccECN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The standards track TCP authentication option (TCP-AO [RFC5925])</td><td> </td><td class="right">   *  The standards track TCP authentication option (TCP-AO [RFC5925])</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      can be used to detect any tampering with AccECN feedback between</td><td> </td><td class="right">      can be used to detect any tampering with AccECN feedback between</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the Data Receiver and the Data Sender (whether malicious or</td><td> </td><td class="right">      the Data Receiver and the Data Sender (whether malicious or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      accidental).  The AccECN fields are immutable end-to-end, so they</td><td> </td><td class="right">      accidental).  The AccECN fields are immutable end-to-end, so they</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      are amenable to TCP-AO protection, which covers TCP options by</td><td> </td><td class="right">      are amenable to TCP-AO protection, which covers TCP options by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      default.  However, TCP-AO is often too brittle to use on many end-</td><td> </td><td class="right">      default.  However, TCP-AO is often too brittle to use on many end-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      to-end paths, where middleboxes can make verification fail in</td><td> </td><td class="right">      to-end paths, where middleboxes can make verification fail in</td><td class="lineno"><br></td></tr>
      <tr id="diff0184"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      their attempts to improve performance or security, e.g. <span class="delete">by</span></td><td> </td><td class="rblock">      their attempts to improve performance or security, e.g. <span class="insert">Network</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      resegmentation or shifting the sequence space.</td><td> </td><td class="rblock"><span class="insert">      Address (and Port) Translation (NAT/NAPT),</span> resegmentation or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">      shifting the sequence space.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Originally the ECN Nonce [RFC3540] was proposed to ensure integrity</td><td> </td><td class="right">   Originally the ECN Nonce [RFC3540] was proposed to ensure integrity</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of congestion feedback.  With minor changes AccECN could be optimized</td><td> </td><td class="right">   of congestion feedback.  With minor changes AccECN could be optimized</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   for the possibility that the ECT(1) codepoint might be used as an ECN</td><td> </td><td class="right">   for the possibility that the ECT(1) codepoint might be used as an ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Nonce.  However, given RFC 3540 has been reclassified as historic,</td><td> </td><td class="right">   Nonce.  However, given RFC 3540 has been reclassified as historic,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the AccECN design has been generalized so that it ought to be able to</td><td> </td><td class="right">   the AccECN design has been generalized so that it ought to be able to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   support other possible uses of the ECT(1) codepoint, such as a lower</td><td> </td><td class="right">   support other possible uses of the ECT(1) codepoint, such as a lower</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   severity or a more instant congestion signal than CE.</td><td> </td><td class="right">   severity or a more instant congestion signal than CE.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0185"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">6.  Protocol Properties</td><td> </td><td class="rblock">6.  <span class="insert">Summary: </span>Protocol Properties</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This section is informative not normative.  It describes how well the</td><td> </td><td class="right">   This section is informative not normative.  It describes how well the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   protocol satisfies the agreed requirements for a more accurate ECN</td><td> </td><td class="right">   protocol satisfies the agreed requirements for a more accurate ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feedback protocol [RFC7560].</td><td> </td><td class="right">   feedback protocol [RFC7560].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Accuracy:  From each ACK, the Data Sender can infer the number of new</td><td> </td><td class="right">   Accuracy:  From each ACK, the Data Sender can infer the number of new</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      CE marked segments since the previous ACK.  This provides better</td><td> </td><td class="right">      CE marked segments since the previous ACK.  This provides better</td><td class="lineno"><br></td></tr>
      <tr id="diff0186"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      accuracy on CE feedback than classic ECN.  In addition if <span class="delete">the</span></td><td> </td><td class="rblock">      accuracy on CE feedback than classic ECN.  In addition if <span class="insert">an</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      AccECN Option is present (not blocked by the network path) the</td><td> </td><td class="right">      AccECN Option is present (not blocked by the network path) the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      number of bytes marked with CE, ECT(1) and ECT(0) are provided.</td><td> </td><td class="right">      number of bytes marked with CE, ECT(1) and ECT(0) are provided.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Overhead:  The AccECN scheme is divided into two parts.  The</td><td> </td><td class="right">   Overhead:  The AccECN scheme is divided into two parts.  The</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      essential part reuses the 3 flags already assigned to ECN in the</td><td> </td><td class="right">      essential part reuses the 3 flags already assigned to ECN in the</td><td class="lineno"><br></td></tr>
      <tr id="diff0187"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">IP</span> header.  The supplementary part adds an additional TCP option</td><td> </td><td class="rblock">      <span class="insert">TCP</span> header.  The supplementary part adds an additional TCP option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      consuming up to 11 bytes.  However, no TCP option is consumed in</td><td> </td><td class="rblock">      consuming up to 11 bytes.  However, no TCP option <span class="insert">space</span> is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      the SYN.</td><td> </td><td class="rblock">      consumed in the SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Ordering:  The order in which marks arrive at the Data Receiver is</td><td> </td><td class="right">   Ordering:  The order in which marks arrive at the Data Receiver is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      preserved in AccECN feedback, because the Data Receiver is</td><td> </td><td class="right">      preserved in AccECN feedback, because the Data Receiver is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      expected to send an ACK immediately whenever a different mark</td><td> </td><td class="right">      expected to send an ACK immediately whenever a different mark</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      arrives.</td><td> </td><td class="right">      arrives.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Timeliness:  While the same ECN markings are arriving continually at</td><td> </td><td class="right">   Timeliness:  While the same ECN markings are arriving continually at</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the Data Receiver, it can defer ACKs as TCP does normally, but it</td><td> </td><td class="right">      the Data Receiver, it can defer ACKs as TCP does normally, but it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      will immediately send an ACK as soon as a different ECN marking</td><td> </td><td class="right">      will immediately send an ACK as soon as a different ECN marking</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      arrives.</td><td> </td><td class="right">      arrives.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Timeliness vs Overhead:  Change-Triggered ACKs are intended to enable</td><td> </td><td class="right">   Timeliness vs Overhead:  Change-Triggered ACKs are intended to enable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      latency-sensitive uses of ECN feedback by capturing the timing of</td><td> </td><td class="right">      latency-sensitive uses of ECN feedback by capturing the timing of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      transitions but not wasting resources while the state of the</td><td> </td><td class="right">      transitions but not wasting resources while the state of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      signalling system is stable.  Within the constraints of the</td><td> </td><td class="right">      signalling system is stable.  Within the constraints of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      change-triggered ACK rules, the receiver can control how</td><td> </td><td class="right">      change-triggered ACK rules, the receiver can control how</td><td class="lineno"><br></td></tr>
      <tr id="diff0188"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      frequently it sends <span class="delete">the AccECN TCP Option</span> and therefore to some</td><td> </td><td class="rblock">      frequently it sends <span class="insert">AccECN TCP Options</span> and therefore to some</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      extent it can control the overhead induced by AccECN.</td><td> </td><td class="right">      extent it can control the overhead induced by AccECN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Resilience:  All information is provided based on counters.</td><td> </td><td class="right">   Resilience:  All information is provided based on counters.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Therefore if ACKs are lost, the counters on the first ACK</td><td> </td><td class="right">      Therefore if ACKs are lost, the counters on the first ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      following the losses allows the Data Sender to immediately recover</td><td> </td><td class="right">      following the losses allows the Data Sender to immediately recover</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the number of the ECN markings that it missed.  And if data or</td><td> </td><td class="right">      the number of the ECN markings that it missed.  And if data or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ACKs are reordered, stale congestion information can be identified</td><td> </td><td class="right">      ACKs are reordered, stale congestion information can be identified</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      and ignored.</td><td> </td><td class="right">      and ignored.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Resilience against Bias:  Because feedback is based on repetition of</td><td> </td><td class="right">   Resilience against Bias:  Because feedback is based on repetition of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-20" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-20"><em> page 47, line 44<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-20"><em> page 47, line 46<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Resilience vs Overhead:  If space is limited in some segments</td><td> </td><td class="right">   Resilience vs Overhead:  If space is limited in some segments</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      (e.g. because more options are needed on some segments, such as</td><td> </td><td class="right">      (e.g. because more options are needed on some segments, such as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the SACK option after loss), the Data Receiver can send AccECN</td><td> </td><td class="right">      the SACK option after loss), the Data Receiver can send AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Options less frequently or truncate fields that have not changed,</td><td> </td><td class="right">      Options less frequently or truncate fields that have not changed,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      usually down to as little as 5 bytes.  However, it has to send a</td><td> </td><td class="right">      usually down to as little as 5 bytes.  However, it has to send a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      full-sized AccECN Option at least three times per RTT, which the</td><td> </td><td class="right">      full-sized AccECN Option at least three times per RTT, which the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Data Sender can rely on as a regular beacon or checkpoint.</td><td> </td><td class="right">      Data Sender can rely on as a regular beacon or checkpoint.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Resilience vs Timeliness and Ordering:  Ordering information and the</td><td> </td><td class="right">   Resilience vs Timeliness and Ordering:  Ordering information and the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      timing of transitions cannot be communicated in three cases: i)</td><td> </td><td class="right">      timing of transitions cannot be communicated in three cases: i)</td><td class="lineno"><br></td></tr>
      <tr id="diff0189"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      during ACK loss; ii) if something on the path strips <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">      during ACK loss; ii) if something on the path strips AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">Option;</span> or iii) if the Data Receiver is unable to support Change-</td><td> </td><td class="rblock">      <span class="insert">Options;</span> or iii) if the Data Receiver is unable to support Change-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Triggered ACKs.  Following ACK reordering, the Data Sender can</td><td> </td><td class="right">      Triggered ACKs.  Following ACK reordering, the Data Sender can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      reconstruct the order in which feedback was sent, but not until</td><td> </td><td class="right">      reconstruct the order in which feedback was sent, but not until</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      all the missing feedback has arrived.</td><td> </td><td class="right">      all the missing feedback has arrived.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Complexity:  An AccECN implementation solely involves simple counter</td><td> </td><td class="right">   Complexity:  An AccECN implementation solely involves simple counter</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      increments, some modulo arithmetic to communicate the least</td><td> </td><td class="right">      increments, some modulo arithmetic to communicate the least</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      significant bits and allow for wrap, and some heuristics for</td><td> </td><td class="right">      significant bits and allow for wrap, and some heuristics for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      safety against fields cycling due to prolonged periods of ACK</td><td> </td><td class="right">      safety against fields cycling due to prolonged periods of ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      loss.  Each host needs to maintain eight additional counters.  The</td><td> </td><td class="right">      loss.  Each host needs to maintain eight additional counters.  The</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      hosts have to apply some additional tests to detect tampering by</td><td> </td><td class="right">      hosts have to apply some additional tests to detect tampering by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      middleboxes, but in general the protocol is simple to understand,</td><td> </td><td class="right">      middleboxes, but in general the protocol is simple to understand,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      simple to implement and requires few cycles per packet to execute.</td><td> </td><td class="right">      simple to implement and requires few cycles per packet to execute.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Integrity:  AccECN is compatible with at least three approaches that</td><td> </td><td class="right">   Integrity:  AccECN is compatible with at least three approaches that</td><td class="lineno"><br></td></tr>
      <tr id="diff0190"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      can assure the integrity of ECN feedback.  If <span class="delete">the AccECN Option is</span></td><td> </td><td class="rblock">      can assure the integrity of ECN feedback.  If <span class="insert">AccECN Options are</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      stripped the resolution of the feedback is degraded, but the</td><td> </td><td class="right">      stripped the resolution of the feedback is degraded, but the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      integrity of this degraded feedback can still be assured.</td><td> </td><td class="right">      integrity of this degraded feedback can still be assured.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Backward Compatibility:  If only one endpoint supports the AccECN</td><td> </td><td class="right">   Backward Compatibility:  If only one endpoint supports the AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      scheme, it will fall-back to the most advanced ECN feedback scheme</td><td> </td><td class="right">      scheme, it will fall-back to the most advanced ECN feedback scheme</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      supported by the other end.</td><td> </td><td class="right">      supported by the other end.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0191"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Backward Compatibility:</span>  If <span class="delete">the</span> AccECN <span class="delete">Option is</span> stripped by a</td><td> </td><td class="rblock">      If AccECN <span class="insert">Options are</span> stripped by a middlebox, AccECN still</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      middlebox, AccECN still provides basic congestion feedback in the</td><td> </td><td class="rblock">      provides basic congestion feedback in the ACE field.  Further,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      ACE field.  Further, AccECN can be used to detect mangling of the</td><td> </td><td class="rblock">      AccECN can be used to detect mangling of the IP ECN field;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      IP ECN field; mangling of the TCP ECN flags; blocking of <span class="delete">ECT-</span></td><td> </td><td class="rblock">      mangling of the TCP ECN flags; blocking of <span class="insert">ECT-marked</span> segments;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      marked</span> segments; and blocking of segments carrying <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">      and blocking of segments carrying <span class="insert">an</span> AccECN Option.  It can detect</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Option.  It can detect these conditions during TCP's 3WHS so that</td><td> </td><td class="rblock">      these conditions during TCP's 3WHS so that it can fall back to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      it can fall back to operation without ECN and/or operation without</td><td> </td><td class="rblock">      operation without ECN and/or operation without AccECN <span class="insert">Options.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">the</span> AccECN <span class="delete">Option.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Forward Compatibility:  The behaviour of endpoints and middleboxes is</td><td> </td><td class="right">   Forward Compatibility:  The behaviour of endpoints and middleboxes is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      carefully defined for all reserved or currently unused codepoints</td><td> </td><td class="right">      carefully defined for all reserved or currently unused codepoints</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      in the scheme.  Then, the designers of security devices can</td><td> </td><td class="right">      in the scheme.  Then, the designers of security devices can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      understand which currently unused values might appear in future.</td><td> </td><td class="right">      understand which currently unused values might appear in future.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      So, even if they choose to treat such values as anomalous while</td><td> </td><td class="right">      So, even if they choose to treat such values as anomalous while</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      they are not widely used, any blocking will at least be under</td><td> </td><td class="right">      they are not widely used, any blocking will at least be under</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      policy control not hard-coded.  Then, if previously unused values</td><td> </td><td class="right">      policy control not hard-coded.  Then, if previously unused values</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      start to appear on the Internet (or in standards), such policies</td><td> </td><td class="right">      start to appear on the Internet (or in standards), such policies</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      could be quickly reversed.</td><td> </td><td class="right">      could be quickly reversed.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">7.  IANA Considerations</td><td> </td><td class="right">7.  IANA Considerations</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0192"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   This document reassigns <span class="delete">bit 7 of</span> the TCP header <span class="delete">flags</span> to the AccECN</td><td> </td><td class="rblock">   This document reassigns the TCP header <span class="insert">flag at bit offset 7</span> to the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   protocol.  This bit was previously called the Nonce Sum (NS) flag</td><td> </td><td class="rblock">   AccECN protocol.  This bit was previously called the Nonce Sum (NS)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   [RFC3540], but RFC 3540 has been reclassified as historic [RFC8311].</td><td> </td><td class="rblock">   flag [RFC3540], but RFC 3540 has been reclassified as historic</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The flag will now be defined as:</td><td> </td><td class="rblock">   [RFC8311].  The flag will now be defined as:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0193"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                  <span class="delete">+=====+===================+===========+</span></td><td> </td><td class="rblock">     <span class="insert">+=====+==============+===========+==============================+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                  | Bit | Name              | Reference |</td><td> </td><td class="rblock">     | Bit | Name         | Reference | <span class="insert">Assignment Notes             |</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                  <span class="delete">+=====+===================+===========+</span></td><td> </td><td class="rblock"><span class="insert">     +=====+==============+===========+==============================+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                  | 7   | AE (Accurate <span class="delete">ECN)</span> | RFC XXXX  |</td><td> </td><td class="rblock">     | 7   | AE (Accurate | RFC XXXX  | <span class="insert">Previously used as NS (Nonce |</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                  <span class="delete">+-----+-------------------+-----------+</span></td><td> </td><td class="rblock"><span class="insert">     |     | ECN)         |           | Sum) by [RFC3540], which is  |</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">     |     |              |           | now historic [RFC8311]       |</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">     +-----+--------------+-----------+------------------------------+</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                   Table 6: TCP header flag reassignment</td><td> </td><td class="right">                   Table 6: TCP header flag reassignment</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [TO BE REMOVED: IANA is requested to update the existing entry in the</td><td> </td><td class="right">   [TO BE REMOVED: IANA is requested to update the existing entry in the</td><td class="lineno"><br></td></tr>
      <tr id="diff0194"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Transmission Control Protocol (TCP)</span> Header Flags <span class="delete">registration</span></td><td> </td><td class="rblock">   <span class="insert">TCP</span> Header Flags <span class="insert">registry (https://www.iana.org/assignments/tcp-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   (https://www.iana.org/assignments/tcp-header-flags/tcp-header-</span></td><td> </td><td class="rblock"><span class="insert">   parameters/tcp-parameters.xhtml#tcp-header-flags)</span> for Bit 7 to "AE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   flags.xhtml#tcp-header-flags-1)</span> for Bit 7 to "AE (Accurate <span class="delete">ECN),</span></td><td> </td><td class="rblock">   (Accurate <span class="insert">ECN)" and to change the reference to this RFC-to-be instead</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   previously</span> used as NS (Nonce Sum) by [RFC3540], which is now <span class="delete">Historic</span></td><td> </td><td class="rblock"><span class="insert">   of RFC8311.  Also IANA is requested to change the assignment note to</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   [RFC8311]" and change the reference to this RFC-to-be instead of</span></td><td> </td><td class="rblock"><span class="insert">   "Previously</span> used as NS (Nonce Sum) by [RFC3540], which is now</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   RFC8311.]</span></td><td> </td><td class="rblock">   <span class="insert">historic [RFC8311]."]</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This document also defines two new TCP options for AccECN, assigned</td><td> </td><td class="right">   This document also defines two new TCP options for AccECN, assigned</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   values of 172 and 173 (decimal) from the TCP option space.  These</td><td> </td><td class="right">   values of 172 and 173 (decimal) from the TCP option space.  These</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   values are defined as:</td><td> </td><td class="right">   values are defined as:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +======+========+================================+===========+</td><td> </td><td class="right">      +======+========+================================+===========+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | Kind | Length | Meaning                        | Reference |</td><td> </td><td class="right">      | Kind | Length | Meaning                        | Reference |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +======+========+================================+===========+</td><td> </td><td class="right">      +======+========+================================+===========+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 172  | N      | Accurate ECN Order 0 (AccECN0) | RFC XXXX  |</td><td> </td><td class="right">      | 172  | N      | Accurate ECN Order 0 (AccECN0) | RFC XXXX  |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------+--------+--------------------------------+-----------+</td><td> </td><td class="right">      +------+--------+--------------------------------+-----------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-21" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-21"><em> page 49, line 48<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-21"><em> page 49, line 50<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   tcp-parameters/tcp-parameters.xhtml#tcp-parameters-1 ]</td><td> </td><td class="right">   tcp-parameters/tcp-parameters.xhtml#tcp-parameters-1 ]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Early experimental implementations of the two AccECN Options used</td><td> </td><td class="right">   Early experimental implementations of the two AccECN Options used</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   experimental option 254 per [RFC6994] with the 16-bit magic numbers</td><td> </td><td class="right">   experimental option 254 per [RFC6994] with the 16-bit magic numbers</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   0xACC0 and 0xACC1 respectively for Order 0 and 1, as allocated in the</td><td> </td><td class="right">   0xACC0 and 0xACC1 respectively for Order 0 and 1, as allocated in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   IANA "TCP Experimental Option Experiment Identifiers (TCP ExIDs)"</td><td> </td><td class="right">   IANA "TCP Experimental Option Experiment Identifiers (TCP ExIDs)"</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   registry.  Even earlier experimental implementations used the single</td><td> </td><td class="right">   registry.  Even earlier experimental implementations used the single</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   magic number 0xACCE (16 bits).  Uses of these experimental options</td><td> </td><td class="right">   magic number 0xACCE (16 bits).  Uses of these experimental options</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SHOULD migrate to use the new option kinds (172 &amp; 173).</td><td> </td><td class="right">   SHOULD migrate to use the new option kinds (172 &amp; 173).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0195"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">[TO BE REMOVED: IANA is requested to replace the references for all</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   three of the above experimental options (0xACC0, 0xACC1 and 0xACCE)</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   with a reference to the present RFC XXXX.]</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [TO BE REMOVED: If the early registrations, which may be temporary,</td><td> </td><td class="right">   [TO BE REMOVED: If the early registrations, which may be temporary,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   do not proceed, the three references to them in the TCP ExIDs</td><td> </td><td class="right">   do not proceed, the three references to them in the TCP ExIDs</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   registry at the following location will also need to be edited out:</td><td> </td><td class="right">   registry at the following location will also need to be edited out:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   https://www.iana.org/assignments/tcp-parameters/tcp-</td><td> </td><td class="right">   https://www.iana.org/assignments/tcp-parameters/tcp-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   parameters.xhtml#tcp-exids ]</td><td> </td><td class="right">   parameters.xhtml#tcp-exids ]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">8.  Security Considerations</td><td> </td><td class="right">8.  Security Considerations</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0196"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If ever the supplementary part of AccECN based on the new AccECN TCP</td><td> </td><td class="rblock">   If ever the supplementary part of AccECN based on <span class="insert">one of</span> the new</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Option</span> is unusable (due for example to middlebox interference) the</td><td> </td><td class="rblock">   AccECN TCP <span class="insert">Options</span> is unusable (due for example to middlebox</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   essential part of AccECN's congestion feedback offers only limited</td><td> </td><td class="rblock">   interference) the essential part of AccECN's congestion feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   resilience to long runs of ACK loss (see Section 3.2.2.5).  These</td><td> </td><td class="rblock">   offers only limited resilience to long runs of ACK loss (see</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   problems are unlikely to be due to malicious intervention (because if</td><td> </td><td class="rblock">   Section 3.2.2.5).  These problems are unlikely to be due to malicious</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   an attacker could strip a TCP option or discard a long run of ACKs it</td><td> </td><td class="rblock">   intervention (because if an attacker could strip a TCP option or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   could wreak other arbitrary havoc).  However, it would be of concern</td><td> </td><td class="rblock">   discard a long run of ACKs it could wreak other arbitrary havoc).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   if AccECN's resilience could be indirectly compromised during a</td><td> </td><td class="rblock">   However, it would be of concern if AccECN's resilience could be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flooding attack.  AccECN is still considered safe though, because if</td><td> </td><td class="rblock">   indirectly compromised during a flooding attack.  AccECN is still</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">the option is</span> not present, the AccECN Data Sender is then required to</td><td> </td><td class="rblock">   considered safe though, because if <span class="insert">AccECN Options are</span> not present,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   switch to more conservative assumptions about wrap of congestion</td><td> </td><td class="rblock">   the AccECN Data Sender is then required to switch to more</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   indication counters (see Section 3.2.2.5 and Appendix A.2).</td><td> </td><td class="rblock">   conservative assumptions about wrap of congestion indication counters</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   (see Section 3.2.2.5 and Appendix A.2).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0197"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section 5.1 describes how a TCP <span class="delete">s</span>erver can negotiate AccECN and use</td><td> </td><td class="rblock">   Section 5.1 describes how a TCP <span class="insert">S</span>erver can negotiate AccECN and use</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the SYN cookie method for mitigating SYN flooding attacks.</td><td> </td><td class="right">   the SYN cookie method for mitigating SYN flooding attacks.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   There is concern that ECN feedback could be altered or suppressed,</td><td> </td><td class="right">   There is concern that ECN feedback could be altered or suppressed,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   particularly because a misbehaving Data Receiver could increase its</td><td> </td><td class="right">   particularly because a misbehaving Data Receiver could increase its</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   own throughput at the expense of others.  AccECN is compatible with</td><td> </td><td class="right">   own throughput at the expense of others.  AccECN is compatible with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the three schemes known to assure the integrity of ECN feedback (see</td><td> </td><td class="right">   the three schemes known to assure the integrity of ECN feedback (see</td><td class="lineno"><br></td></tr>
      <tr id="diff0198"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section 5.3 for details).  If <span class="delete">the AccECN Option is</span> stripped by an</td><td> </td><td class="rblock">   Section 5.3 for details).  If <span class="insert">AccECN Options are</span> stripped by an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   incorrectly implemented middlebox, the resolution of the feedback</td><td> </td><td class="right">   incorrectly implemented middlebox, the resolution of the feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   will be degraded, but the integrity of this degraded information can</td><td> </td><td class="right">   will be degraded, but the integrity of this degraded information can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   still be assured.  Assuring that Data Senders respond appropriately</td><td> </td><td class="right">   still be assured.  Assuring that Data Senders respond appropriately</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to ECN feedback is possible, but the scope of the present document is</td><td> </td><td class="right">   to ECN feedback is possible, but the scope of the present document is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   confined to the feedback protocol, and excludes the response to this</td><td> </td><td class="right">   confined to the feedback protocol, and excludes the response to this</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feedback.</td><td> </td><td class="right">   feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   In Section 3.2.3 a Data Sender is allowed to ignore an unrecognized</td><td> </td><td class="right">   In Section 3.2.3 a Data Sender is allowed to ignore an unrecognized</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP AccECN Option length and read as many whole 3-octet fields from</td><td> </td><td class="right">   TCP AccECN Option length and read as many whole 3-octet fields from</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it as possible up to a maximum of 3, treating the remainder as</td><td> </td><td class="right">   it as possible up to a maximum of 3, treating the remainder as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   padding.  This opens up a potential covert channel of up to 29B (40 -</td><td> </td><td class="right">   padding.  This opens up a potential covert channel of up to 29B (40 -</td><td class="lineno"><br></td></tr>
      <tr id="diff0199"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   (2+3*3))B.  However, it is really an overt channel (not hidden) and</td><td> </td><td class="rblock">   (2+3*3))<span class="insert"> </span>B.  However, it is really an overt channel (not hidden) and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it is no different to the use of unknown TCP options with unknown</td><td> </td><td class="right">   it is no different to the use of unknown TCP options with unknown</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   option lengths in general.  Therefore, where this is of concern, it</td><td> </td><td class="right">   option lengths in general.  Therefore, where this is of concern, it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   can already be adequately mitigated by regular TCP normalizer</td><td> </td><td class="right">   can already be adequately mitigated by regular TCP normalizer</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   technology (see Section 3.3.2).</td><td> </td><td class="right">   technology (see Section 3.3.2).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The AccECN protocol is not believed to introduce any new privacy</td><td> </td><td class="right">   The AccECN protocol is not believed to introduce any new privacy</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   concerns, because it merely counts and feeds back signals at the</td><td> </td><td class="right">   concerns, because it merely counts and feeds back signals at the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   transport layer that had already been visible at the IP layer.  A</td><td> </td><td class="right">   transport layer that had already been visible at the IP layer.  A</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   covert channel can be used to compromise privacy.  However, as</td><td> </td><td class="right">   covert channel can be used to compromise privacy.  However, as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   explained above, undefined TCP options in general open up such</td><td> </td><td class="right">   explained above, undefined TCP options in general open up such</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   channels and common techniques are available to close them off.</td><td> </td><td class="right">   channels and common techniques are available to close them off.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   There is a potential concern that a Data Receiver could deliberately</td><td> </td><td class="right">   There is a potential concern that a Data Receiver could deliberately</td><td class="lineno"><br></td></tr>
      <tr id="diff0200"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   omit <span class="delete">the AccECN Option pretending that it</span> had been stripped by a</td><td> </td><td class="rblock">   omit <span class="insert">AccECN Options pretending that they</span> had been stripped by a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   middlebox.  No known way can yet be contrived for a receiver to take</td><td> </td><td class="right">   middlebox.  No known way can yet be contrived for a receiver to take</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   advantage of this behaviour, which seems to always degrade its own</td><td> </td><td class="right">   advantage of this behaviour, which seems to always degrade its own</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   performance.  However, the concern is mentioned here for</td><td> </td><td class="right">   performance.  However, the concern is mentioned here for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   completeness.</td><td> </td><td class="right">   completeness.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0201"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">9.  <span class="delete">Acknowledgements</span></td><td> </td><td class="rblock">9.  References</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   We want to thank Koen De Schepper, Praveen Balasubramanian, Michael</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Welzl, Gorry Fairhurst, David Black, Spencer Dawkins, Michael Scharf,</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Michael Tuexen, Yuchung Cheng, Kenjiro Cho, Olivier Tilmans, Ilpo</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Järvinen, Neal Cardwell, Yoshifumi Nishida, Martin Duke, Jonathan</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Morton and Vidhi Goel for their input and discussion.  The idea of</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   using the three ECN-related TCP flags as one field for more accurate</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   TCP-ECN feedback was first introduced in the re-ECN protocol that was</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   the ancestor of ConEx.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Bob Briscoe was part-funded by the Comcast Innovation Fund, the</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   European Community under its Seventh Framework Programme through the</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Reducing Internet Transport Latency (RITE) project (ICT-317700) and</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   through the Trilogy 2 project (ICT-317756), and the Research Council</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   of Norway through the TimeIn project.  The views expressed here are</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   solely those of the authors.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Mirja Kuehlewind was partly supported by the European Commission</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   under Horizon 2020 grant agreement no. 688421 Measurement and</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Architecture for a Middleboxed Internet (MAMI), and by the Swiss</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   State Secretariat for Education, Research, and Innovation under</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   contract no.  15.0268.  This support does not imply endorsement.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">10.  Comments Solicited</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Comments and questions are encouraged and very welcome.  They can be</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   addressed to the IETF TCP maintenance and minor modifications working</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   group mailing list &lt;tcpm@ietf.org&gt;, and/or to the authors.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete"></span><br></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">11.</span>  References</td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0202"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">11</span>.1.  Normative References</td><td> </td><td class="rblock"><span class="insert">9</span>.1.  Normative References</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td> </td><td class="right">   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              Requirement Levels", BCP 14, RFC 2119,</td><td> </td><td class="right">              Requirement Levels", BCP 14, RFC 2119,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              DOI 10.17487/RFC2119, March 1997,</td><td> </td><td class="right">              DOI 10.17487/RFC2119, March 1997,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc2119&gt;.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC3168]  Ramakrishnan, K., Floyd, S., and D. Black, "The Addition</td><td> </td><td class="right">   [RFC3168]  Ramakrishnan, K., Floyd, S., and D. Black, "The Addition</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              of Explicit Congestion Notification (ECN) to IP",</td><td> </td><td class="right">              of Explicit Congestion Notification (ECN) to IP",</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              RFC 3168, DOI 10.17487/RFC3168, September 2001,</td><td> </td><td class="right">              RFC 3168, DOI 10.17487/RFC3168, September 2001,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc3168&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc3168&gt;.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-22" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-22"><em> page 52, line 22<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-22"><em> page 51, line 45<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc5681&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc5681&gt;.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td> </td><td class="right">   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,</td><td> </td><td class="right">              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td> </td><td class="right">              May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC9293]  Eddy, W., Ed., "Transmission Control Protocol (TCP)",</td><td> </td><td class="right">   [RFC9293]  Eddy, W., Ed., "Transmission Control Protocol (TCP)",</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              STD 7, RFC 9293, DOI 10.17487/RFC9293, August 2022,</td><td> </td><td class="right">              STD 7, RFC 9293, DOI 10.17487/RFC9293, August 2022,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc9293&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc9293&gt;.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0203"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">11</span>.2.  Informative References</td><td> </td><td class="rblock"><span class="insert">9</span>.2.  Informative References</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [I-D.ietf-tcpm-generalized-ecn]</td><td> </td><td class="right">   [I-D.ietf-tcpm-generalized-ecn]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              Bagnulo, M. and B. Briscoe, "ECN++: Adding Explicit</td><td> </td><td class="right">              Bagnulo, M. and B. Briscoe, "ECN++: Adding Explicit</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              Congestion Notification (ECN) to TCP Control Packets",</td><td> </td><td class="right">              Congestion Notification (ECN) to TCP Control Packets",</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              Work in Progress, Internet-Draft, draft-ietf-tcpm-</td><td> </td><td class="right">              Work in Progress, Internet-Draft, draft-ietf-tcpm-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              generalized-ecn-11, 21 February 2023,</td><td> </td><td class="right">              generalized-ecn-11, 21 February 2023,</td><td class="lineno"><br></td></tr>
      <tr id="diff0204"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">              <span class="delete">&lt;https://datatracker.ietf.org/api/v1/doc/document/draft-</span></td><td> </td><td class="rblock">              <span class="insert">&lt;https://datatracker.ietf.org/doc/html/draft-ietf-tcpm-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">              ietf-tcpm-generalized-ecn/&gt;.</span></td><td> </td><td class="rblock"><span class="insert">              generalized-ecn-11&gt;.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [Mandalari18]</td><td> </td><td class="right">   [Mandalari18]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              Mandalari, A., Lutu, A., Briscoe, B., Bagnulo, M., and Ö.</td><td> </td><td class="right">              Mandalari, A., Lutu, A., Briscoe, B., Bagnulo, M., and Ö.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              Alay, "Measuring ECN++: Good News for ++, Bad News for ECN</td><td> </td><td class="right">              Alay, "Measuring ECN++: Good News for ++, Bad News for ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              over Mobile", IEEE Communications Magazine , March 2018,</td><td> </td><td class="right">              over Mobile", IEEE Communications Magazine , March 2018,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              &lt;http://www.it.uc3m.es/amandala/</td><td> </td><td class="right">              &lt;http://www.it.uc3m.es/amandala/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              ecn++/ecn_commag_2018.html&gt;.</td><td> </td><td class="right">              ecn++/ecn_commag_2018.html&gt;.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC2018]  Mathis, M., Mahdavi, J., Floyd, S., and A. Romanow, "TCP</td><td> </td><td class="right">   [RFC2018]  Mathis, M., Mahdavi, J., Floyd, S., and A. Romanow, "TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">              Selective Acknowledgment Options", RFC 2018,</td><td> </td><td class="right">              Selective Acknowledgment Options", RFC 2018,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-23" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-23"><em> page 54, line 40<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-23"><em> page 54, line 21<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Appendix A.  Example Algorithms</td><td> </td><td class="right">Appendix A.  Example Algorithms</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This appendix is informative, not normative.  It gives example</td><td> </td><td class="right">   This appendix is informative, not normative.  It gives example</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   algorithms that would satisfy the normative requirements of the</td><td> </td><td class="right">   algorithms that would satisfy the normative requirements of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN protocol.  However, implementers are free to choose other ways</td><td> </td><td class="right">   AccECN protocol.  However, implementers are free to choose other ways</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to implement the requirements.</td><td> </td><td class="right">   to implement the requirements.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">A.1.  Example Algorithm to Encode/Decode the AccECN Option</td><td> </td><td class="right">A.1.  Example Algorithm to Encode/Decode the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The example algorithms below show how a Data Receiver in AccECN mode</td><td> </td><td class="right">   The example algorithms below show how a Data Receiver in AccECN mode</td><td class="lineno"><br></td></tr>
      <tr id="diff0205"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   could encode its CE byte counter r.ceb into the ECEB field within <span class="delete">the</span></td><td> </td><td class="rblock">   could encode its CE byte counter r.ceb into the ECEB field within <span class="insert">an</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN TCP Option, and how a Data Sender in AccECN mode could decode</td><td> </td><td class="right">   AccECN TCP Option, and how a Data Sender in AccECN mode could decode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the ECEB field into its byte counter s.ceb.  The other counters for</td><td> </td><td class="right">   the ECEB field into its byte counter s.ceb.  The other counters for</td><td class="lineno"><br></td></tr>
      <tr id="diff0206"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   bytes marked ECT(0) and ECT(1) in <span class="delete">the</span> AccECN Option would be</td><td> </td><td class="rblock">   bytes marked ECT(0) and ECT(1) in <span class="insert">an</span> AccECN Option would be similarly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   similarly encoded and decoded.</td><td> </td><td class="rblock">   encoded and decoded.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   It is assumed that each local byte counter is an unsigned integer</td><td> </td><td class="right">   It is assumed that each local byte counter is an unsigned integer</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   greater than 24b (probably 32b), and that the following constant has</td><td> </td><td class="right">   greater than 24b (probably 32b), and that the following constant has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   been assigned:</td><td> </td><td class="right">   been assigned:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      DIVOPT = 2^24</td><td> </td><td class="right">      DIVOPT = 2^24</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Every time a CE marked data segment arrives, the Data Receiver</td><td> </td><td class="right">   Every time a CE marked data segment arrives, the Data Receiver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   increments its local value of r.ceb by the size of the TCP Data.</td><td> </td><td class="right">   increments its local value of r.ceb by the size of the TCP Data.</td><td class="lineno"><br></td></tr>
      <tr id="diff0207"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Whenever it sends an ACK with <span class="delete">the</span> AccECN Option, the value it writes</td><td> </td><td class="rblock">   Whenever it sends an ACK with <span class="insert">an</span> AccECN Option, the value it writes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   into the ECEB field is</td><td> </td><td class="right">   into the ECEB field is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ECEB = r.ceb % DIVOPT</td><td> </td><td class="right">      ECEB = r.ceb % DIVOPT</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   where '%' is the remainder operator.</td><td> </td><td class="right">   where '%' is the remainder operator.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   On the arrival of an AccECN Option, the Data Sender first makes sure</td><td> </td><td class="right">   On the arrival of an AccECN Option, the Data Sender first makes sure</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the ACK has not been superseded in order to avoid winding the s.ceb</td><td> </td><td class="right">   the ACK has not been superseded in order to avoid winding the s.ceb</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counter backwards.  It uses the TCP acknowledgement number and any</td><td> </td><td class="right">   counter backwards.  It uses the TCP acknowledgement number and any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SACK options to calculate newlyAckedB, the amount of new data that</td><td> </td><td class="right">   SACK options to calculate newlyAckedB, the amount of new data that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-24" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-24"><em> page 55, line 38<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-24"><em> page 55, line 17<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      if ((newlyAckedB &gt; 0) || (newlyAckedT &gt; 0)) {</td><td> </td><td class="right">      if ((newlyAckedB &gt; 0) || (newlyAckedT &gt; 0)) {</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          d.ceb = (ECEB + DIVOPT - (s.ceb % DIVOPT)) % DIVOPT</td><td> </td><td class="right">          d.ceb = (ECEB + DIVOPT - (s.ceb % DIVOPT)) % DIVOPT</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          s.ceb += d.ceb</td><td> </td><td class="right">          s.ceb += d.ceb</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      }</td><td> </td><td class="right">      }</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   For example, if s.ceb is 33,554,433 and ECEB is 1461 (both decimal),</td><td> </td><td class="right">   For example, if s.ceb is 33,554,433 and ECEB is 1461 (both decimal),</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   then</td><td> </td><td class="right">   then</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      s.ceb % DIVOPT = 1</td><td> </td><td class="right">      s.ceb % DIVOPT = 1</td><td class="lineno"><br></td></tr>
      <tr id="diff0208"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">            d.ceb = (1461 + 2^24 - 1) % 2^24</td><td> </td><td class="rblock">      d.ceb = (1461 + 2^24 - 1) % 2^24</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                  = 1460</td><td> </td><td class="rblock">            = 1460</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">            s.ceb = 33,554,433 + 1460</td><td> </td><td class="rblock">      s.ceb = 33,554,433 + 1460</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                  = 33,555,893</td><td> </td><td class="rblock">            = 33,555,893</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   In practice an implementation might use heuristics to guess the</td><td> </td><td class="right">   In practice an implementation might use heuristics to guess the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feedback in missing ACKs, then when it subsequently receives feedback</td><td> </td><td class="right">   feedback in missing ACKs, then when it subsequently receives feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it might find that it needs to correct its earlier heuristics as part</td><td> </td><td class="right">   it might find that it needs to correct its earlier heuristics as part</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of the decoding process.  The above decoding process does not include</td><td> </td><td class="right">   of the decoding process.  The above decoding process does not include</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   any such heuristics.</td><td> </td><td class="right">   any such heuristics.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">A.2.  Example Algorithm for Safety Against Long Sequences of ACK Loss</td><td> </td><td class="right">A.2.  Example Algorithm for Safety Against Long Sequences of ACK Loss</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The example algorithms below show how a Data Receiver in AccECN mode</td><td> </td><td class="right">   The example algorithms below show how a Data Receiver in AccECN mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   could encode its CE packet counter r.cep into the ACE field, and how</td><td> </td><td class="right">   could encode its CE packet counter r.cep into the ACE field, and how</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the Data Sender in AccECN mode could decode the ACE field into its</td><td> </td><td class="right">   the Data Sender in AccECN mode could decode the ACE field into its</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   s.cep counter.  The Data Sender's algorithm includes code to</td><td> </td><td class="right">   s.cep counter.  The Data Sender's algorithm includes code to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   heuristically detect a long enough unbroken string of ACK losses that</td><td> </td><td class="right">   heuristically detect a long enough unbroken string of ACK losses that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   could have concealed a cycle of the congestion counter in the ACE</td><td> </td><td class="right">   could have concealed a cycle of the congestion counter in the ACE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field of the next ACK to arrive.</td><td> </td><td class="right">   field of the next ACK to arrive.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Two variants of the algorithm are given: i) a more conservative</td><td> </td><td class="right">   Two variants of the algorithm are given: i) a more conservative</td><td class="lineno"><br></td></tr>
      <tr id="diff0209"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   variant for a Data Sender to use if it detects that <span class="delete">the</span> AccECN <span class="delete">Option</span></td><td> </td><td class="rblock">   variant for a Data Sender to use if it detects that AccECN <span class="insert">Options</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   is</span> not available (see Section 3.2.2.5 and Section 3.2.3.2); and ii) a</td><td> </td><td class="rblock"><span class="insert">   are</span> not available (see Section 3.2.2.5 and Section 3.2.3.2); and ii)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   less conservative variant that is feasible when complementary</td><td> </td><td class="rblock">   a less conservative variant that is feasible when complementary</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   information is available from <span class="delete">the</span> AccECN <span class="delete">Option.</span></td><td> </td><td class="rblock">   information is available from AccECN <span class="insert">Options.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">A.2.1.  Safety Algorithm without the AccECN Option</td><td> </td><td class="right">A.2.1.  Safety Algorithm without the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   It is assumed that each local packet counter is a sufficiently sized</td><td> </td><td class="right">   It is assumed that each local packet counter is a sufficiently sized</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   unsigned integer (probably 32b) and that the following constant has</td><td> </td><td class="right">   unsigned integer (probably 32b) and that the following constant has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   been assigned:</td><td> </td><td class="right">   been assigned:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      DIVACE = 2^3</td><td> </td><td class="right">      DIVACE = 2^3</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Every time an Acceptable CE marked packet arrives (Section 3.2.2.2),</td><td> </td><td class="right">   Every time an Acceptable CE marked packet arrives (Section 3.2.2.2),</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-25" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-25"><em> page 58, line 28<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-25"><em> page 58, line 7<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.2.5 says "the Data Sender MAY attempt to neutralize the</td><td> </td><td class="right">   Section 3.2.2.5 says "the Data Sender MAY attempt to neutralize the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   effect of any action it took based on a conservative assumption that</td><td> </td><td class="right">   effect of any action it took based on a conservative assumption that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it later found to be incorrect".  To do this, the Data Sender would</td><td> </td><td class="right">   it later found to be incorrect".  To do this, the Data Sender would</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   have to store the values of all the relevant variables whenever it</td><td> </td><td class="right">   have to store the values of all the relevant variables whenever it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   made assumptions, so that it could re-evaluate them later.  Given</td><td> </td><td class="right">   made assumptions, so that it could re-evaluate them later.  Given</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this could become complex and it is not required, we do not attempt</td><td> </td><td class="right">   this could become complex and it is not required, we do not attempt</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to provide an example of how to do this.</td><td> </td><td class="right">   to provide an example of how to do this.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">A.2.2.  Safety Algorithm with the AccECN Option</td><td> </td><td class="right">A.2.2.  Safety Algorithm with the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0210"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   When <span class="delete">the AccECN Option is</span> available on the ACKs before and after the</td><td> </td><td class="rblock">   When <span class="insert">AccECN Options are</span> available on the ACKs before and after the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   possible sequence of ACK losses, if the Data Sender only needs CE-</td><td> </td><td class="right">   possible sequence of ACK losses, if the Data Sender only needs CE-</td><td class="lineno"><br></td></tr>
      <tr id="diff0211"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   marked bytes, it will have sufficient information in <span class="delete">the</span> AccECN</td><td> </td><td class="rblock">   marked bytes, it will have sufficient information in AccECN <span class="insert">Options</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Option</span> without needing to process the ACE field.  If for some reason</td><td> </td><td class="rblock">   without needing to process the ACE field.  If for some reason it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   it needs CE-marked packets, if dSafer.cep is different from d.cep, it</td><td> </td><td class="rblock">   needs CE-marked packets, if dSafer.cep is different from d.cep, it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   can determine whether d.cep is likely to be a safe enough estimate by</td><td> </td><td class="right">   can determine whether d.cep is likely to be a safe enough estimate by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   checking whether the average marked segment size (s = d.ceb/d.cep) is</td><td> </td><td class="right">   checking whether the average marked segment size (s = d.ceb/d.cep) is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   less than the MSS (where d.ceb is the amount of newly CE-marked bytes</td><td> </td><td class="right">   less than the MSS (where d.ceb is the amount of newly CE-marked bytes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   - see Appendix A.1).  Specifically, it could use the following</td><td> </td><td class="right">   - see Appendix A.1).  Specifically, it could use the following</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   algorithm:</td><td> </td><td class="right">   algorithm:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      SAFETY_FACTOR = 2</td><td> </td><td class="right">      SAFETY_FACTOR = 2</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      if (dSafer.cep &gt; d.cep) {</td><td> </td><td class="right">      if (dSafer.cep &gt; d.cep) {</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          if (d.ceb &lt;= MSS * d.cep) {  % Same as (s &lt;= MSS), but no DBZ</td><td> </td><td class="right">          if (d.ceb &lt;= MSS * d.cep) {  % Same as (s &lt;= MSS), but no DBZ</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">             sSafer = d.ceb/dSafer.cep</td><td> </td><td class="right">             sSafer = d.ceb/dSafer.cep</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-26" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-26"><em> page 60, line 7<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-26"><em> page 59, line 29<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Therefore d.cep is safe enough, because the average data segment</td><td> </td><td class="right">      Therefore d.cep is safe enough, because the average data segment</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      size is more likely to have been just less than one MSS, rather</td><td> </td><td class="right">      size is more likely to have been just less than one MSS, rather</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      than below MSS/2.</td><td> </td><td class="right">      than below MSS/2.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If pure ACKs were allowed to be ECN-capable, missing ACKs would be</td><td> </td><td class="right">   If pure ACKs were allowed to be ECN-capable, missing ACKs would be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   far less likely.  However, because [RFC3168] currently precludes</td><td> </td><td class="right">   far less likely.  However, because [RFC3168] currently precludes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this, the above algorithm assumes that pure ACKs are not ECN-capable.</td><td> </td><td class="right">   this, the above algorithm assumes that pure ACKs are not ECN-capable.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">A.3.  Example Algorithm to Estimate Marked Bytes from Marked Packets</td><td> </td><td class="right">A.3.  Example Algorithm to Estimate Marked Bytes from Marked Packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0212"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If <span class="delete">the</span> AccECN <span class="delete">Option is</span> not available, the Data Sender can only</td><td> </td><td class="rblock">   If AccECN <span class="insert">Options are</span> not available, the Data Sender can only decode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   decode CE-marking from the ACE field in packets.  Every time an ACK</td><td> </td><td class="rblock">   CE-marking from the ACE field in packets.  Every time an ACK arrives,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   arrives, to convert this into an estimate of CE-marked bytes, it</td><td> </td><td class="rblock">   to convert this into an estimate of CE-marked bytes, it needs an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   needs an average of the segment size, s_ave.  Then it can add or</td><td> </td><td class="rblock">   average of the segment size, s_ave.  Then it can add or subtract</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   subtract s_ave from the value of d.ceb as the value of d.cep</td><td> </td><td class="rblock">   s_ave from the value of d.ceb as the value of d.cep increments or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   increments or decrements.  Some possible ways to calculate s_ave are</td><td> </td><td class="rblock">   decrements.  Some possible ways to calculate s_ave are outlined</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   outlined below.  The precise details will depend on why an estimate</td><td> </td><td class="rblock">   below.  The precise details will depend on why an estimate of marked</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   of marked bytes is needed.</td><td> </td><td class="rblock">   bytes is needed.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The implementation could keep a record of the byte numbers of all the</td><td> </td><td class="right">   The implementation could keep a record of the byte numbers of all the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   boundaries between packets in flight (including control packets), and</td><td> </td><td class="right">   boundaries between packets in flight (including control packets), and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   recalculate s_ave on every ACK.  However it would be simpler to</td><td> </td><td class="right">   recalculate s_ave on every ACK.  However it would be simpler to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   merely maintain a counter packets_in_flight for the number of packets</td><td> </td><td class="right">   merely maintain a counter packets_in_flight for the number of packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in flight (including control packets), which is reset once per RTT.</td><td> </td><td class="right">   in flight (including control packets), which is reset once per RTT.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Either way, it would estimate s_ave as:</td><td> </td><td class="right">   Either way, it would estimate s_ave as:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      s_ave ~= flightsize / packets_in_flight,</td><td> </td><td class="right">      s_ave ~= flightsize / packets_in_flight,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   where flightsize is the variable that TCP already maintains for the</td><td> </td><td class="right">   where flightsize is the variable that TCP already maintains for the</td><td class="lineno"><br></td></tr>
      <tr id="diff0213"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   number of bytes in <span class="delete">flight.</span>  To avoid floating point arithmetic, it</td><td> </td><td class="rblock">   number of bytes in <span class="insert">flight and '~=' means 'approximately equal to'.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   could right-bit-shift by lg(packets_in_flight), where lg() means log</td><td> </td><td class="rblock">   To avoid floating point arithmetic, it could right-bit-shift by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   base 2.</td><td> </td><td class="rblock">   lg(packets_in_flight), where lg() means log base 2.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   An alternative would be to maintain an exponentially weighted moving</td><td> </td><td class="right">   An alternative would be to maintain an exponentially weighted moving</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   average (EWMA) of the segment size:</td><td> </td><td class="right">   average (EWMA) of the segment size:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      s_ave = a * s + (1-a) * s_ave,</td><td> </td><td class="right">      s_ave = a * s + (1-a) * s_ave,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   where a is the decay constant for the EWMA.  However, then it is</td><td> </td><td class="right">   where a is the decay constant for the EWMA.  However, then it is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   necessary to choose a good value for this constant, which ought to</td><td> </td><td class="right">   necessary to choose a good value for this constant, which ought to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   depend on the number of packets in flight.  Also the decay constant</td><td> </td><td class="right">   depend on the number of packets in flight.  Also the decay constant</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   needs to be power of two to avoid floating point arithmetic.</td><td> </td><td class="right">   needs to be power of two to avoid floating point arithmetic.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-27" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-27"><em> page 61, line 25<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-27"><em> page 60, line 49<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">B.1.  Three TCP Header Flags in the SYN-SYN/ACK Handshake</td><td> </td><td class="right">B.1.  Three TCP Header Flags in the SYN-SYN/ACK Handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN uses a rather unorthodox approach to negotiate the highest</td><td> </td><td class="right">   AccECN uses a rather unorthodox approach to negotiate the highest</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   version TCP ECN feedback scheme that both ends support, as justified</td><td> </td><td class="right">   version TCP ECN feedback scheme that both ends support, as justified</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   below.  It follows from the original TCP ECN capability negotiation</td><td> </td><td class="right">   below.  It follows from the original TCP ECN capability negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC3168], in which the client set the 2 least significant of the</td><td> </td><td class="right">   [RFC3168], in which the client set the 2 least significant of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   original reserved flags in the TCP header, and fell back to no ECN</td><td> </td><td class="right">   original reserved flags in the TCP header, and fell back to no ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   support if the server responded with the 2 flags cleared, which had</td><td> </td><td class="right">   support if the server responded with the 2 flags cleared, which had</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   previously been the default.</td><td> </td><td class="right">   previously been the default.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0214"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN <span class="delete">originally</span> used header flags rather than a TCP option because it</td><td> </td><td class="rblock">   <span class="insert">Classic</span> ECN used header flags rather than a TCP option because it was</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   was considered more efficient to use a header flag for 1 bit of</td><td> </td><td class="rblock">   considered more efficient to use a header flag for 1 bit of feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   feedback per ACK, and this bit could be overloaded to indicate</td><td> </td><td class="rblock">   per ACK, and this bit could be overloaded to indicate support for ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   support for ECN during the handshake.  During the development of ECN,</td><td> </td><td class="rblock">   during the handshake.  During the development of ECN, 1 bit crept up</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   1 bit crept up to 2, in order to deliver the feedback reliably and to</td><td> </td><td class="rblock">   to 2, in order to deliver the feedback reliably and to work round</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   work round some broken hosts that reflected the reserved flags during</td><td> </td><td class="rblock">   some broken hosts that reflected the reserved flags during the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the handshake.</td><td> </td><td class="rblock">   handshake.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   In order to be backward compatible with RFC 3168, AccECN continues</td><td> </td><td class="right">   In order to be backward compatible with RFC 3168, AccECN continues</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this approach, using the 3rd least significant TCP header flag that</td><td> </td><td class="right">   this approach, using the 3rd least significant TCP header flag that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   had previously been allocated for the ECN nonce (now historic).</td><td> </td><td class="right">   had previously been allocated for the ECN nonce (now historic).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Then, whatever form of server an AccECN client encounters, the</td><td> </td><td class="right">   Then, whatever form of server an AccECN client encounters, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection can fall back to the highest version of feedback protocol</td><td> </td><td class="right">   connection can fall back to the highest version of feedback protocol</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that both ends support, as explained in Section 3.1.</td><td> </td><td class="right">   that both ends support, as explained in Section 3.1.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0215"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If AccECN had used the more orthodox approach of a TCP option, it</td><td> </td><td class="rblock">   If AccECN <span class="insert">capability negotiation</span> had used the more orthodox approach</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   would still have had to set the two ECN flags in the main TCP header,</td><td> </td><td class="rblock">   of a TCP option, it would still have had to set the two ECN flags in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in order to be able to fall back to Classic RFC 3168 ECN, or to</td><td> </td><td class="rblock">   the main TCP header, in order to be able to fall back to Classic RFC</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   disable ECN support, without another round of negotiation.  Then</td><td> </td><td class="rblock">   3168 ECN, or to disable ECN support, without another round of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN would also have had to handle all the different ways that</td><td> </td><td class="rblock">   negotiation.  Then AccECN would also have had to handle all the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   servers currently respond to settings of the ECN flags in the main</td><td> </td><td class="rblock">   different ways that servers currently respond to settings of the ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   TCP header, including all the conflicting cases where a server might</td><td> </td><td class="rblock">   flags in the main TCP header, including all the conflicting cases</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   have said it supported one approach in the flags and another approach</td><td> </td><td class="rblock">   where a server might have said it supported one approach in the flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in <span class="delete">the</span> new TCP option.  And AccECN would have had to deal with all</td><td> </td><td class="rblock">   and another approach in <span class="insert">a</span> new TCP option.  And AccECN would have had</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the additional possibilities where a middlebox might have mangled the</td><td> </td><td class="rblock">   to deal with all the additional possibilities where a middlebox might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN flags, or removed <span class="delete">the</span> TCP <span class="delete">option.</span>  Thus, usage of the 3rd</td><td> </td><td class="rblock">   have mangled the ECN flags, or removed TCP <span class="insert">options.</span>  Thus, usage of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   reserved TCP header flag simplified the protocol.</td><td> </td><td class="rblock">   the 3rd reserved TCP header flag simplified the protocol.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The third flag was used in a way that could be distinguished from the</td><td> </td><td class="right">   The third flag was used in a way that could be distinguished from the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN nonce, in case any nonce deployment was encountered.  Previous</td><td> </td><td class="right">   ECN nonce, in case any nonce deployment was encountered.  Previous</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   usage of this flag for the ECN nonce was integrated into the original</td><td> </td><td class="right">   usage of this flag for the ECN nonce was integrated into the original</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN negotiation.  This further justified the 3rd flag's use for</td><td> </td><td class="right">   ECN negotiation.  This further justified the 3rd flag's use for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN, because a non-ECN usage of this flag would have had to use it</td><td> </td><td class="right">   AccECN, because a non-ECN usage of this flag would have had to use it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   as a separate single bit, rather than in combination with the other 2</td><td> </td><td class="right">   as a separate single bit, rather than in combination with the other 2</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN flags.</td><td> </td><td class="right">   ECN flags.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Indeed, having overloaded the original uses of these three flags for</td><td> </td><td class="right">   Indeed, having overloaded the original uses of these three flags for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-28" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-28"><em> page 62, line 25<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-28"><em> page 61, line 48<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counter.</td><td> </td><td class="right">   counter.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">B.2.  Four Codepoints in the SYN/ACK</td><td> </td><td class="right">B.2.  Four Codepoints in the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Of the 8 possible codepoints that the 3 TCP header flags can indicate</td><td> </td><td class="right">   Of the 8 possible codepoints that the 3 TCP header flags can indicate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   on the SYN/ACK, 4 already indicated earlier (or broken) versions of</td><td> </td><td class="right">   on the SYN/ACK, 4 already indicated earlier (or broken) versions of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN support.  In the early design of AccECN, an AccECN server could</td><td> </td><td class="right">   ECN support.  In the early design of AccECN, an AccECN server could</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   use only 2 of the 4 remaining codepoints.  They both indicated AccECN</td><td> </td><td class="right">   use only 2 of the 4 remaining codepoints.  They both indicated AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   support, but one fed back that the SYN had arrived marked as CE.</td><td> </td><td class="right">   support, but one fed back that the SYN had arrived marked as CE.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Even though ECN support on a SYN is not yet on the standards track,</td><td> </td><td class="right">   Even though ECN support on a SYN is not yet on the standards track,</td><td class="lineno"><br></td></tr>
      <tr id="diff0216"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the idea is for either end to act as a <span class="delete">dumb</span> reflector, so that future</td><td> </td><td class="rblock">   the idea is for either end to act as a <span class="insert">mechanistic</span> reflector, so that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   capabilities can be unilaterally deployed without requiring 2-ended</td><td> </td><td class="rblock">   future capabilities can be unilaterally deployed without requiring</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   deployment (justified in Section 2.5).</td><td> </td><td class="rblock">   2-ended deployment (justified in Section 2.5).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   During traversal testing it was discovered that the ECN field in the</td><td> </td><td class="right">   During traversal testing it was discovered that the ECN field in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN was mangled on a non-negligible proportion of paths.  Therefore</td><td> </td><td class="right">   SYN was mangled on a non-negligible proportion of paths.  Therefore</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it was necessary to allow the SYN/ACK to feed all four IP/ECN</td><td> </td><td class="right">   it was necessary to allow the SYN/ACK to feed all four IP/ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   codepoints that the SYN could arrive with back to the client.</td><td> </td><td class="right">   codepoints that the SYN could arrive with back to the client.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Without this, the client could not know whether to disable ECN for</td><td> </td><td class="right">   Without this, the client could not know whether to disable ECN for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the connection due to mangling of the IP/ECN field (also explained in</td><td> </td><td class="right">   the connection due to mangling of the IP/ECN field (also explained in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 2.5).  This development consumed the remaining 2 codepoints</td><td> </td><td class="right">   Section 2.5).  This development consumed the remaining 2 codepoints</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   on the SYN/ACK that had been reserved for future use by AccECN in</td><td> </td><td class="right">   on the SYN/ACK that had been reserved for future use by AccECN in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   earlier versions.</td><td> </td><td class="right">   earlier versions.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-29" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-29"><em> page 63, line 16<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-29"><em> page 63, line 6<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the pattern tagged as 'Nonce', and a small but more significant</td><td> </td><td class="right">      the pattern tagged as 'Nonce', and a small but more significant</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      number arrive with the pattern tagged as 'Broken'.  The 'Nonce'</td><td> </td><td class="right">      number arrive with the pattern tagged as 'Broken'.  The 'Nonce'</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      pattern could be a sign that a few servers have implemented the</td><td> </td><td class="right">      pattern could be a sign that a few servers have implemented the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ECN Nonce [RFC3540], which has now been reclassified as historic</td><td> </td><td class="right">      ECN Nonce [RFC3540], which has now been reclassified as historic</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      [RFC8311], or it could be the random result of some unknown</td><td> </td><td class="right">      [RFC8311], or it could be the random result of some unknown</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      middlebox behaviour.  The greater prevalence of the 'Broken'</td><td> </td><td class="right">      middlebox behaviour.  The greater prevalence of the 'Broken'</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      pattern suggests that some instances still exist of the broken</td><td> </td><td class="right">      pattern suggests that some instances still exist of the broken</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      code that reflects the reserved flags on the SYN.</td><td> </td><td class="right">      code that reflects the reserved flags on the SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      The requirement not to reject unexpected initial values of the ACE</td><td> </td><td class="right">      The requirement not to reject unexpected initial values of the ACE</td><td class="lineno"><br></td></tr>
      <tr id="diff0217"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      counter (in the main TCP header) in the last para of</td><td> </td><td class="rblock">      counter (in the main TCP header) in the last para<span class="insert">graph</span> of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Section 3.2.2.4 ensures that 3 unused codepoints on the ACK of the</td><td> </td><td class="right">      Section 3.2.2.4 ensures that 3 unused codepoints on the ACK of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      SYN/ACK, 6 unused values on the first SYN=0 data packet from the</td><td> </td><td class="right">      SYN/ACK, 6 unused values on the first SYN=0 data packet from the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      client and 7 unused values on the first SYN=0 data packet from the</td><td> </td><td class="right">      client and 7 unused values on the first SYN=0 data packet from the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      server could be used to declare future variants of the AccECN</td><td> </td><td class="right">      server could be used to declare future variants of the AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      protocol.  The word 'declare' is used rather than 'negotiate'</td><td> </td><td class="right">      protocol.  The word 'declare' is used rather than 'negotiate'</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      because, at this late stage in the 3WHS, it would be too late for</td><td> </td><td class="right">      because, at this late stage in the 3WHS, it would be too late for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      a negotiation between the endpoints to be completed.  A similar</td><td> </td><td class="right">      a negotiation between the endpoints to be completed.  A similar</td><td class="lineno"><br></td></tr>
      <tr id="diff0218"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      requirement not to reject unexpected initial values in <span class="delete">the</span> TCP</td><td> </td><td class="rblock">      requirement not to reject unexpected initial values in <span class="insert">AccECN</span> TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">option</span> (Section 3.2.3.2.4) is for the same purpose.  If traversal</td><td> </td><td class="rblock">      <span class="insert">Options</span> (Section 3.2.3.2.4) is for the same purpose.  If traversal</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      of <span class="delete">the</span> TCP <span class="delete">option</span> were reliable, this would have enabled a far</td><td> </td><td class="rblock">      of <span class="insert">AccECN</span> TCP <span class="insert">Options</span> were reliable, this would have enabled a far</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      wider range of future variation of the whole AccECN protocol.</td><td> </td><td class="right">      wider range of future variation of the whole AccECN protocol.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Nonetheless, it could be used to reliably negotiate a wide range</td><td> </td><td class="right">      Nonetheless, it could be used to reliably negotiate a wide range</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      of variation in the semantics of the AccECN Option.</td><td> </td><td class="right">      of variation in the semantics of the AccECN Option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Future non-AccECN variants:  Five codepoints out of the 8 possible in</td><td> </td><td class="right">   Future non-AccECN variants:  Five codepoints out of the 8 possible in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the 3 TCP header flags used by AccECN are unused on the initial</td><td> </td><td class="right">      the 3 TCP header flags used by AccECN are unused on the initial</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      SYN (in the order AE,CWR,ECE): 001, 010, 100, 101, 110.</td><td> </td><td class="right">      SYN (in the order AE,CWR,ECE): 001, 010, 100, 101, 110.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Section 3.1.3 ensures that the installed base of AccECN servers</td><td> </td><td class="right">      Section 3.1.3 ensures that the installed base of AccECN servers</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      will all assume these are equivalent to AccECN negotiation with</td><td> </td><td class="right">      will all assume these are equivalent to AccECN negotiation with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      111 on the SYN.  These codepoints would not allow fall-back to</td><td> </td><td class="right">      111 on the SYN.  These codepoints would not allow fall-back to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Classic ECN support for a server that did not understand them, but</td><td> </td><td class="right">      Classic ECN support for a server that did not understand them, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      this approach ensures they are available in future, perhaps for</td><td> </td><td class="right">      this approach ensures they are available in future, perhaps for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      uses other than ECN alongside the AccECN scheme.  All possible</td><td> </td><td class="right">      uses other than ECN alongside the AccECN scheme.  All possible</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      combinations of SYN/ACK could be used in response except either</td><td> </td><td class="right">      combinations of SYN/ACK could be used in response except either</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      000 or reflection of the same values sent on the SYN.</td><td> </td><td class="right">      000 or reflection of the same values sent on the SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0219"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">Of course, other ways could be resorted to in</span> order to extend</td><td> </td><td class="rblock">      <span class="insert">In</span> order to extend AccECN or ECN in future, <span class="insert">other ways could be</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      AccECN or ECN in future, although their traversal properties are</td><td> </td><td class="rblock"><span class="insert">      resorted to,</span> although their traversal properties are likely to be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      likely to be inferior.  They include a new TCP option; using the</td><td> </td><td class="rblock">      inferior.  They include a new TCP option; using the remaining</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      remaining reserved flags in the main TCP header (preferably</td><td> </td><td class="rblock">      reserved flags in the main TCP header (preferably extending the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      extending the 3-bit combinations used by AccECN to 4-bit</td><td> </td><td class="rblock">      3-bit combinations used by AccECN to 4-bit combinations, rather</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      combinations, rather than burning one bit for just one state); a</td><td> </td><td class="rblock">      than burning one bit for just one state); a non-zero urgent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      non-zero urgent pointer in combination with the URG flag cleared;</td><td> </td><td class="rblock">      pointer in combination with the URG flag cleared; or some other</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      or some other unexpected combination of fields yet to be invented.</td><td> </td><td class="rblock">      unexpected combination of fields yet to be invented.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">Acknowledgements</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   We want to thank Koen De Schepper, Praveen Balasubramanian, Michael</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Welzl, Gorry Fairhurst, David Black, Spencer Dawkins, Michael Scharf,</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Michael Tüxen, Yuchung Cheng, Kenjiro Cho, Olivier Tilmans, Ilpo</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Järvinen, Neal Cardwell, Yoshifumi Nishida, Martin Duke, Jonathan</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Morton, Vidhi Goel, Alex Burr and Markku Kojo for their input and</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   discussion.  The idea of using the three ECN-related TCP flags as one</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   field for more accurate TCP-ECN feedback was first introduced in the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   re-ECN protocol that was the ancestor of ConEx.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Bob Briscoe was part-funded by the Comcast Innovation Fund, the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   European Community under its Seventh Framework Programme through the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Reducing Internet Transport Latency (RITE) project (ICT-317700) and</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   through the Trilogy 2 project (ICT-317756), and the Research Council</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   of Norway through the TimeIn project.  The views expressed here are</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   solely those of the authors.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Mirja Kühlewind was partly supported by the European Commission under</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Horizon 2020 grant agreement no. 688421 Measurement and Architecture</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   for a Middleboxed Internet (MAMI), and by the Swiss State Secretariat</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   for Education, Research, and Innovation under contract no.  15.0268.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   This support does not imply endorsement.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">Comments Solicited</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   This section is to be removed before publishing as an RFC.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Comments and questions are encouraged and very welcome.  They can be</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   addressed to the IETF TCP maintenance and minor modifications working</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   group mailing list &lt;tcpm@ietf.org&gt;, and/or to the authors.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Bob Briscoe</td><td> </td><td class="right">   Bob Briscoe</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Independent</td><td> </td><td class="right">   Independent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   United Kingdom</td><td> </td><td class="right">   United Kingdom</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Email: ietf@bobbriscoe.net</td><td> </td><td class="right">   Email: ietf@bobbriscoe.net</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   URI:   http://bobbriscoe.net/</td><td> </td><td class="right">   URI:   http://bobbriscoe.net/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Mirja Kühlewind</td><td> </td><td class="right">   Mirja Kühlewind</td><td class="lineno"><br></td></tr>

     <tr><td><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td><br></td></tr>
     <tr id="end" bgcolor="gray"><th colspan="5" align="center">&nbsp;End of changes. 219 change blocks.&nbsp;</th></tr>
     <tr class="stats"><td><br></td><th><i>614 lines changed or deleted</i></th><th><i> </i><br>
</th><th><i>646 lines changed or added</i></th><td><br></td></tr>
     <tr><td colspan="5" class="small" align="center"><br>This html diff was produced by rfcdiff 1.45. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/">http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </tbody></table>
   
   
</body></html>