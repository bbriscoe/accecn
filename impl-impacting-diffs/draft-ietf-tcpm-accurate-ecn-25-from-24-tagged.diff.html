<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by rfcdiff 1.45: rfcdiff  -->
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux c728f7009bdd 5.14.21-150400.24.38-default #1 SMP PREEMPT_DYNAMIC Fri Dec 9 09:29:22 UTC 2022 (e9c5676) x86_64 x86_64 x86_64 GNU/Linux -->
<!-- Using awk: /usr/bin/gawk: GNU Awk 5.1.0, API: 3.0 (GNU MPFR 4.1.0, GNU MP 6.2.1) -->
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.8 -->
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta http-equiv="Content-Style-Type" content="text/css"> 
  <title>Diff: draft-ietf-tcpm-accurate-ecn-24.txt - draft-ietf-tcpm-accurate-ecn-25.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
    span.hide { display: none; color: #aaa;}    a:hover span { display: inline; }    tr.change { background-color: gray; } 
    tr.change a { text-decoration: none; color: black } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('tr[id$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk;
    old_chunk.style.outline = "1px solid red";
    window.location.hash = "#" + new_str;
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
</head> 
<body> 
  <table border="0" cellspacing="0" cellpadding="0"> 
  <tbody><tr id="part-1" bgcolor="orange"><th><br>
</th><th>&nbsp;draft-ietf-tcpm-accurate-ecn-24.txt&nbsp;</th><th> <br>
</th><th>&nbsp;draft-ietf-tcpm-accurate-ecn-25.txt&nbsp;</th><th><br>
</th></tr> 
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">TCP Maintenance &amp; Minor Extensions (tcpm)                     B. Briscoe</td><td> </td><td class="right">TCP Maintenance &amp; Minor Extensions (tcpm)                     B. Briscoe</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Internet-Draft                                               Independent</td><td> </td><td class="right">Internet-Draft                                               Independent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Updates: 3168 (if approved)                                 M. Kühlewind</td><td> </td><td class="right">Updates: 3168 (if approved)                                 M. Kühlewind</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Intended status: Standards Track                                Ericsson</td><td> </td><td class="right">Intended status: Standards Track                                Ericsson</td><td class="lineno"><br></td></tr>
      <tr id="diff0001"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">Expires: <span class="delete">1 October 2023 </span>                                R. Scheffenegger</td><td> </td><td class="rblock">Expires: <span class="insert">25 January 2024</span>                                R. Scheffenegger</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                                                                  NetApp</td><td> </td><td class="right">                                                                  NetApp</td><td class="lineno"><br></td></tr>
      <tr id="diff0002"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                                                           <span class="delete">30 March</span> 2023</td><td> </td><td class="rblock">                                                           <span class="insert"> 24 July</span> 2023</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">  More Accurate Explicit Congestion Notification (ECN) Feedback in TCP</td><td> </td><td class="right">  More Accurate Explicit Congestion Notification (ECN) Feedback in TCP</td><td class="lineno"><br></td></tr>
      <tr id="diff0003"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                    draft-ietf-tcpm-accurate-ecn-2<span class="delete">4</span></td><td> </td><td class="rblock">                    draft-ietf-tcpm-accurate-ecn-2<span class="insert">5</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Explicit Congestion Notification (ECN) is a mechanism where network</td><td> </td><td class="right">   Explicit Congestion Notification (ECN) is a mechanism where network</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   nodes can mark IP packets instead of dropping them to indicate</td><td> </td><td class="right">   nodes can mark IP packets instead of dropping them to indicate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   incipient congestion to the endpoints.  Receivers with an ECN-capable</td><td> </td><td class="right">   incipient congestion to the endpoints.  Receivers with an ECN-capable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   transport protocol feed back this information to the sender.  ECN was</td><td> </td><td class="right">   transport protocol feed back this information to the sender.  ECN was</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   originally specified for TCP in such a way that only one feedback</td><td> </td><td class="right">   originally specified for TCP in such a way that only one feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   signal can be transmitted per Round-Trip Time (RTT).  Recent new TCP</td><td> </td><td class="right">   signal can be transmitted per Round-Trip Time (RTT).  Recent new TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   mechanisms like Congestion Exposure (ConEx), Data Center TCP (DCTCP)</td><td> </td><td class="right">   mechanisms like Congestion Exposure (ConEx), Data Center TCP (DCTCP)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-2" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 10<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-2"><em> page 2, line 10<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Internet-Drafts are draft documents valid for a maximum of six months</td><td> </td><td class="right">   Internet-Drafts are draft documents valid for a maximum of six months</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and may be updated, replaced, or obsoleted by other documents at any</td><td> </td><td class="right">   and may be updated, replaced, or obsoleted by other documents at any</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   time.  It is inappropriate to use Internet-Drafts as reference</td><td> </td><td class="right">   time.  It is inappropriate to use Internet-Drafts as reference</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   material or to cite them other than as "work in progress."</td><td> </td><td class="right">   material or to cite them other than as "work in progress."</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0004"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   This Internet-Draft will expire on <span class="delete">1 October 2023</span>.</td><td> </td><td class="rblock">   This Internet-Draft will expire on <span class="insert">25 January 2024</span>.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Copyright (c) 2023 IETF Trust and the persons identified as the</td><td> </td><td class="right">   Copyright (c) 2023 IETF Trust and the persons identified as the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td> </td><td class="right">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   license-info) in effect on the date of publication of this document.</td><td> </td><td class="right">   license-info) in effect on the date of publication of this document.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Please review these documents carefully, as they describe your rights</td><td> </td><td class="right">   Please review these documents carefully, as they describe your rights</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and restrictions with respect to this document.  Code Components</td><td> </td><td class="right">   and restrictions with respect to this document.  Code Components</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   extracted from this document must include Revised BSD License text as</td><td> </td><td class="right">   extracted from this document must include Revised BSD License text as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   described in Section 4.e of the Trust Legal Provisions and are</td><td> </td><td class="right">   described in Section 4.e of the Trust Legal Provisions and are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   provided without warranty as described in the Revised BSD License.</td><td> </td><td class="right">   provided without warranty as described in the Revised BSD License.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0005"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">This document may contain material from IETF Documents or IETF</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Contributions published or made publicly available before November</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   10, 2008.  The person(s) controlling the copyright in some of this</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   material may not have granted the IETF Trust the right to allow</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   modifications of such material outside the IETF Standards Process.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Without obtaining an adequate license from the person(s) controlling</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   the copyright in such materials, this document may not be modified</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   outside the IETF Standards Process, and derivative works of it may</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   not be created outside the IETF Standards Process, except to format</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   it for publication as an RFC or to translate it into languages other</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   than English.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4</td><td> </td><td class="right">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   4</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.1.  Document Roadmap  . . . . . . . . . . . . . . . . . . . .   5</td><td> </td><td class="right">     1.1.  Document Roadmap  . . . . . . . . . . . . . . . . . . . .   5</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="right">     1.2.  Goals . . . . . . . . . . . . . . . . . . . . . . . . . .   6</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.3.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="right">     1.3.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   6</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     1.4.  Recap of Existing ECN feedback in IP/TCP  . . . . . . . .   7</td><td> </td><td class="right">     1.4.  Recap of Existing ECN feedback in IP/TCP  . . . . . . . .   7</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   2.  AccECN Protocol Overview and Rationale  . . . . . . . . . . .   8</td><td> </td><td class="right">   2.  AccECN Protocol Overview and Rationale  . . . . . . . . . . .   8</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.1.  Capability Negotiation  . . . . . . . . . . . . . . . . .   9</td><td> </td><td class="right">     2.1.  Capability Negotiation  . . . . . . . . . . . . . . . . .   9</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.2.  Feedback Mechanism  . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     2.2.  Feedback Mechanism  . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.3.  Delayed ACKs and Resilience Against ACK Loss  . . . . . .  10</td><td> </td><td class="right">     2.3.  Delayed ACKs and Resilience Against ACK Loss  . . . . . .  10</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     2.4.  Feedback Metrics  . . . . . . . . . . . . . . . . . . . .  11</td><td> </td><td class="right">     2.4.  Feedback Metrics  . . . . . . . . . . . . . . . . . . . .  11</td><td class="lineno"><br></td></tr>
      <tr id="diff0006"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     2.5.  Generic (Mechanistic) Reflector . . . . . . . . . . . . .  <span class="delete">12</span></td><td> </td><td class="rblock">     2.5.  Generic (Mechanistic) Reflector . . . . . . . . . . . . .  <span class="insert">11</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   3.  AccECN Protocol Specification . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock">   3.  AccECN Protocol Specification . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     3.1.  Negotiating to use AccECN . . . . . . . . . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock">     3.1.  Negotiating to use AccECN . . . . . . . . . . . . . . . .  <span class="insert">12</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       3.1.1.  Negotiation during the TCP handshake  . . . . . . . .  <span class="delete">13</span></td><td> </td><td class="rblock">       3.1.1.  Negotiation during the TCP handshake  . . . . . . . .  <span class="insert">12</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       3.1.2.  Backward Compatibility  . . . . . . . . . . . . . . .  <span class="delete">14</span></td><td> </td><td class="rblock">       3.1.2.  Backward Compatibility  . . . . . . . . . . . . . . .  <span class="insert">13</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       3.1.3.  Forward Compatibility . . . . . . . . . . . . . . . .  <span class="delete">17</span></td><td> </td><td class="rblock">       3.1.3.  Forward Compatibility . . . . . . . . . . . . . . . .  <span class="insert">16</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       3.1.4.  <span class="delete">Retransmission of the SYN</span> . . . . . . . . . . . . . .  <span class="delete">17</span></td><td> </td><td class="rblock">       3.1.4.  <span class="insert">Retransmitted SYNs</span>  . . . . . . . . . . . . . . <span class="insert">. . .  16</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       3.1.5.  Implications of AccECN Mode . . . . . . . . . . . . .  <span class="delete">18</span></td><td> </td><td class="rblock">       3.1.5.  Implications of AccECN Mode . . . . . . . . . . . . .  <span class="insert">17</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     3.2.  AccECN Feedback . . . . . . . . . . . . . . . . . . . . .  <span class="delete">20</span></td><td> </td><td class="rblock">     3.2.  AccECN Feedback . . . . . . . . . . . . . . . . . . . . .  <span class="insert">19</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.2.1.  Initialization of Feedback Counters . . . . . . . . .  20</td><td> </td><td class="right">       3.2.1.  Initialization of Feedback Counters . . . . . . . . .  20</td><td class="lineno"><br></td></tr>
      <tr id="diff0007"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       3.2.2.  The ACE Field . . . . . . . . . . . . . . . . . . . .  <span class="delete">21</span></td><td> </td><td class="rblock">       3.2.2.  The ACE Field . . . . . . . . . . . . . . . . . . . .  <span class="insert">20</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         3.2.2.1.  ACE Field on the ACK of the SYN/ACK . . . . . . .  <span class="delete">22</span></td><td> </td><td class="rblock">         3.2.2.1.  ACE Field on the ACK of the SYN/ACK . . . . . . .  <span class="insert">21</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         3.2.2.2.  Encoding and Decoding Feedback in the ACE</td><td> </td><td class="right">         3.2.2.2.  Encoding and Decoding Feedback in the ACE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                 Field . . . . . . . . . . . . . . . . . . . . . . .  24</td><td> </td><td class="right">                 Field . . . . . . . . . . . . . . . . . . . . . . .  24</td><td class="lineno"><br></td></tr>
      <tr id="diff0008"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         3.2.2.3.  Testing for Mangling of the IP/ECN Field  . . . .  2<span class="delete">6</span></td><td> </td><td class="rblock">         3.2.2.3.  Testing for Mangling of the IP/ECN Field  . . . .  2<span class="insert">5</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         3.2.2.4.  Testing for Zeroing of the ACE Field  . . . . . .  27</td><td> </td><td class="right">         3.2.2.4.  Testing for Zeroing of the ACE Field  . . . . . .  27</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         3.2.2.5.  Safety against Ambiguity of the ACE Field . . . .  28</td><td> </td><td class="right">         3.2.2.5.  Safety against Ambiguity of the ACE Field . . . .  28</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.2.3.  The AccECN Option . . . . . . . . . . . . . . . . . .  31</td><td> </td><td class="right">       3.2.3.  The AccECN Option . . . . . . . . . . . . . . . . . .  31</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         3.2.3.1.  Encoding and Decoding Feedback in the AccECN Option</td><td> </td><td class="right">         3.2.3.1.  Encoding and Decoding Feedback in the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                 Fields  . . . . . . . . . . . . . . . . . . . . . .  33</td><td> </td><td class="right">                 Fields  . . . . . . . . . . . . . . . . . . . . . .  33</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         3.2.3.2.  Path Traversal of the AccECN Option . . . . . . .  33</td><td> </td><td class="right">         3.2.3.2.  Path Traversal of the AccECN Option . . . . . . .  33</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         3.2.3.3.  Usage of the AccECN TCP Option  . . . . . . . . .  37</td><td> </td><td class="right">         3.2.3.3.  Usage of the AccECN TCP Option  . . . . . . . . .  37</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     3.3.  AccECN Compliance Requirements for TCP Proxies, Offload</td><td> </td><td class="right">     3.3.  AccECN Compliance Requirements for TCP Proxies, Offload</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">           Engines and other Middleboxes . . . . . . . . . . . . . .  40</td><td> </td><td class="right">           Engines and other Middleboxes . . . . . . . . . . . . . .  40</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       3.3.1.  Requirements for TCP Proxies  . . . . . . . . . . . .  40</td><td> </td><td class="right">       3.3.1.  Requirements for TCP Proxies  . . . . . . . . . . . .  40</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-3" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-3"><em> page 4, line 42<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-3"><em> page 4, line 36<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the TCP header to provide more than one feedback signal per RTT.  It</td><td> </td><td class="right">   the TCP header to provide more than one feedback signal per RTT.  It</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   will be called the more accurate ECN feedback scheme, or AccECN for</td><td> </td><td class="right">   will be called the more accurate ECN feedback scheme, or AccECN for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   short.  This document updates RFC 3168 with respect to negotiation</td><td> </td><td class="right">   short.  This document updates RFC 3168 with respect to negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and use of the feedback scheme for TCP.  All aspects of RFC 3168</td><td> </td><td class="right">   and use of the feedback scheme for TCP.  All aspects of RFC 3168</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   other than the TCP feedback scheme and its negotiation remain</td><td> </td><td class="right">   other than the TCP feedback scheme and its negotiation remain</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   unchanged by this specification.  In particular the definition of ECN</td><td> </td><td class="right">   unchanged by this specification.  In particular the definition of ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   at the IP layer is unaffected.  Section 4 gives a more detailed</td><td> </td><td class="right">   at the IP layer is unaffected.  Section 4 gives a more detailed</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specification of exactly which aspects of RFC 3168 this document</td><td> </td><td class="right">   specification of exactly which aspects of RFC 3168 this document</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   updates.</td><td> </td><td class="right">   updates.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0009"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN is intended to offer a complete replacement for <span class="delete">classic TCP/</span></td><td> </td><td class="rblock">   <span class="insert">This document uses the term Classic ECN feedback when it needs to</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   ECN</span> feedback, not a fork in the design of TCP.  AccECN feedback</td><td> </td><td class="rblock"><span class="insert">   distinguish the TCP/ECN feedback scheme defined in [RFC3168] from the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   complements TCP's loss feedback and it can coexist alongside</td><td> </td><td class="rblock"><span class="insert">   AccECN TCP feedback scheme.</span>  AccECN is intended to offer a complete</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">'classic' [RFC3168]</span> TCP/ECN feedback.  So its applicability is</td><td> </td><td class="rblock">   replacement for <span class="insert">Classic TCP/ECN</span> feedback, not a fork in the design of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   intended to include all public and private IP networks (and even any</td><td> </td><td class="rblock">   TCP.  AccECN feedback complements TCP's loss feedback and it can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   non-IP networks over which TCP is <span class="delete">used today),</span> whether or not any</td><td> </td><td class="rblock">   coexist alongside <span class="insert">hosts using Classic</span> TCP/ECN feedback.  So its</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   nodes on the path support ECN, of whatever flavour.  <span class="delete">This document</span></td><td> </td><td class="rblock">   applicability is intended to include all public and private IP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   uses the term Classic ECN when it needs to distinguish the RFC 3168</span></td><td> </td><td class="rblock">   networks (and even any non-IP networks over which TCP is <span class="insert">used),</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   ECN TCP feedback scheme from the AccECN TCP feedback scheme.</span></td><td> </td><td class="rblock">   whether or not any nodes on the path support ECN, of whatever</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   flavour.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN feedback overloads the two existing ECN flags in the TCP</td><td> </td><td class="right">   AccECN feedback overloads the two existing ECN flags in the TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   header and allocates the currently reserved flag (previously called</td><td> </td><td class="right">   header and allocates the currently reserved flag (previously called</td><td class="lineno"><br></td></tr>
      <tr id="diff0010"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   NS) in the TCP header, to be used as one three-bit counter field</td><td> </td><td class="rblock">   NS) in the TCP header, to be used as one three-bit counter field <span class="insert">for</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">indicating</span> the number of congestion experienced <span class="delete">marked packets.</span></td><td> </td><td class="rblock"><span class="insert">   feeding back</span> the number of <span class="insert">packets marked as</span> congestion experienced</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Given the new definitions of these three bits, both ends have to</td><td> </td><td class="rblock">   <span class="insert">(CE).</span>  Given the new definitions of these three bits, both ends have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   support the new wire protocol before it can be used.  <span class="delete">Therefore</span></td><td> </td><td class="rblock">   to support the new wire protocol before it can be used.  <span class="insert">Therefore,</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   during the TCP <span class="delete">handshake</span> the two ends use these three bits in the TCP</td><td> </td><td class="rblock">   during the TCP <span class="insert">handshake,</span> the two ends use these three bits in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   header to negotiate the most advanced feedback protocol that they can</td><td> </td><td class="rblock">   TCP header to negotiate the most advanced feedback protocol that they</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   both support, in a way that is backward compatible with [RFC3168].</td><td> </td><td class="rblock">   can both support, in a way that is backward compatible with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN is solely a change to the TCP wire protocol; it covers the</td><td> </td><td class="right">   AccECN is solely a change to the TCP wire protocol; it covers the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   negotiation and signaling of more accurate ECN feedback from a TCP</td><td> </td><td class="right">   negotiation and signaling of more accurate ECN feedback from a TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Data Receiver to a Data Sender.  It is completely independent of how</td><td> </td><td class="right">   Data Receiver to a Data Sender.  It is completely independent of how</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP might respond to congestion feedback, which is out of scope, but</td><td> </td><td class="right">   TCP might respond to congestion feedback, which is out of scope, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ultimately the motivation for accurate ECN feedback.  Like Classic</td><td> </td><td class="right">   ultimately the motivation for accurate ECN feedback.  Like Classic</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN feedback, AccECN can be used by standard Reno congestion control</td><td> </td><td class="right">   ECN feedback, AccECN can be used by standard Reno congestion control</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC5681] to respond to the existence of at least one congestion</td><td> </td><td class="right">   [RFC5681] to respond to the existence of at least one congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   notification within a round trip.  Or, unlike Reno, AccECN can be</td><td> </td><td class="right">   notification within a round trip.  Or, unlike Reno, AccECN can be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   used to respond to the extent of congestion notification over a round</td><td> </td><td class="right">   used to respond to the extent of congestion notification over a round</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-4" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-4"><em> page 6, line 28<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-4"><em> page 6, line 20<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   complexity, overhead and compatibility (both backward and forward).</td><td> </td><td class="right">   complexity, overhead and compatibility (both backward and forward).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   It recognizes that a perfect scheme that fully satisfies all the</td><td> </td><td class="right">   It recognizes that a perfect scheme that fully satisfies all the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   requirements is unlikely and trade-offs between requirements are</td><td> </td><td class="right">   requirements is unlikely and trade-offs between requirements are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   likely.  Section 6 presents the properties of AccECN against these</td><td> </td><td class="right">   likely.  Section 6 presents the properties of AccECN against these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   requirements and discusses the trade-offs made.</td><td> </td><td class="right">   requirements and discusses the trade-offs made.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The requirements document recognizes that a protocol as ubiquitous as</td><td> </td><td class="right">   The requirements document recognizes that a protocol as ubiquitous as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP needs to be able to serve as-yet-unspecified requirements.</td><td> </td><td class="right">   TCP needs to be able to serve as-yet-unspecified requirements.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Therefore an AccECN receiver acts as a generic (mechanistic)</td><td> </td><td class="right">   Therefore an AccECN receiver acts as a generic (mechanistic)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   reflector of congestion information with the aim that in future new</td><td> </td><td class="right">   reflector of congestion information with the aim that in future new</td><td class="lineno"><br></td></tr>
      <tr id="diff0011"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   sender behaviours can be deployed unilaterally.</td><td> </td><td class="rblock">   sender behaviours can be deployed unilaterally<span class="insert"> (see Section 2.5)</span>.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">1.3.  Terminology</td><td> </td><td class="right">1.3.  Terminology</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN:  The more accurate ECN feedback scheme will be called AccECN</td><td> </td><td class="right">   AccECN:  The more accurate ECN feedback scheme will be called AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      for short.</td><td> </td><td class="right">      for short.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Classic ECN:  The ECN protocol specified in [RFC3168].</td><td> </td><td class="right">   Classic ECN:  The ECN protocol specified in [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Classic ECN feedback:  The feedback aspect of the ECN protocol</td><td> </td><td class="right">   Classic ECN feedback:  The feedback aspect of the ECN protocol</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      specified in [RFC3168], including generation, encoding,</td><td> </td><td class="right">      specified in [RFC3168], including generation, encoding,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-5" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-5"><em> page 7, line 27<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-5"><em> page 7, line 18<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td> </td><td class="right">   14 [RFC2119] [RFC8174] when, and only when, they appear in all</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   capitals, as shown here.</td><td> </td><td class="right">   capitals, as shown here.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">1.4.  Recap of Existing ECN feedback in IP/TCP</td><td> </td><td class="right">1.4.  Recap of Existing ECN feedback in IP/TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN [RFC3168] uses a two bit field in the IP header.  Once ECN has</td><td> </td><td class="right">   ECN [RFC3168] uses a two bit field in the IP header.  Once ECN has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   been negotiated for a transport layer connection, the Data Sender for</td><td> </td><td class="right">   been negotiated for a transport layer connection, the Data Sender for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   either half-connection can set two possible codepoints (ECT(0) or</td><td> </td><td class="right">   either half-connection can set two possible codepoints (ECT(0) or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECT(1)) in the IP header of a data packet to indicate an ECN-capable</td><td> </td><td class="right">   ECT(1)) in the IP header of a data packet to indicate an ECN-capable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   transport (ECT).  If the ECN codepoint is 0b00, the packet is</td><td> </td><td class="right">   transport (ECT).  If the ECN codepoint is 0b00, the packet is</td><td class="lineno"><br></td></tr>
      <tr id="diff0012"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   considered to have been sent by a Not<span class="delete">-</span>ECN-capable Transport (Not-</td><td> </td><td class="rblock">   considered to have been sent by a Not<span class="insert"> </span>ECN-capable Transport (Not-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECT).  When a network node experiences congestion, it will</td><td> </td><td class="right">   ECT).  When a network node experiences congestion, it will</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   occasionally either drop or mark a packet, with the choice depending</td><td> </td><td class="right">   occasionally either drop or mark a packet, with the choice depending</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   on the packet's ECN codepoint.  If the codepoint is Not-ECT, only</td><td> </td><td class="right">   on the packet's ECN codepoint.  If the codepoint is Not-ECT, only</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   drop is appropriate.  If the codepoint is ECT(0) or ECT(1), the node</td><td> </td><td class="right">   drop is appropriate.  If the codepoint is ECT(0) or ECT(1), the node</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   can mark the packet by setting the ECN codepoint to 0b11, which is</td><td> </td><td class="right">   can mark the packet by setting the ECN codepoint to 0b11, which is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   termed 'Congestion Experienced' (CE), or loosely a 'congestion mark'.</td><td> </td><td class="right">   termed 'Congestion Experienced' (CE), or loosely a 'congestion mark'.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Table 1 summarises these codepoints.</td><td> </td><td class="right">   Table 1 summarises these codepoints.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +==================+================+===========================+</td><td> </td><td class="right">     +==================+================+===========================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | IP-ECN codepoint | Codepoint name | Description               |</td><td> </td><td class="right">     | IP-ECN codepoint | Codepoint name | Description               |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-6" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-6"><em> page 7, line 52<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-6"><em> page 7, line 43<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +------------------+----------------+---------------------------+</td><td> </td><td class="right">     +------------------+----------------+---------------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | 0b10             | ECT(0)         | ECN-Capable Transport (0) |</td><td> </td><td class="right">     | 0b10             | ECT(0)         | ECN-Capable Transport (0) |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +------------------+----------------+---------------------------+</td><td> </td><td class="right">     +------------------+----------------+---------------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | 0b11             | CE             | Congestion Experienced    |</td><td> </td><td class="right">     | 0b11             | CE             | Congestion Experienced    |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +------------------+----------------+---------------------------+</td><td> </td><td class="right">     +------------------+----------------+---------------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                  Table 1: The ECN Field in the IP Header</td><td> </td><td class="right">                  Table 1: The ECN Field in the IP Header</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   In the TCP header the first two bits in byte 14 (the TCP header flags</td><td> </td><td class="right">   In the TCP header the first two bits in byte 14 (the TCP header flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   at bit offsets 8 and 9 labelled CWR and ECE in Figure 1) are defined</td><td> </td><td class="right">   at bit offsets 8 and 9 labelled CWR and ECE in Figure 1) are defined</td><td class="lineno"><br></td></tr>
      <tr id="diff0013"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   as flags for the use of ECN [RFC3168].  A TCP Client indicates it</td><td> </td><td class="rblock">   as flags for the use of <span class="insert">Classic</span> ECN [RFC3168].  A TCP Client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   supports ECN by setting <span class="delete">ECE=CWR=1</span> in the SYN, and an ECN-enabled TCP</td><td> </td><td class="rblock">   indicates <span class="insert">that</span> it supports <span class="insert">Classic</span> ECN <span class="insert">feedback</span> by setting <span class="insert">(CWR,ECE)</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Server confirms ECN support by setting <span class="delete">ECE=1 and CWR=0</span> in the <span class="delete">SYN/</span></td><td> </td><td class="rblock"><span class="insert">   = (1,1)</span> in the SYN, and an ECN-enabled TCP Server confirms <span class="insert">Classic</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   ACK.</span>  On reception of a CE-marked packet at the IP layer, the Data</td><td> </td><td class="rblock">   ECN support by setting <span class="insert">(CWR,ECE) = (0,1)</span> in the <span class="insert">SYN/ACK.</span>  On</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Receiver for that half-connection starts to set the Echo Congestion</td><td> </td><td class="rblock">   reception of a CE-marked packet at the IP layer, the Data Receiver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   for that half-connection starts to set the Echo Congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Experienced (ECE) flag continuously in the TCP header of ACKs, which</td><td> </td><td class="right">   Experienced (ECE) flag continuously in the TCP header of ACKs, which</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   gives the signal resilience to loss or reordering of ACKs.  The Data</td><td> </td><td class="right">   gives the signal resilience to loss or reordering of ACKs.  The Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Sender for the same half-connection confirms that it has received at</td><td> </td><td class="right">   Sender for the same half-connection confirms that it has received at</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   least one ECE signal by responding with the congestion window reduced</td><td> </td><td class="right">   least one ECE signal by responding with the congestion window reduced</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (CWR) flag, which allows the Data Receiver to stop repeating the ECN-</td><td> </td><td class="right">   (CWR) flag, which allows the Data Receiver to stop repeating the ECN-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Echo flag.  This always leads to a full RTT of ACKs with ECE set.</td><td> </td><td class="right">   Echo flag.  This always leads to a full RTT of ACKs with ECE set.</td><td class="lineno"><br></td></tr>
      <tr id="diff0014"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Thus any additional CE markings arriving within this <span class="delete">RTT cannot be</span></td><td> </td><td class="rblock">   Thus <span class="insert">Classic ECN cannot feed back</span> any additional CE markings arriving</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   fed back.</span></td><td> </td><td class="rblock">   within this <span class="insert">RTT.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The last bit in byte 13 of the TCP header (the TCP header flag at bit</td><td> </td><td class="right">   The last bit in byte 13 of the TCP header (the TCP header flag at bit</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   offset 7 in Figure 1) was defined as the Nonce Sum (NS) for the ECN</td><td> </td><td class="right">   offset 7 in Figure 1) was defined as the Nonce Sum (NS) for the ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Nonce [RFC3540].  In the absence of widespread deployment RFC 3540</td><td> </td><td class="right">   Nonce [RFC3540].  In the absence of widespread deployment RFC 3540</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   has been reclassified as historic [RFC8311] and the respective flag</td><td> </td><td class="right">   has been reclassified as historic [RFC8311] and the respective flag</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   has been marked as "reserved", making this TCP flag available for use</td><td> </td><td class="right">   has been marked as "reserved", making this TCP flag available for use</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   by AccECN instead.</td><td> </td><td class="right">   by AccECN instead.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td> </td><td class="right">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           | N | C | E | U | A | P | R | S | F |</td><td> </td><td class="right">     |               |           | N | C | E | U | A | P | R | S | F |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | Header Length | Reserved  | S | W | C | R | C | S | S | Y | I |</td><td> </td><td class="right">     | Header Length | Reserved  | S | W | C | R | C | S | S | Y | I |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           |   | R | E | G | K | H | T | N | N |</td><td> </td><td class="right">     |               |           |   | R | E | G | K | H | T | N | N |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0015"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">     Figure 1: <span class="delete">The (post-ECN Nonce) definition of the</span> TCP header flags</td><td> </td><td class="rblock">      Figure 1: TCP header flags <span class="insert">as defined before the Nonce Sum flag</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">                            reverted to Reserved</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.  AccECN Protocol Overview and Rationale</td><td> </td><td class="right">2.  AccECN Protocol Overview and Rationale</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This section provides an informative overview of the AccECN protocol</td><td> </td><td class="right">   This section provides an informative overview of the AccECN protocol</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that will be normatively specified in Section 3</td><td> </td><td class="right">   that will be normatively specified in Section 3</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0016"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Like the <span class="delete">origin</span>al TCP approach, the Data Receiver of each TCP half-</td><td> </td><td class="rblock">   Like the <span class="insert">gener</span>al TCP approach, the Data Receiver of each TCP half-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection sends AccECN feedback to the Data Sender on TCP</td><td> </td><td class="right">   connection sends AccECN feedback to the Data Sender on TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   acknowledgements, reusing data packets of the other half-connection</td><td> </td><td class="right">   acknowledgements, reusing data packets of the other half-connection</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whenever possible.</td><td> </td><td class="right">   whenever possible.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The AccECN protocol has had to be designed in two parts:</td><td> </td><td class="right">   The AccECN protocol has had to be designed in two parts:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0017"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  an essential part that re-uses <span class="delete">ECN TCP</span> header bits for the Data</td><td> </td><td class="rblock">   *  an essential part that re-uses <span class="insert">the TCP-ECN</span> header bits for the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Receiver to feed back the number of packets arriving with CE in</td><td> </td><td class="rblock">      Data Receiver to feed back the number of packets arriving with CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      the IP-ECN field.  This provides more accuracy than <span class="delete">classic</span> ECN</td><td> </td><td class="rblock">      in the IP-ECN field.  This provides more accuracy than <span class="insert">Classic</span> ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback, but limited resilience against ACK loss;</td><td> </td><td class="right">      feedback, but limited resilience against ACK loss;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  a supplementary part using one of two new alternative AccECN TCP</td><td> </td><td class="right">   *  a supplementary part using one of two new alternative AccECN TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Options that provide additional feedback on the number of bytes</td><td> </td><td class="right">      Options that provide additional feedback on the number of bytes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      that arrive marked with each of the three ECN codepoints in the</td><td> </td><td class="right">      that arrive marked with each of the three ECN codepoints in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      IP-ECN field (not just CE marks).  This provides greater</td><td> </td><td class="right">      IP-ECN field (not just CE marks).  This provides greater</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      resilience against ACK loss than the essential feedback, but it is</td><td> </td><td class="right">      resilience against ACK loss than the essential feedback, but it is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      currently more likely to suffer from middlebox interference.</td><td> </td><td class="right">      currently more likely to suffer from middlebox interference.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The two part design was necessary, given limitations on the space</td><td> </td><td class="right">   The two part design was necessary, given limitations on the space</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available for TCP options and given the possibility that certain</td><td> </td><td class="right">   available for TCP options and given the possibility that certain</td><td class="lineno"><br></td></tr>
      <tr id="diff0018"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   incorrectly designed middleboxes prevent TCP using any new options.</td><td> </td><td class="rblock">   incorrectly designed middleboxes <span class="insert">might</span> prevent TCP using any new</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   options.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The essential part overloads the previous definition of the three</td><td> </td><td class="right">   The essential part overloads the previous definition of the three</td><td class="lineno"><br></td></tr>
      <tr id="diff0019"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flags in the TCP header that had been assigned for use by ECN.  This</td><td> </td><td class="rblock">   flags in the TCP header that had been assigned for use by <span class="insert">Classic</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   design choice deliberately allows AccECN peers to replace the <span class="delete">classic</span></td><td> </td><td class="rblock">   ECN.  This design choice deliberately allows AccECN peers to replace</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN feedback protocol, rather than leaving <span class="delete">classic</span> ECN feedback</td><td> </td><td class="rblock">   the <span class="insert">Classic</span> ECN feedback protocol, rather than leaving <span class="insert">Classic</span> ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   intact and adding more accurate feedback separately because:</td><td> </td><td class="rblock">   feedback intact and adding more accurate feedback separately because:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  this efficiently reuses scarce TCP header space, given TCP option</td><td> </td><td class="right">   *  this efficiently reuses scarce TCP header space, given TCP option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      space is approaching saturation;</td><td> </td><td class="right">      space is approaching saturation;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  a single upgrade path for the TCP protocol is preferable to a fork</td><td> </td><td class="right">   *  a single upgrade path for the TCP protocol is preferable to a fork</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      in the design;</td><td> </td><td class="right">      in the design;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0020"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  otherwise <span class="delete">c</span>lassic and accurate ECN feedback could give conflicting</td><td> </td><td class="rblock">   *  otherwise <span class="insert">C</span>lassic and accurate ECN feedback could give conflicting</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback about the same segment, which could open up new security</td><td> </td><td class="right">      feedback about the same segment, which could open up new security</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      concerns and make implementations unnecessarily complex;</td><td> </td><td class="right">      concerns and make implementations unnecessarily complex;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  middleboxes are more likely to faithfully forward the TCP ECN</td><td> </td><td class="right">   *  middleboxes are more likely to faithfully forward the TCP ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      flags than newly defined areas of the TCP header.</td><td> </td><td class="right">      flags than newly defined areas of the TCP header.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN is designed to work even if the supplementary part is removed</td><td> </td><td class="right">   AccECN is designed to work even if the supplementary part is removed</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   or zeroed out, as long as the essential part gets through.</td><td> </td><td class="right">   or zeroed out, as long as the essential part gets through.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.1.  Capability Negotiation</td><td> </td><td class="right">2.1.  Capability Negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-7" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-7"><em> page 10, line 27<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-7"><em> page 10, line 22<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The Data Sender maintains four equivalent counters for the half</td><td> </td><td class="right">   The Data Sender maintains four equivalent counters for the half</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection, and the AccECN protocol is designed to ensure they will</td><td> </td><td class="right">   connection, and the AccECN protocol is designed to ensure they will</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   match the values in the Data Receiver's counters, albeit after a</td><td> </td><td class="right">   match the values in the Data Receiver's counters, albeit after a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   little delay.</td><td> </td><td class="right">   little delay.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Each ACK carries the three least significant bits (LSBs) of the</td><td> </td><td class="right">   Each ACK carries the three least significant bits (LSBs) of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packet-based CE counter using the ECN bits in the TCP header, now</td><td> </td><td class="right">   packet-based CE counter using the ECN bits in the TCP header, now</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   renamed the Accurate ECN (ACE) field (see Figure 3 later).  The 24</td><td> </td><td class="right">   renamed the Accurate ECN (ACE) field (see Figure 3 later).  The 24</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   LSBs of some or all of the byte counters can be optionally carried in</td><td> </td><td class="right">   LSBs of some or all of the byte counters can be optionally carried in</td><td class="lineno"><br></td></tr>
      <tr id="diff0021"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   an AccECN Option.</td><td> </td><td class="rblock">   an AccECN Option.  <span class="insert">For efficient use of limited option space, two</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   alternative forms of AccECN Option are specified with the fields in</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   opposite order to each other.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.3.  Delayed ACKs and Resilience Against ACK Loss</td><td> </td><td class="right">2.3.  Delayed ACKs and Resilience Against ACK Loss</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   With both the ACE and the AccECN Option mechanisms, the Data Receiver</td><td> </td><td class="right">   With both the ACE and the AccECN Option mechanisms, the Data Receiver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   continually repeats the current LSBs of each of its respective</td><td> </td><td class="right">   continually repeats the current LSBs of each of its respective</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counters.  There is no need to acknowledge these continually repeated</td><td> </td><td class="right">   counters.  There is no need to acknowledge these continually repeated</td><td class="lineno"><br></td></tr>
      <tr id="diff0022"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   counters, so the congestion window reduced (CWR) mechanism is no</td><td> </td><td class="rblock">   counters, so the congestion window reduced (CWR) mechanism <span class="insert">of</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   longer used.  Even if some ACKs are lost, the Data Sender ought to be</td><td> </td><td class="rblock"><span class="insert">   [RFC3168]</span> is no longer used.  Even if some ACKs are lost, the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   able to infer how much to increment its own counters, even if the</td><td> </td><td class="rblock">   Sender ought to be able to infer how much to increment its own</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   protocol field has wrapped.</td><td> </td><td class="rblock">   counters, even if the protocol field has wrapped.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The 3-bit ACE field can wrap fairly frequently.  Therefore, even if</td><td> </td><td class="right">   The 3-bit ACE field can wrap fairly frequently.  Therefore, even if</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it appears to have incremented by one (say), the field might have</td><td> </td><td class="right">   it appears to have incremented by one (say), the field might have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   actually cycled completely then incremented by one.  The Data</td><td> </td><td class="right">   actually cycled completely then incremented by one.  The Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Receiver is not allowed to delay sending an ACK to such an extent</td><td> </td><td class="right">   Receiver is not allowed to delay sending an ACK to such an extent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that the ACE field would cycle.  However ACKs received at the Data</td><td> </td><td class="right">   that the ACE field would cycle.  However ACKs received at the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Sender could still cycle because a whole sequence of ACKs carrying</td><td> </td><td class="right">   Sender could still cycle because a whole sequence of ACKs carrying</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   intervening values of the field might all be lost or delayed in</td><td> </td><td class="right">   intervening values of the field might all be lost or delayed in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   transit.</td><td> </td><td class="right">   transit.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-8" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-8"><em> page 11, line 42<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-8"><em> page 11, line 35<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The CE packet counter in the ACE field and the CE byte counter in</td><td> </td><td class="right">   The CE packet counter in the ACE field and the CE byte counter in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN Options both provide feedback on received CE-marks.  The CE</td><td> </td><td class="right">   AccECN Options both provide feedback on received CE-marks.  The CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packet counter includes control packets that do not have payload</td><td> </td><td class="right">   packet counter includes control packets that do not have payload</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   data, while the CE byte counter solely includes marked payload bytes.</td><td> </td><td class="right">   data, while the CE byte counter solely includes marked payload bytes.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If both are present, the byte counter in an AccECN Option will</td><td> </td><td class="right">   If both are present, the byte counter in an AccECN Option will</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   provide the more accurate information needed for modern congestion</td><td> </td><td class="right">   provide the more accurate information needed for modern congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   control and policing schemes, such as L4S, DCTCP or ConEx.  If AccECN</td><td> </td><td class="right">   control and policing schemes, such as L4S, DCTCP or ConEx.  If AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Options are stripped, a simple algorithm to estimate the number of</td><td> </td><td class="right">   Options are stripped, a simple algorithm to estimate the number of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   marked bytes from the ACE field is given in Appendix A.3.</td><td> </td><td class="right">   marked bytes from the ACE field is given in Appendix A.3.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0023"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">The AccECN design has been generalized so that it ought to be able to</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   support possible future uses of the experimental ECT(1) codepoint</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   other than the L4S experiment [RFC9330], such as a lower severity or</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   a more instant congestion signal than CE.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Feedback in bytes is provided to protect against the receiver or a</td><td> </td><td class="right">   Feedback in bytes is provided to protect against the receiver or a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   middlebox using attacks similar to 'ACK-Division' to artificially</td><td> </td><td class="right">   middlebox using attacks similar to 'ACK-Division' to artificially</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   inflate the congestion window, which is why [RFC5681] now recommends</td><td> </td><td class="right">   inflate the congestion window, which is why [RFC5681] now recommends</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that TCP counts acknowledged bytes not packets.</td><td> </td><td class="right">   that TCP counts acknowledged bytes not packets.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">2.5.  Generic (Mechanistic) Reflector</td><td> </td><td class="right">2.5.  Generic (Mechanistic) Reflector</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The ACE field provides feedback about CE markings in the IP-ECN field</td><td> </td><td class="right">   The ACE field provides feedback about CE markings in the IP-ECN field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of both data and control packets.  According to [RFC3168] the Data</td><td> </td><td class="right">   of both data and control packets.  According to [RFC3168] the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Sender is meant to set the IP-ECN field of control packets to Not-</td><td> </td><td class="right">   Sender is meant to set the IP-ECN field of control packets to Not-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-9" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-9"><em> page 12, line 23<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-9"><em> page 12, line 14<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   For this reason, AccECN is designed to be a generic reflector of</td><td> </td><td class="right">   For this reason, AccECN is designed to be a generic reflector of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whatever ECN markings it sees, whether or not they are compliant with</td><td> </td><td class="right">   whatever ECN markings it sees, whether or not they are compliant with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   a current standard.  Then as standards evolve, Data Senders can</td><td> </td><td class="right">   a current standard.  Then as standards evolve, Data Senders can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   upgrade unilaterally without any need for receivers to upgrade too.</td><td> </td><td class="right">   upgrade unilaterally without any need for receivers to upgrade too.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   It is also useful to be able to rely on generic reflection behaviour</td><td> </td><td class="right">   It is also useful to be able to rely on generic reflection behaviour</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   when senders need to test for unexpected interference with markings</td><td> </td><td class="right">   when senders need to test for unexpected interference with markings</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (for instance Section 3.2.2.3, Section 3.2.2.4 and Section 3.2.3.2 of</td><td> </td><td class="right">   (for instance Section 3.2.2.3, Section 3.2.2.4 and Section 3.2.3.2 of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the present document and paragraph 2 of Section 20.2 of [RFC3168]).</td><td> </td><td class="right">   the present document and paragraph 2 of Section 20.2 of [RFC3168]).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0024"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The initial SYN <span class="delete">is</span> the most critical control <span class="delete">packet,</span> so AccECN</td><td> </td><td class="rblock">   The initial SYN <span class="insert">and SYN/ACK are</span> the most critical control <span class="insert">packets,</span> so</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">provides feedback on its</span> IP-ECN <span class="delete">field.</span>  Although RFC 3168 prohibits</td><td> </td><td class="rblock">   AccECN <span class="insert">feeds back their</span> IP-ECN <span class="insert">fields.</span>  Although RFC 3168 prohibits</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">an</span> ECN-capable <span class="delete">SYN,</span> providing feedback of ECN marking on the SYN</td><td> </td><td class="rblock">   ECN-capable <span class="insert">SYNs and SYN/ACKs,</span> providing feedback of ECN marking on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   supports future scenarios in which SYNs might be ECN-enabled (without</td><td> </td><td class="rblock">   the SYN <span class="insert">and SYN/ACK</span> supports future scenarios in which SYNs might be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   prejudging whether they ought to be).  For instance, [RFC8311]</td><td> </td><td class="rblock">   ECN-enabled (without prejudging whether they ought to be).  For</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   updates this aspect of RFC 3168 to allow experimentation with <span class="delete">ECN-</span></td><td> </td><td class="rblock">   instance, [RFC8311] updates this aspect of RFC 3168 to allow</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   capable</span> TCP control packets.</td><td> </td><td class="rblock">   experimentation with <span class="insert">ECN-capable</span> TCP control packets.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Even if the TCP Client (or Server) has set the SYN (or SYN/ACK) to</td><td> </td><td class="right">   Even if the TCP Client (or Server) has set the SYN (or SYN/ACK) to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   not-ECT in compliance with RFC 3168, feedback on the state of the IP-</td><td> </td><td class="right">   not-ECT in compliance with RFC 3168, feedback on the state of the IP-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN field when it arrives at the receiver could still be useful,</td><td> </td><td class="right">   ECN field when it arrives at the receiver could still be useful,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   because middleboxes have been known to overwrite the IP-ECN field as</td><td> </td><td class="right">   because middleboxes have been known to overwrite the IP-ECN field as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   if it is still part of the old Type of Service (ToS) field</td><td> </td><td class="right">   if it is still part of the old Type of Service (ToS) field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [Mandalari18].  For example, if a TCP Client has set the SYN to Not-</td><td> </td><td class="right">   [Mandalari18].  For example, if a TCP Client has set the SYN to Not-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECT, but receives feedback that the IP-ECN field on the SYN arrived</td><td> </td><td class="right">   ECT, but receives feedback that the IP-ECN field on the SYN arrived</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with a different codepoint, it can detect such middlebox</td><td> </td><td class="right">   with a different codepoint, it can detect such middlebox</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   interference.  Previously, neither end knew what IP-ECN field the</td><td> </td><td class="right">   interference.  Previously, neither end knew what IP-ECN field the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   other had sent.  So, if a TCP Server received ECT or CE on a SYN, it</td><td> </td><td class="right">   other had sent.  So, if a TCP Server received ECT or CE on a SYN, it</td><td class="lineno"><br></td></tr>
      <tr id="diff0025"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   could not know whether it was invalid <span class="delete">(or valid)</span> because only the TCP</td><td> </td><td class="rblock">   could not know whether it was invalid because only the TCP Client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Client knew whether it originally marked the SYN as Not-ECT (or ECT).</td><td> </td><td class="rblock">   knew whether it originally marked the SYN as Not-ECT (or ECT).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Therefore, prior to AccECN, the <span class="delete">server's</span> only safe course of action</td><td> </td><td class="rblock">   Therefore, prior to AccECN, the <span class="insert">Server's</span> only safe course of action</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in this example was to disable ECN for the connection.  Instead, the</td><td> </td><td class="right">   in this example was to disable ECN for the connection.  Instead, the</td><td class="lineno"><br></td></tr>
      <tr id="diff0026"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN protocol allows the <span class="delete">server</span> to feed back the <span class="delete">received</span> ECN field</td><td> </td><td class="rblock">   AccECN protocol allows the <span class="insert">Server and Client</span> to feed back the ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">to</span> the <span class="delete">client,</span> which then has all the information to decide whether</td><td> </td><td class="rblock">   field <span class="insert">received on</span> the <span class="insert">SYN and SYN/ACK to their peer,</span> which then has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the connection has to fall-back from supporting ECN (or not).</td><td> </td><td class="rblock">   all the information to decide whether the connection has to fall-back</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   from supporting ECN (or not).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.  AccECN Protocol Specification</td><td> </td><td class="right">3.  AccECN Protocol Specification</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.  Negotiating to use AccECN</td><td> </td><td class="right">3.1.  Negotiating to use AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.1.  Negotiation during the TCP handshake</td><td> </td><td class="right">3.1.1.  Negotiation during the TCP handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Given the ECN Nonce [RFC3540] has been reclassified as historic</td><td> </td><td class="right">   Given the ECN Nonce [RFC3540] has been reclassified as historic</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC8311], the TCP flag that was previously called NS (Nonce Sum) is</td><td> </td><td class="right">   [RFC8311], the TCP flag that was previously called NS (Nonce Sum) is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   renamed as the AE (Accurate ECN) flag (the TCP header flag at bit</td><td> </td><td class="right">   renamed as the AE (Accurate ECN) flag (the TCP header flag at bit</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   offset 7 in Figure 2).  See the IANA Considerations in Section 7.</td><td> </td><td class="right">   offset 7 in Figure 2).  See the IANA Considerations in Section 7.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td> </td><td class="right">       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           | A | C | E | U | A | P | R | S | F |</td><td> </td><td class="right">     |               |           | A | C | E | U | A | P | R | S | F |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     | Header Length | Reserved  | E | W | C | R | C | S | S | Y | I |</td><td> </td><td class="right">     | Header Length | Reserved  | E | W | C | R | C | S | S | Y | I |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     |               |           |   | R | E | G | K | H | T | N | N |</td><td> </td><td class="right">     |               |           |   | R | E | G | K | H | T | N | N |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td> </td><td class="right">     +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0027"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       Figure 2: The <span class="delete">(post-AccECN)</span> definition of the TCP header flags</td><td> </td><td class="rblock">      Figure 2: The <span class="insert">new</span> definition of the TCP header flags during the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                          during the TCP handshake</td><td> </td><td class="rblock">                               TCP handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   During the TCP handshake at the start of a connection, to request</td><td> </td><td class="right">   During the TCP handshake at the start of a connection, to request</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   more accurate ECN feedback the TCP Client (host A) MUST set the TCP</td><td> </td><td class="right">   more accurate ECN feedback the TCP Client (host A) MUST set the TCP</td><td class="lineno"><br></td></tr>
      <tr id="diff0028"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flags <span class="delete">AE=1, CWR=1 and ECE=1</span> in the initial SYN segment.</td><td> </td><td class="rblock">   flags <span class="insert">(AE,CWR,ECE) = (1,1,1)</span> in the initial SYN segment.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If a TCP Server (B) that is AccECN-enabled receives a SYN with the</td><td> </td><td class="right">   If a TCP Server (B) that is AccECN-enabled receives a SYN with the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   above three flags set, it MUST set both its half connections into</td><td> </td><td class="right">   above three flags set, it MUST set both its half connections into</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN mode.  Then it MUST set the AE, CWR and ECE TCP flags on the</td><td> </td><td class="right">   AccECN mode.  Then it MUST set the AE, CWR and ECE TCP flags on the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN/ACK to the combination in the top block of Table 2 that feeds</td><td> </td><td class="right">   SYN/ACK to the combination in the top block of Table 2 that feeds</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   back the IP-ECN field that arrived on the SYN.  This applies whether</td><td> </td><td class="right">   back the IP-ECN field that arrived on the SYN.  This applies whether</td><td class="lineno"><br></td></tr>
      <tr id="diff0029"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   or not the <span class="delete">s</span>erver itself supports setting the IP-ECN field on a SYN</td><td> </td><td class="rblock">   or not the <span class="insert">S</span>erver itself supports setting the IP-ECN field on a SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   or SYN/ACK (see Section 2.5 for rationale).</td><td> </td><td class="right">   or SYN/ACK (see Section 2.5 for rationale).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When the TCP Server returns any of the 4 combinations in the top</td><td> </td><td class="right">   When the TCP Server returns any of the 4 combinations in the top</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   block of Table 2, it confirms that it supports AccECN.  The TCP</td><td> </td><td class="right">   block of Table 2, it confirms that it supports AccECN.  The TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Server MUST NOT set one of these 4 combination of flags on the SYN/</td><td> </td><td class="right">   Server MUST NOT set one of these 4 combination of flags on the SYN/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK unless the preceding SYN requested support for AccECN as above.</td><td> </td><td class="right">   ACK unless the preceding SYN requested support for AccECN as above.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Once a TCP Client (A) has sent the above SYN to declare that it</td><td> </td><td class="right">   Once a TCP Client (A) has sent the above SYN to declare that it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   supports AccECN, and once it has received the above SYN/ACK segment</td><td> </td><td class="right">   supports AccECN, and once it has received the above SYN/ACK segment</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that confirms that the TCP Server supports AccECN, the TCP Client</td><td> </td><td class="right">   that confirms that the TCP Server supports AccECN, the TCP Client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   MUST set both its half connections into AccECN mode.</td><td> </td><td class="right">   MUST set both its half connections into AccECN mode.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Once in AccECN mode, a TCP Client or Server has the rights and</td><td> </td><td class="right">   Once in AccECN mode, a TCP Client or Server has the rights and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   obligations to participate in the ECN protocol defined in</td><td> </td><td class="right">   obligations to participate in the ECN protocol defined in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.1.5.</td><td> </td><td class="right">   Section 3.1.5.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The procedure for the TCP Client to follow if a SYN/ACK does not</td><td> </td><td class="right">   The procedure for the TCP Client to follow if a SYN/ACK does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   arrive before its retransmission timer expires is given in</td><td> </td><td class="right">   arrive before its retransmission timer expires is given in</td><td class="lineno"><br></td></tr>
      <tr id="diff0030"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section 3.1.4.  <span class="delete">If more than one SYN arrives at the TCP Server (B),</span></td><td> </td><td class="rblock">   Section 3.1.4.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   the above requirement to set the TCP flags on the SYN/ACK MUST feed</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   back the IP-ECN field on the latest SYN to arrive.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.2.  Backward Compatibility</td><td> </td><td class="right">3.1.2.  Backward Compatibility</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The three flags set to 1 to indicate AccECN support on the SYN have</td><td> </td><td class="right">   The three flags set to 1 to indicate AccECN support on the SYN have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   been carefully chosen to enable natural fall-back to prior stages in</td><td> </td><td class="right">   been carefully chosen to enable natural fall-back to prior stages in</td><td class="lineno"><br></td></tr>
      <tr id="diff0031"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the evolution of <span class="delete">ECN, as above.</span>  Table 2 tabulates all the</td><td> </td><td class="rblock">   the evolution of <span class="insert">ECN.</span>  Table 2 tabulates all the negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   negotiation possibilities for ECN-related capabilities that involve</td><td> </td><td class="rblock">   possibilities for ECN-related capabilities that involve at least one</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   at least one AccECN-capable host.  The entries in the first two</td><td> </td><td class="rblock">   AccECN-capable host.  The entries in the first two columns have been</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   columns have been abbreviated, as follows:</td><td> </td><td class="rblock">   abbreviated, as follows:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0032"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN:  <span class="delete">More</span> Accurate ECN Feedback (the present specification)</td><td> </td><td class="rblock">   AccECN:  <span class="insert">Supports more</span> Accurate ECN Feedback (the present</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">       specification)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0033"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Nonce:  ECN Nonce feedback [RFC3540]</td><td> </td><td class="rblock">   Nonce:  <span class="insert">Supports </span>ECN Nonce feedback [RFC3540]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0034"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN:  'Classic' ECN feedback [RFC3168]</td><td> </td><td class="rblock">   ECN:  <span class="insert">Supports </span>'Classic' ECN feedback [RFC3168]</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0035"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   No ECN:  Not<span class="delete">-</span>ECN-capable.  Implicit congestion notification using</td><td> </td><td class="rblock">   No ECN:  Not<span class="insert"> </span>ECN-capable.  Implicit congestion notification using</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       packet drop.</td><td> </td><td class="right">       packet drop.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +========+========+============+============+======================+</td><td> </td><td class="right">   +========+========+============+============+======================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | A      | B      |    SYN     |  SYN/ACK   | Feedback Mode        |</td><td> </td><td class="right">   | A      | B      |    SYN     |  SYN/ACK   | Feedback Mode        |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   |        |        |    A-&gt;B    |    B-&gt;A    |                      |</td><td> </td><td class="right">   |        |        |    A-&gt;B    |    B-&gt;A    |                      |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   |        |        | AE CWR ECE | AE CWR ECE |                      |</td><td> </td><td class="right">   |        |        | AE CWR ECE | AE CWR ECE |                      |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +========+========+============+============+======================+</td><td> </td><td class="right">   +========+========+============+============+======================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | AccECN | 1   1   1  | 0   1   0  | AccECN (Not-ECT SYN) |</td><td> </td><td class="right">   | AccECN | AccECN | 1   1   1  | 0   1   0  | AccECN (Not-ECT SYN) |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | AccECN | 1   1   1  | 0   1   1  | AccECN (ECT1 on SYN) |</td><td> </td><td class="right">   | AccECN | AccECN | 1   1   1  | 0   1   1  | AccECN (ECT1 on SYN) |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | AccECN | 1   1   1  | 1   0   0  | AccECN (ECT0 on SYN) |</td><td> </td><td class="right">   | AccECN | AccECN | 1   1   1  | 1   0   0  | AccECN (ECT0 on SYN) |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | AccECN | 1   1   1  | 1   1   0  | AccECN (CE on SYN)   |</td><td> </td><td class="right">   | AccECN | AccECN | 1   1   1  | 1   1   0  | AccECN (CE on SYN)   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | Nonce  | 1   1   1  | 1   0   1  | (Reserved)           |</td><td> </td><td class="right">   | AccECN | Nonce  | 1   1   1  | 1   0   1  | (Reserved)           |</td><td class="lineno"><br></td></tr>
      <tr id="diff0036"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   | AccECN | ECN    | 1   1   1  | 0   0   1  | <span class="delete">c</span>lassic ECN          |</td><td> </td><td class="rblock">   | AccECN | ECN    | 1   1   1  | 0   0   1  | <span class="insert">C</span>lassic ECN          |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | No ECN | 1   1   1  | 0   0   0  | Not ECN              |</td><td> </td><td class="right">   | AccECN | No ECN | 1   1   1  | 0   0   0  | Not ECN              |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr id="diff0037"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   | Nonce  | AccECN | 0   1   1  | 0   0   1  | <span class="delete">classic</span> ECN          |</td><td> </td><td class="rblock">   | Nonce  | AccECN | 0   1   1  | 0   0   1  | <span class="insert">Classic</span> ECN          |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   | ECN    | AccECN | 0   1   1  | 0   0   1  | <span class="delete">classic</span> ECN          |</td><td> </td><td class="rblock">   | ECN    | AccECN | 0   1   1  | 0   0   1  | <span class="insert">Classic</span> ECN          |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | No ECN | AccECN | 0   0   0  | 0   0   0  | Not ECN              |</td><td> </td><td class="right">   | No ECN | AccECN | 0   0   0  | 0   0   0  | Not ECN              |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | AccECN | Broken | 1   1   1  | 1   1   1  | Not ECN              |</td><td> </td><td class="right">   | AccECN | Broken | 1   1   1  | 1   1   1  | Not ECN              |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +--------+--------+------------+------------+----------------------+</td><td> </td><td class="right">   +--------+--------+------------+------------+----------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        Table 2: ECN capability negotiation between Client (A) and</td><td> </td><td class="right">        Table 2: ECN capability negotiation between Client (A) and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">                                Server (B)</td><td> </td><td class="right">                                Server (B)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Table 2 is divided into blocks each separated by an empty row.</td><td> </td><td class="right">   Table 2 is divided into blocks each separated by an empty row.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-10" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-10"><em> page 15, line 44<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-10"><em> page 15, line 5<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   1.  The top block shows the case already described in Section 3.1</td><td> </td><td class="right">   1.  The top block shows the case already described in Section 3.1</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       where both endpoints support AccECN and how the TCP Server (B)</td><td> </td><td class="right">       where both endpoints support AccECN and how the TCP Server (B)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       indicates congestion feedback.</td><td> </td><td class="right">       indicates congestion feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   2.  The second block shows the cases where the TCP Client (A)</td><td> </td><td class="right">   2.  The second block shows the cases where the TCP Client (A)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       supports AccECN but the TCP Server (B) supports some earlier</td><td> </td><td class="right">       supports AccECN but the TCP Server (B) supports some earlier</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       variant of TCP feedback, indicated in its SYN/ACK.  Therefore, as</td><td> </td><td class="right">       variant of TCP feedback, indicated in its SYN/ACK.  Therefore, as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       soon as an AccECN-capable TCP Client (A) receives the SYN/ACK</td><td> </td><td class="right">       soon as an AccECN-capable TCP Client (A) receives the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       shown it MUST set both its half connections into the feedback</td><td> </td><td class="right">       shown it MUST set both its half connections into the feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       mode shown in the rightmost column.  If the TCP Client has set</td><td> </td><td class="right">       mode shown in the rightmost column.  If the TCP Client has set</td><td class="lineno"><br></td></tr>
      <tr id="diff0038"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       itself into <span class="delete">c</span>lassic ECN feedback mode it MUST then comply with</td><td> </td><td class="rblock">       itself into <span class="insert">C</span>lassic ECN feedback mode it MUST then comply with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       [RFC3168].</td><td> </td><td class="right">       [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0039"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       <span class="delete">The server response called 'Nonce' in the table is now historic.</span></td><td> </td><td class="rblock">       <span class="insert">An</span> AccECN <span class="insert">implementation has</span> no need to recognize or support <span class="insert">the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">       For an</span> AccECN <span class="delete">implementation, there is</span> no need to recognize or</td><td> </td><td class="rblock"><span class="insert">       Server response labelled 'Nonce' or</span> ECN Nonce feedback <span class="insert">more</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       support ECN Nonce feedback [RFC3540], which has been reclassified</td><td> </td><td class="rblock"><span class="insert">       generally</span> [RFC3540], which has been reclassified as historic</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       as historic [RFC8311].  AccECN is compatible with alternative ECN</td><td> </td><td class="rblock">       [RFC8311].  AccECN is compatible with alternative ECN feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       feedback integrity approaches (see Section 5.3).</td><td> </td><td class="rblock">       integrity approaches (see Section 5.3).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   3.  The third block shows the cases where the TCP Server (B) supports</td><td> </td><td class="right">   3.  The third block shows the cases where the TCP Server (B) supports</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       AccECN but the TCP Client (A) supports some earlier variant of</td><td> </td><td class="right">       AccECN but the TCP Client (A) supports some earlier variant of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       TCP feedback, indicated in its SYN.</td><td> </td><td class="right">       TCP feedback, indicated in its SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       When an AccECN-enabled TCP Server (B) receives a SYN with</td><td> </td><td class="right">       When an AccECN-enabled TCP Server (B) receives a SYN with</td><td class="lineno"><br></td></tr>
      <tr id="diff0040"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       <span class="delete">AE,CWR,ECE = 0,1,1</span> it MUST do one of the following:</td><td> </td><td class="rblock">       <span class="insert">(AE,CWR,ECE) = (0,1,1)</span> it MUST do one of the following:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0041"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       *  set both its half connections into the <span class="delete">classic</span> ECN feedback</td><td> </td><td class="rblock">       *  set both its half connections into the <span class="insert">Classic</span> ECN feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">          mode and return a SYN/ACK with <span class="delete">AE, CWR, ECE</span> = <span class="delete">0,0,1</span> as shown.</td><td> </td><td class="rblock">          mode and return a SYN/ACK with <span class="insert">(AE,CWR,ECE)</span> = <span class="insert">(0,0,1)</span> as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">          Then it MUST comply with [RFC3168].</td><td> </td><td class="rblock">          shown.  Then it MUST comply with [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0042"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       *  set both its half-connections into <span class="delete">No</span> ECN mode and return a</td><td> </td><td class="rblock">       *  set both its half-connections into <span class="insert">Not</span> ECN mode and return a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">          SYN/ACK with <span class="delete">AE,CWR,ECE</span> = <span class="delete">0,0,0,</span> then continue with ECN</td><td> </td><td class="rblock">          SYN/ACK with <span class="insert">(AE,CWR,ECE)</span> = <span class="insert">(0,0,0),</span> then continue with ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          disabled.  This latter case is unlikely to be desirable, but</td><td> </td><td class="right">          disabled.  This latter case is unlikely to be desirable, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          it is allowed as a possibility, e.g. for minimal TCP</td><td> </td><td class="right">          it is allowed as a possibility, e.g. for minimal TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">          implementations.</td><td> </td><td class="right">          implementations.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       When an AccECN-enabled TCP Server (B) receives a SYN with</td><td> </td><td class="right">       When an AccECN-enabled TCP Server (B) receives a SYN with</td><td class="lineno"><br></td></tr>
      <tr id="diff0043"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       <span class="delete">AE,CWR,ECE</span> = <span class="delete">0,0,0</span> it MUST set both its half connections into the</td><td> </td><td class="rblock">       <span class="insert">(AE,CWR,ECE)</span> = <span class="insert">(0,0,0)</span> it MUST set both its half connections into</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       Not ECN feedback mode, return a SYN/ACK with <span class="delete">AE,CWR,ECE</span> = <span class="delete">0,0,0</span></td><td> </td><td class="rblock">       the Not ECN feedback mode, return a SYN/ACK with <span class="insert">(AE,CWR,ECE)</span> =</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       as shown and continue with ECN disabled.</td><td> </td><td class="rblock">       <span class="insert">(0,0,0)</span> as shown and continue with ECN disabled.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   4.  The fourth block displays a combination labelled `Broken'.  Some</td><td> </td><td class="right">   4.  The fourth block displays a combination labelled `Broken'.  Some</td><td class="lineno"><br></td></tr>
      <tr id="diff0044"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">       older TCP <span class="delete">server implementations incorrectly set the reserved</span></td><td> </td><td class="rblock">       older TCP <span class="insert">Server implementations incorrectly set the TCP-ECN</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       flags in the SYN/ACK by reflecting those in the SYN.  Such broken</td><td> </td><td class="right">       flags in the SYN/ACK by reflecting those in the SYN.  Such broken</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       TCP Servers (B) cannot support ECN, so as soon as an AccECN-</td><td> </td><td class="right">       TCP Servers (B) cannot support ECN, so as soon as an AccECN-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       capable TCP Client (A) receives such a broken SYN/ACK it MUST</td><td> </td><td class="right">       capable TCP Client (A) receives such a broken SYN/ACK it MUST</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       fall back to Not ECN mode for both its half connections and</td><td> </td><td class="right">       fall back to Not ECN mode for both its half connections and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">       continue with ECN disabled.</td><td> </td><td class="right">       continue with ECN disabled.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The following additional rules do not fit the structure of the table,</td><td> </td><td class="right">   The following additional rules do not fit the structure of the table,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   but they complement it:</td><td> </td><td class="right">   but they complement it:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Simultaneous Open:  An originating AccECN Host (A), having sent a SYN</td><td> </td><td class="right">   Simultaneous Open:  An originating AccECN Host (A), having sent a SYN</td><td class="lineno"><br></td></tr>
      <tr id="diff0045"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      with <span class="delete">AE=1, CWR=1 and ECE=1,</span> might receive another SYN from host B.</td><td> </td><td class="rblock">      with <span class="insert">(AE,CWR,ECE) = (1,1,1),</span> might receive another SYN from host</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Host A MUST then enter the same feedback mode as it would have</td><td> </td><td class="rblock">      B.  Host A MUST then enter the same feedback mode as it would have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      entered had it been a responding host and received the same SYN.</td><td> </td><td class="right">      entered had it been a responding host and received the same SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Then host A MUST send the same SYN/ACK as it would have sent had</td><td> </td><td class="right">      Then host A MUST send the same SYN/ACK as it would have sent had</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      it been a responding host.</td><td> </td><td class="right">      it been a responding host.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   In-window SYN during TIME-WAIT:  Many TCP implementations create a</td><td> </td><td class="right">   In-window SYN during TIME-WAIT:  Many TCP implementations create a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      new TCP connection if they receive an in-window SYN packet during</td><td> </td><td class="right">      new TCP connection if they receive an in-window SYN packet during</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      TIME-WAIT state.  When a TCP host enters TIME-WAIT or CLOSED</td><td> </td><td class="right">      TIME-WAIT state.  When a TCP host enters TIME-WAIT or CLOSED</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      state, it ought to ignore any previous state about the negotiation</td><td> </td><td class="right">      state, it ought to ignore any previous state about the negotiation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      of AccECN for that connection and renegotiate the feedback mode</td><td> </td><td class="right">      of AccECN for that connection and renegotiate the feedback mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      according to Table 2.</td><td> </td><td class="right">      according to Table 2.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.3.  Forward Compatibility</td><td> </td><td class="right">3.1.3.  Forward Compatibility</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If a TCP Server that implements AccECN receives a SYN with the three</td><td> </td><td class="right">   If a TCP Server that implements AccECN receives a SYN with the three</td><td class="lineno"><br></td></tr>
      <tr id="diff0046"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   TCP header flags <span class="delete">(AE, CWR and ECE)</span> set to any combination other than</td><td> </td><td class="rblock">   TCP header flags <span class="insert">(AE,CWR,ECE)</span> set to any combination other than</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">000, 011</span> or <span class="delete">111</span> and it does not have logic specific to such a</td><td> </td><td class="rblock">   <span class="insert">(0,0,0), (0,1,1)</span> or <span class="insert">(1,1,1)</span> and it does not have logic specific to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   combination, it MUST negotiate the use of AccECN as if the three</td><td> </td><td class="rblock">   such a combination, it MUST negotiate the use of AccECN as if the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   flags had been set to <span class="delete">111.</span>  This ensures that future uses of the</td><td> </td><td class="rblock">   three flags had been set to <span class="insert">(1,1,1).</span>  This ensures that future uses</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   other combinations on a SYN can rely on consistent behaviour from the</td><td> </td><td class="rblock">   of the other combinations on a SYN can rely on consistent behaviour</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   installed base of AccECN <span class="delete">servers.</span>  See Appendix B.3 for related</td><td> </td><td class="rblock">   from the installed base of AccECN <span class="insert">Servers.</span>  See Appendix B.3 for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   discussion.</td><td> </td><td class="rblock">   related discussion.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      |  For the avoidance of doubt, the behaviour described in the</td><td> </td><td class="right">      |  For the avoidance of doubt, the behaviour described in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      |  present specification applies whether or not the three</td><td> </td><td class="right">      |  present specification applies whether or not the three</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      |  remaining reserved TCP header flags are zero.</td><td> </td><td class="right">      |  remaining reserved TCP header flags are zero.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0047"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">3.1.4.  Retransmi<span class="delete">ssion of the SYN</span></td><td> </td><td class="rblock">3.1.4.  Retransmi<span class="insert">tted SYNs</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0048"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If the sender of an AccECN SYN times out before receiving the <span class="delete">SYN/</span></td><td> </td><td class="rblock">   If the sender of an AccECN SYN <span class="insert">(the TCP Client)</span> times out before</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   ACK, the sender</span> SHOULD attempt to negotiate the use of AccECN at</td><td> </td><td class="rblock">   receiving the <span class="insert">SYN/ACK, it</span> SHOULD attempt to negotiate the use of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   least one more time by continuing to set all three TCP ECN flags on</td><td> </td><td class="rblock">   AccECN at least one more time by continuing to set all three TCP ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the first retransmitted SYN (using the usual retransmission <span class="delete">time-</span></td><td> </td><td class="rblock">   flags <span class="insert">(AE,CWR,ECE) = (1,1,1)</span> on the first retransmitted SYN (using</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   outs).</span>  If this first retransmission also fails to be acknowledged,</td><td> </td><td class="rblock">   the usual retransmission <span class="insert">time-outs).</span>  If this first retransmission</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the <span class="delete">sender</span> SHOULD send subsequent retransmissions of the SYN with the</td><td> </td><td class="rblock">   also fails to be acknowledged, the <span class="insert">TCP Client</span> SHOULD send subsequent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   three TCP-ECN flags cleared <span class="delete">(AE=CWR=ECE=0).  A</span> retransmitted SYN MUST</td><td> </td><td class="rblock">   retransmissions of the SYN with the three TCP-ECN flags cleared</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   use the same ISN as the original SYN.</td><td> </td><td class="rblock">   <span class="insert">(AE,CWR,ECE) = (0,0,0).  Such a</span> retransmitted SYN MUST use the same</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   ISN as the original SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Retrying once before fall-back adds delay in the case where a</td><td> </td><td class="right">   Retrying once before fall-back adds delay in the case where a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   middlebox drops an AccECN (or ECN) SYN deliberately.  However,</td><td> </td><td class="right">   middlebox drops an AccECN (or ECN) SYN deliberately.  However,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   current measurements imply that a drop is less likely to be due to</td><td> </td><td class="right">   current measurements imply that a drop is less likely to be due to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   middlebox interference than other intermittent causes of loss,</td><td> </td><td class="right">   middlebox interference than other intermittent causes of loss,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   e.g. congestion, wireless transmission loss, etc.</td><td> </td><td class="right">   e.g. congestion, wireless transmission loss, etc.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Implementers MAY use other fall-back strategies if they are found to</td><td> </td><td class="right">   Implementers MAY use other fall-back strategies if they are found to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   be more effective (e.g. attempting to negotiate AccECN on the SYN</td><td> </td><td class="right">   be more effective (e.g. attempting to negotiate AccECN on the SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   only once or more than twice (most appropriate during high levels of</td><td> </td><td class="right">   only once or more than twice (most appropriate during high levels of</td><td class="lineno"><br></td></tr>
      <tr id="diff0049"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   congestion).  <span class="delete">However, other fall-back strategies will need to follow</span></td><td> </td><td class="rblock">   congestion).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   all the rules in Section 3.1.5, which concern behaviour when SYNs or</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   SYN/ACKs negotiating different types of feedback have been sent</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   within the same connection.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Further it might make sense to also remove any other new or</td><td> </td><td class="right">   Further it might make sense to also remove any other new or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   experimental fields or options on the SYN in case a middlebox might</td><td> </td><td class="right">   experimental fields or options on the SYN in case a middlebox might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   be blocking them, although the required behaviour will depend on the</td><td> </td><td class="right">   be blocking them, although the required behaviour will depend on the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specification of the other option(s) and any attempt to co-ordinate</td><td> </td><td class="right">   specification of the other option(s) and any attempt to co-ordinate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   fall-back between different modules of the stack.</td><td> </td><td class="right">   fall-back between different modules of the stack.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Whichever fall-back strategy is used, the TCP initiator SHOULD cache</td><td> </td><td class="right">   Whichever fall-back strategy is used, the TCP initiator SHOULD cache</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   failed connection attempts.  If it does, it SHOULD NOT give up</td><td> </td><td class="right">   failed connection attempts.  If it does, it SHOULD NOT give up</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   attempting to negotiate AccECN on the SYN of subsequent connection</td><td> </td><td class="right">   attempting to negotiate AccECN on the SYN of subsequent connection</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   attempts until it is clear that the blockage is persistently and</td><td> </td><td class="right">   attempts until it is clear that the blockage is persistently and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specifically due to AccECN.  The cache needs to be arranged to expire</td><td> </td><td class="right">   specifically due to AccECN.  The cache needs to be arranged to expire</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   so that the initiator will infrequently attempt to check whether the</td><td> </td><td class="right">   so that the initiator will infrequently attempt to check whether the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   problem has been resolved.</td><td> </td><td class="right">   problem has been resolved.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0050"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">The</span> fall-back <span class="delete">procedure if the TCP Server receives no ACK to</span></td><td> </td><td class="rblock">   <span class="insert">All</span> fall-back <span class="insert">strategies will need</span> to <span class="insert">follow all the normative rules</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   acknowledge a SYN/ACK that tried</span> to <span class="delete">negotiate AccECN is specified</span> in</td><td> </td><td class="rblock">   in Section <span class="insert">3.1.5, which concern behaviour when SYNs or SYN/ACKs</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section <span class="delete">3.2.3.2.</span></td><td> </td><td class="rblock"><span class="insert">   negotiating different types of feedback have been sent within the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   same connection.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.1.5.  Implications of AccECN Mode</td><td> </td><td class="right">3.1.5.  Implications of AccECN Mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.1.1 describes the only ways that a host can enter AccECN</td><td> </td><td class="right">   Section 3.1.1 describes the only ways that a host can enter AccECN</td><td class="lineno"><br></td></tr>
      <tr id="diff0051"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   mode, whether as a <span class="delete">client or as a s</span>erver.</td><td> </td><td class="rblock">   mode, whether as a <span class="insert">Client or as a S</span>erver.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A host in AccECN mode has the rights and obligations concerning the</td><td> </td><td class="right">   A host in AccECN mode has the rights and obligations concerning the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   use of ECN defined below, which build on those in [RFC3168] as</td><td> </td><td class="right">   use of ECN defined below, which build on those in [RFC3168] as</td><td class="lineno"><br></td></tr>
      <tr id="diff0052"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   updated by [RFC8311].</td><td> </td><td class="rblock">   updated by [RFC8311].  <span class="insert">This section uses the following definition:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   Valid SYN:  A SYN that has the same port numbers and the same ISN as</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">      the SYN that caused the Server to enter AccECN mode.  An</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">      'Acceptable' packet is defined in Section 1.3.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Switching feedback negotiation (e.g. fall-back):</td><td> </td><td class="right">   Switching feedback negotiation (e.g. fall-back):</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  A host in AccECN mode:</td><td> </td><td class="right">   *  A host in AccECN mode:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0053"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  MUST NOT <span class="delete">send an ECN-setup SYN [RFC3168] and</span> a <span class="delete">SYN requesting</span></td><td> </td><td class="rblock">      -  MUST NOT <span class="insert">switch into</span> a <span class="insert">different</span> feedback <span class="insert">mode;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         AccECN</span> feedback <span class="delete">within the same connection;</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0054"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  MUST NOT send <span class="delete">an</span> ECN-setup <span class="delete">SYN/ACK</span> [RFC3168] and a <span class="delete">SYN/ACK</span></td><td> </td><td class="rblock">      -  MUST NOT send <span class="insert">a 'Classic'</span> ECN-setup <span class="insert">SYN</span> [RFC3168] <span class="insert">with</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         agreeing to use</span> AccECN feedback within the same connection;</td><td> </td><td class="rblock"><span class="insert">         (AE,CWR,ECE) = (0,1,1)</span> and a <span class="insert">SYN with (AE,CWR,ECE) = (1,1,1)</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         requesting</span> AccECN feedback within the same connection;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0055"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  MUST <span class="delete">reset the connection with</span> a <span class="delete">RST packet, if it receives an</span></td><td> </td><td class="rblock">      -  MUST <span class="insert">NOT send</span> a <span class="insert">'Classic'</span> ECN-setup <span class="insert">SYN/ACK [RFC3168] with</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         ECN-setup <span class="delete">SYN[RFC3168]</span> and a <span class="delete">SYN requesting</span> AccECN feedback</td><td> </td><td class="rblock"><span class="insert">         (AE,CWR,ECE) = (0,0,1)</span> and a <span class="insert">SYN/ACK agreeing to use</span> AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         <span class="delete">during</span> the same connection;</td><td> </td><td class="rblock">         feedback <span class="insert">within</span> the same connection;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0056"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  MUST reset the connection with a RST packet, if it receives <span class="delete">an</span></td><td> </td><td class="rblock">      -  MUST reset the connection with a RST packet, if it receives <span class="insert">a</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         ECN-setup <span class="delete">SYN/ACK [RFC3168]</span> and a <span class="delete">SYN/ACK agreeing to use</span></td><td> </td><td class="rblock"><span class="insert">         'Classic'</span> ECN-setup <span class="insert">SYN with (AE,CWR,ECE) = (0,1,1)</span> and a <span class="insert">SYN</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         AccECN feedback during the same connection;</td><td> </td><td class="rblock"><span class="insert">         requesting</span> AccECN feedback during the same connection;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0057"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">SHOULD NOT set ECT on any packet</span> if it <span class="delete">has received at least</span></td><td> </td><td class="rblock">      -  <span class="insert">MUST reset the connection with a RST packet,</span> if it <span class="insert">receives</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         one valid SYN or Acceptable</span> SYN/ACK with <span class="delete">AE=CWR=ECE=0.  A</span></td><td> </td><td class="rblock"><span class="insert">         'Classic' ECN-setup</span> SYN/ACK with <span class="insert">(AE,CWR,ECE) = (0,0,1)</span> and <span class="insert">a</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         "valid SYN" has the same port numbers</span> and <span class="delete">the same ISN as the</span></td><td> </td><td class="rblock"><span class="insert">         SYN/ACK agreeing</span> to <span class="insert">use</span> AccECN <span class="insert">feedback during the same</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         SYN that caused the server</span> to <span class="delete">enter</span> AccECN <span class="delete">mode;</span></td><td> </td><td class="rblock"><span class="insert">         connection;</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      The above rules are necessary because, if one peer were to</td><td> </td><td class="right">      The above rules are necessary because, if one peer were to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      negotiate the feedback mode in two different types of handshake,</td><td> </td><td class="right">      negotiate the feedback mode in two different types of handshake,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      it would not be possible for the other peer to know for certain</td><td> </td><td class="right">      it would not be possible for the other peer to know for certain</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      which handshake packet(s) the other end had eventually received or</td><td> </td><td class="right">      which handshake packet(s) the other end had eventually received or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      in which order it received them.  So, in the absence of these</td><td> </td><td class="right">      in which order it received them.  So, in the absence of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      rules, the two peers could end up using different feedback modes</td><td> </td><td class="right">      rules, the two peers could end up using different feedback modes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      without knowing it.</td><td> </td><td class="right">      without knowing it.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0058"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">*  A TCP Server in AccECN mode that is sending an AccECN SYN/ACK:</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">      -  MUST feed back the IP-ECN field of the latest valid SYN to</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         arrive (by using the appropriate combination of TCP-ECN flags</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         from Table 2).</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If for any reason a host is not willing to provide ECN feedback on a</td><td> </td><td class="right">   If for any reason a host is not willing to provide ECN feedback on a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   particular TCP connection, it SHOULD clear the AE, CWR and ECE flags</td><td> </td><td class="right">   particular TCP connection, it SHOULD clear the AE, CWR and ECE flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in all SYN and/or SYN/ACK packets that it sends.</td><td> </td><td class="right">   in all SYN and/or SYN/ACK packets that it sends.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Sending ECT:</td><td> </td><td class="right">   Sending ECT:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  A Data Sender in AccECN mode:</td><td> </td><td class="right">   *  A Data Sender in AccECN mode:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      -  can set an ECT codepoint in the IP header of packets to</td><td> </td><td class="right">      -  can set an ECT codepoint in the IP header of packets to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         indicate to the network that the transport is capable and</td><td> </td><td class="right">         indicate to the network that the transport is capable and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         willing to participate in ECN for this packet;</td><td> </td><td class="right">         willing to participate in ECN for this packet;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      -  does not have to set ECT on any packet (for instance if it has</td><td> </td><td class="right">      -  does not have to set ECT on any packet (for instance if it has</td><td class="lineno"><br></td></tr>
      <tr id="diff0059"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         reason to believe such a packet would be <span class="delete">blocked).</span></td><td> </td><td class="rblock">         reason to believe such a packet would be <span class="insert">blocked);</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert"></span><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">      -  SHOULD NOT set ECT on any packet if it has received at least</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         one valid SYN or Acceptable SYN/ACK with (AE,CWR,ECE) =</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">         (0,0,0).</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Congestion response:</td><td> </td><td class="right">   Congestion response:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  A Data Sender in AccECN mode:</td><td> </td><td class="right">   *  A Data Sender in AccECN mode:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0060"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  is <span class="delete">still</span> obliged to respond appropriately to AccECN feedback</td><td> </td><td class="rblock">      -  is obliged to respond appropriately to AccECN feedback that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         that indicates there were ECN marks on packets it had</td><td> </td><td class="rblock">         indicates there were ECN marks on packets it had previously</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         previously sent, <span class="delete">as</span> defined in Section 6.1 of [RFC3168] and</td><td> </td><td class="rblock">         sent, <span class="insert">where 'appropriately' is</span> defined in Section 6.1 of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         updated by Sections 2.1 and 4.1 of <span class="delete">[RFC8311].</span></td><td> </td><td class="rblock">         [RFC3168] and updated by Sections 2.1 and 4.1 of <span class="insert">[RFC8311];</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0061"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         <span class="delete">In general, a Data Sender</span> is obliged to respond to congestion</td><td> </td><td class="rblock">      <span class="insert">-</span>  is <span class="insert">still</span> obliged to respond <span class="insert">appropriately</span> to congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         <span class="delete">feedback</span> even when it is solely sending non-ECN-capable packets</td><td> </td><td class="rblock">         <span class="insert">feedback,</span> even when it is solely sending non-ECN-capable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         (for rationale, some examples and some exceptions see</td><td> </td><td class="rblock">         packets (for rationale, some examples and some exceptions see</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         Section 3.2.2.3, Section 3.2.2.4).</td><td> </td><td class="right">         Section 3.2.2.3, Section 3.2.2.4).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0062"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  <span class="delete">commits</span> to respond appropriately to <span class="delete">incoming indications of</span></td><td> </td><td class="rblock">      -  <span class="insert">is still obliged</span> to respond appropriately to <span class="insert">congestion</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">         congestion,</span> even if it sends a SYN packet with <span class="delete">AE=CWR=ECE=0</span> in</td><td> </td><td class="rblock"><span class="insert">         feedback,</span> even if it sends a SYN <span class="insert">or SYN/ACK</span> packet with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         a later transmission within the same TCP connection;</td><td> </td><td class="rblock">         <span class="insert">(AE,CWR,ECE) = (0,0,0)</span> in a later transmission within the same</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">         TCP connection;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0063"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      -  MUST NOT set CWR to indicate it has received and responded to</td><td> </td><td class="rblock">      -  MUST NOT set CWR to indicate <span class="insert">that</span> it has received and responded</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         indications of congestion.</td><td> </td><td class="rblock">         to indications of congestion.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         For the avoidance of doubt, this is unlike an RFC 3168 data</td><td> </td><td class="right">         For the avoidance of doubt, this is unlike an RFC 3168 data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         sender and this does not preclude the Data Sender from setting</td><td> </td><td class="right">         sender and this does not preclude the Data Sender from setting</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         the bits of the ACE counter field, which includes an overloaded</td><td> </td><td class="right">         the bits of the ACE counter field, which includes an overloaded</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         use of the same bit.</td><td> </td><td class="right">         use of the same bit.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Receiving ECT:</td><td> </td><td class="right">   Receiving ECT:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  A Data Receiver in AccECN mode:</td><td> </td><td class="right">   *  A Data Receiver in AccECN mode:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      -  MUST feed back the information in the IP-ECN field of incoming</td><td> </td><td class="right">      -  MUST feed back the information in the IP-ECN field of incoming</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         packets using Accurate ECN feedback, as specified in</td><td> </td><td class="right">         packets using Accurate ECN feedback, as specified in</td><td class="lineno"><br></td></tr>
      <tr id="diff0064"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">         Section 3.2<span class="delete"> below</span>.</td><td> </td><td class="rblock">         Section 3.2.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      -  MUST NOT use reception of packets with ECT set in the IP-ECN</td><td> </td><td class="right">      -  MUST NOT use reception of packets with ECT set in the IP-ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         field as an implicit signal that the peer is ECN-capable.</td><td> </td><td class="right">         field as an implicit signal that the peer is ECN-capable.</td><td class="lineno"><br></td></tr>
      <tr id="diff0065"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">                                                                         </span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         Reason: ECT at the IP layer does not explicitly confirm the</td><td> </td><td class="right">         Reason: ECT at the IP layer does not explicitly confirm the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         peer has the correct ECN feedback logic, because the packets</td><td> </td><td class="right">         peer has the correct ECN feedback logic, because the packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">         could have been mangled at the IP layer.</td><td> </td><td class="right">         could have been mangled at the IP layer.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.  AccECN Feedback</td><td> </td><td class="right">3.2.  AccECN Feedback</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Each Data Receiver of each half connection maintains four counters,</td><td> </td><td class="right">   Each Data Receiver of each half connection maintains four counters,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   r.cep, r.ceb, r.e0b and r.e1b:</td><td> </td><td class="right">   r.cep, r.ceb, r.e0b and r.e1b:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  The Data Receiver MUST increment the CE packet counter (r.cep),</td><td> </td><td class="right">   *  The Data Receiver MUST increment the CE packet counter (r.cep),</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-11" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-11"><em> page 22, line 23<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-11"><em> page 21, line 50<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A TCP Client (A) in AccECN mode MUST feed back which of the 4</td><td> </td><td class="right">   A TCP Client (A) in AccECN mode MUST feed back which of the 4</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   possible values of the IP-ECN field was on the SYN/ACK by writing it</td><td> </td><td class="right">   possible values of the IP-ECN field was on the SYN/ACK by writing it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   into the ACE field of a pure ACK with no SACK blocks using the binary</td><td> </td><td class="right">   into the ACE field of a pure ACK with no SACK blocks using the binary</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   encoding in Table 3 (which is the same as that used on the SYN/ACK in</td><td> </td><td class="right">   encoding in Table 3 (which is the same as that used on the SYN/ACK in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Table 2).  This shall be called the handshake encoding of the ACE</td><td> </td><td class="right">   Table 2).  This shall be called the handshake encoding of the ACE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field, and it is the only exception to the rule that the ACE field</td><td> </td><td class="right">   field, and it is the only exception to the rule that the ACE field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   carries the 3 least significant bits of the r.cep counter on packets</td><td> </td><td class="right">   carries the 3 least significant bits of the r.cep counter on packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with SYN=0.</td><td> </td><td class="right">   with SYN=0.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0066"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">The TCP Client MUST also use the handshake encoding for the pure ACK</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   of any retransmitted SYN/ACK.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Normally, a TCP Client acknowledges a SYN/ACK with an ACK that</td><td> </td><td class="right">   Normally, a TCP Client acknowledges a SYN/ACK with an ACK that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   satisfies the above conditions anyway (SYN=0, no data, no SACK</td><td> </td><td class="right">   satisfies the above conditions anyway (SYN=0, no data, no SACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   blocks).  If an AccECN TCP Client intends to acknowledge the SYN/ACK</td><td> </td><td class="right">   blocks).  If an AccECN TCP Client intends to acknowledge the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with a packet that does not satisfy these conditions (e.g. it has</td><td> </td><td class="right">   with a packet that does not satisfy these conditions (e.g. it has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   data to include on the ACK), it SHOULD first send a pure ACK that</td><td> </td><td class="right">   data to include on the ACK), it SHOULD first send a pure ACK that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   does satisfy these conditions (see Section 5.2), so that it can feed</td><td> </td><td class="right">   does satisfy these conditions (see Section 5.2), so that it can feed</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   back which of the four values of the IP-ECN field arrived on the SYN/</td><td> </td><td class="right">   back which of the four values of the IP-ECN field arrived on the SYN/</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK.  A valid exception to this "SHOULD" would be where the</td><td> </td><td class="right">   ACK.  A valid exception to this "SHOULD" would be where the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   implementation will only be used in an environment where mangling of</td><td> </td><td class="right">   implementation will only be used in an environment where mangling of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the ECN field is unlikely.</td><td> </td><td class="right">   the ECN field is unlikely.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0067"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">The TCP Client MUST also use the handshake encoding for the pure ACK</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   of any retransmitted SYN/ACK that confirms that the TCP Server</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   supports AccECN.  The procedure for the TCP Server to follow if the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   final ACK of the handshake does not arrive before its retransmission</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   timer expires is given in Section 3.2.3.2.2.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        +==================+================+=====================+</td><td> </td><td class="right">        +==================+================+=====================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        | IP-ECN codepoint | ACE on pure    | r.cep of TCP Client |</td><td> </td><td class="right">        | IP-ECN codepoint | ACE on pure    | r.cep of TCP Client |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        | on SYN/ACK       | ACK of SYN/ACK | in AccECN mode      |</td><td> </td><td class="right">        | on SYN/ACK       | ACK of SYN/ACK | in AccECN mode      |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        +==================+================+=====================+</td><td> </td><td class="right">        +==================+================+=====================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        | Not-ECT          | 0b010          | 5                   |</td><td> </td><td class="right">        | Not-ECT          | 0b010          | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        +------------------+----------------+---------------------+</td><td> </td><td class="right">        +------------------+----------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        | ECT(1)           | 0b011          | 5                   |</td><td> </td><td class="right">        | ECT(1)           | 0b011          | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        +------------------+----------------+---------------------+</td><td> </td><td class="right">        +------------------+----------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        | ECT(0)           | 0b100          | 5                   |</td><td> </td><td class="right">        | ECT(0)           | 0b100          | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        +------------------+----------------+---------------------+</td><td> </td><td class="right">        +------------------+----------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        | CE               | 0b110          | 6                   |</td><td> </td><td class="right">        | CE               | 0b110          | 6                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        +------------------+----------------+---------------------+</td><td> </td><td class="right">        +------------------+----------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">            Table 3: The encoding of the ACE field in the ACK of</td><td> </td><td class="right">            Table 3: The encoding of the ACE field in the ACK of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">             the SYN-ACK to reflect the SYN-ACK's IP-ECN field</td><td> </td><td class="right">             the SYN-ACK to reflect the SYN-ACK's IP-ECN field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0068"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   When an AccECN <span class="delete">s</span>erver in SYN-RCVD state receives a pure ACK with</td><td> </td><td class="rblock">   When an AccECN <span class="insert">S</span>erver in SYN-RCVD state receives a pure ACK with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN=0 and no SACK blocks, instead of treating the ACE field as a</td><td> </td><td class="right">   SYN=0 and no SACK blocks, instead of treating the ACE field as a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counter, it MUST infer the meaning of each possible value of the ACE</td><td> </td><td class="right">   counter, it MUST infer the meaning of each possible value of the ACE</td><td class="lineno"><br></td></tr>
      <tr id="diff0069"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   field from Table 4, which also shows the value that an AccECN <span class="delete">s</span>erver</td><td> </td><td class="rblock">   field from Table 4, which also shows the value that an AccECN <span class="insert">S</span>erver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   MUST set s.cep to as a result.</td><td> </td><td class="right">   MUST set s.cep to as a result.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Given this encoding of the ACE field on the ACK of a SYN/ACK is</td><td> </td><td class="right">   Given this encoding of the ACE field on the ACK of a SYN/ACK is</td><td class="lineno"><br></td></tr>
      <tr id="diff0070"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   exceptional, an AccECN <span class="delete">s</span>erver using large receive offload (LRO) might</td><td> </td><td class="rblock">   exceptional, an AccECN <span class="insert">S</span>erver using large receive offload (LRO) might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   prefer to disable LRO until such an ACK has transitioned it out of</td><td> </td><td class="right">   prefer to disable LRO until such an ACK has transitioned it out of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN-RCVD state.</td><td> </td><td class="right">   SYN-RCVD state.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +============+==========================+=====================+</td><td> </td><td class="right">      +============+==========================+=====================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | ACE on ACK | IP-ECN codepoint on SYN/ | s.cep of TCP Server |</td><td> </td><td class="right">      | ACE on ACK | IP-ECN codepoint on SYN/ | s.cep of TCP Server |</td><td class="lineno"><br></td></tr>
      <tr id="diff0071"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      | of SYN/ACK | ACK inferred by <span class="delete">s</span>erver   | in AccECN mode      |</td><td> </td><td class="rblock">      | of SYN/ACK | ACK inferred by <span class="insert">S</span>erver   | in AccECN mode      |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +============+==========================+=====================+</td><td> </td><td class="right">      +============+==========================+=====================+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 0b000      | {Notes 1, 3}             | Disable ECN         |</td><td> </td><td class="right">      | 0b000      | {Notes 1, 3}             | Disable ECN         |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------------+--------------------------+---------------------+</td><td> </td><td class="right">      +------------+--------------------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 0b001      | {Notes 2, 3}             | 5                   |</td><td> </td><td class="right">      | 0b001      | {Notes 2, 3}             | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------------+--------------------------+---------------------+</td><td> </td><td class="right">      +------------+--------------------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 0b010      | Not-ECT                  | 5                   |</td><td> </td><td class="right">      | 0b010      | Not-ECT                  | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------------+--------------------------+---------------------+</td><td> </td><td class="right">      +------------+--------------------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 0b011      | ECT(1)                   | 5                   |</td><td> </td><td class="right">      | 0b011      | ECT(1)                   | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------------+--------------------------+---------------------+</td><td> </td><td class="right">      +------------+--------------------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 0b100      | ECT(0)                   | 5                   |</td><td> </td><td class="right">      | 0b100      | ECT(0)                   | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-12" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-12"><em> page 23, line 41<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-12"><em> page 23, line 30<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      |            | 2}                       |                     |</td><td> </td><td class="right">      |            | 2}                       |                     |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------------+--------------------------+---------------------+</td><td> </td><td class="right">      +------------+--------------------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 0b110      | CE                       | 6                   |</td><td> </td><td class="right">      | 0b110      | CE                       | 6                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------------+--------------------------+---------------------+</td><td> </td><td class="right">      +------------+--------------------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      | 0b111      | Currently Unused {Note   | 5                   |</td><td> </td><td class="right">      | 0b111      | Currently Unused {Note   | 5                   |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      |            | 2}                       |                     |</td><td> </td><td class="right">      |            | 2}                       |                     |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      +------------+--------------------------+---------------------+</td><td> </td><td class="right">      +------------+--------------------------+---------------------+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">        Table 4: Meaning of the ACE field on the ACK of the SYN/ACK</td><td> </td><td class="right">        Table 4: Meaning of the ACE field on the ACK of the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0072"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   {Note 1}: If the <span class="delete">server</span> is in AccECN mode, the value of zero raises</td><td> </td><td class="rblock">   {Note 1}: If the <span class="insert">Server</span> is in AccECN mode, the value of zero <span class="insert">in the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   suspicion of zeroing of the ACE field on the path (see</td><td> </td><td class="rblock"><span class="insert">   ACK of the SYN/ACK</span> raises suspicion of zeroing of the ACE field on</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Section 3.2.2.4).</td><td> </td><td class="rblock">   the path (see Section 3.2.2.4).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0073"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   {Note 2}: If the <span class="delete">server</span> is in AccECN mode, these values are Currently</td><td> </td><td class="rblock">   {Note 2}: If the <span class="insert">Server</span> is in AccECN mode, these values are Currently</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Unused but the AccECN <span class="delete">server's</span> behaviour is still defined for forward</td><td> </td><td class="rblock">   Unused but the AccECN <span class="insert">Server's</span> behaviour is still defined for forward</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   compatibility.  Then the designer of a future protocol can know for</td><td> </td><td class="right">   compatibility.  Then the designer of a future protocol can know for</td><td class="lineno"><br></td></tr>
      <tr id="diff0074"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   certain what AccECN <span class="delete">s</span>ervers will do with these codepoints.</td><td> </td><td class="rblock">   certain what AccECN <span class="insert">S</span>ervers will do with these codepoints.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0075"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   {Note 3}: In the case where a <span class="delete">s</span>erver that implements AccECN is also</td><td> </td><td class="rblock">   {Note 3}: In the case where a <span class="insert">S</span>erver that implements AccECN is also</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   using a stateless handshake (termed a SYN cookie) it will not</td><td> </td><td class="right">   using a stateless handshake (termed a SYN cookie) it will not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   remember whether it entered AccECN mode.  The values 0b000 or 0b001</td><td> </td><td class="right">   remember whether it entered AccECN mode.  The values 0b000 or 0b001</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   will remind it that it did not enter AccECN mode, because AccECN does</td><td> </td><td class="right">   will remind it that it did not enter AccECN mode, because AccECN does</td><td class="lineno"><br></td></tr>
      <tr id="diff0076"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   not use them (see Section 5.1 for details).  If a <span class="delete">s</span>erver that uses a</td><td> </td><td class="rblock">   not use them (see Section 5.1 for details).  If a <span class="insert">S</span>erver that uses a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   stateless handshake and implements AccECN receives either of these</td><td> </td><td class="right">   stateless handshake and implements AccECN receives either of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   two values in the ACK, its action is implementation-dependent and</td><td> </td><td class="right">   two values in the ACK, its action is implementation-dependent and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   outside the scope of this spec.  It will certainly not take the</td><td> </td><td class="right">   outside the scope of this spec.  It will certainly not take the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   action in the third column because, after it receives either of these</td><td> </td><td class="right">   action in the third column because, after it receives either of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   values, it is not in AccECN mode.  I.e., it will not disable ECN (at</td><td> </td><td class="right">   values, it is not in AccECN mode.  I.e., it will not disable ECN (at</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   least not just because ACE is 0b000) and it will not set s.cep.</td><td> </td><td class="right">   least not just because ACE is 0b000) and it will not set s.cep.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.2.2.  Encoding and Decoding Feedback in the ACE Field</td><td> </td><td class="right">3.2.2.2.  Encoding and Decoding Feedback in the ACE Field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Whenever the Data Receiver sends an ACK with SYN=0 (with or without</td><td> </td><td class="right">   Whenever the Data Receiver sends an ACK with SYN=0 (with or without</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-13" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-13"><em> page 24, line 45<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-13"><em> page 24, line 37<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the ACE field might have wrapped more than once.</td><td> </td><td class="right">      the ACE field might have wrapped more than once.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The encode/decode procedures during the three-way handshake are</td><td> </td><td class="right">   The encode/decode procedures during the three-way handshake are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   exceptions to the general rules given so far, so they are spelled out</td><td> </td><td class="right">   exceptions to the general rules given so far, so they are spelled out</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   step by step below for clarity:</td><td> </td><td class="right">   step by step below for clarity:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  If a TCP Server in AccECN mode receives a CE mark in the IP-ECN</td><td> </td><td class="right">   *  If a TCP Server in AccECN mode receives a CE mark in the IP-ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      field of a SYN (SYN=1, ACK=0), it MUST NOT increment r.cep (it</td><td> </td><td class="right">      field of a SYN (SYN=1, ACK=0), it MUST NOT increment r.cep (it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      remains at its initial value of 5).</td><td> </td><td class="right">      remains at its initial value of 5).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0077"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Reason: It would be redundant for the <span class="delete">s</span>erver to include CE-marked</td><td> </td><td class="rblock">      Reason: It would be redundant for the <span class="insert">S</span>erver to include CE-marked</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      SYNs in its r.cep counter, because it already reliably delivers</td><td> </td><td class="right">      SYNs in its r.cep counter, because it already reliably delivers</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback of any CE marking using the encoding in Table 2 in the</td><td> </td><td class="right">      feedback of any CE marking using the encoding in Table 2 in the</td><td class="lineno"><br></td></tr>
      <tr id="diff0078"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      SYN/ACK.  This also ensures that, when the <span class="delete">s</span>erver starts using the</td><td> </td><td class="rblock">      SYN/ACK.  This also ensures that, when the <span class="insert">S</span>erver starts using the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ACE field, it has not unnecessarily consumed more than one initial</td><td> </td><td class="right">      ACE field, it has not unnecessarily consumed more than one initial</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      value, given they can be used to negotiate variants of the AccECN</td><td> </td><td class="right">      value, given they can be used to negotiate variants of the AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      protocol (see Appendix B.3).</td><td> </td><td class="right">      protocol (see Appendix B.3).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  If a TCP Client in AccECN mode receives CE feedback in the TCP</td><td> </td><td class="right">   *  If a TCP Client in AccECN mode receives CE feedback in the TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      flags of a SYN/ACK, it MUST NOT increment s.cep (it remains at its</td><td> </td><td class="right">      flags of a SYN/ACK, it MUST NOT increment s.cep (it remains at its</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      initial value of 5), so that it stays in step with r.cep on the</td><td> </td><td class="right">      initial value of 5), so that it stays in step with r.cep on the</td><td class="lineno"><br></td></tr>
      <tr id="diff0079"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">s</span>erver.  Nonetheless, the TCP Client still triggers the congestion</td><td> </td><td class="rblock">      <span class="insert">S</span>erver.  Nonetheless, the TCP Client still triggers the congestion</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      control actions necessary to respond to the CE feedback.</td><td> </td><td class="right">      control actions necessary to respond to the CE feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  If a TCP Client in AccECN mode receives a CE mark in the IP-ECN</td><td> </td><td class="right">   *  If a TCP Client in AccECN mode receives a CE mark in the IP-ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      field of a SYN/ACK, it MUST increment r.cep, but no more than once</td><td> </td><td class="right">      field of a SYN/ACK, it MUST increment r.cep, but no more than once</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      no matter how many CE-marked SYN/ACKs it receives</td><td> </td><td class="right">      no matter how many CE-marked SYN/ACKs it receives</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      (i.e. incremented from 5 to 6, but no further).</td><td> </td><td class="right">      (i.e. incremented from 5 to 6, but no further).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0080"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Reason: Incrementing r.cep ensures the <span class="delete">client</span> will eventually</td><td> </td><td class="rblock">      Reason: Incrementing r.cep ensures the <span class="insert">Client</span> will eventually</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      deliver any CE marking to the <span class="delete">server</span> reliably when it starts using</td><td> </td><td class="rblock">      deliver any CE marking to the <span class="insert">Server</span> reliably when it starts using</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      the ACE field.  Even though the <span class="delete">client</span> also feeds back any CE</td><td> </td><td class="rblock">      the ACE field.  Even though the <span class="insert">Client</span> also feeds back any CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      marking on the ACK of the SYN/ACK using the encoding in Table 3,</td><td> </td><td class="right">      marking on the ACK of the SYN/ACK using the encoding in Table 3,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      this ACK is not delivered reliably, so it can be considered as a</td><td> </td><td class="right">      this ACK is not delivered reliably, so it can be considered as a</td><td class="lineno"><br></td></tr>
      <tr id="diff0081"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      timely notification that is redundant but unreliable.  The <span class="delete">client</span></td><td> </td><td class="rblock">      timely notification that is redundant but unreliable.  The <span class="insert">Client</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      does not increment r.cep more than once, because the <span class="delete">server</span> can</td><td> </td><td class="rblock">      does not increment r.cep more than once, because the <span class="insert">Server</span> can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      only increment s.cep once (see next bullet).  Also, this limits</td><td> </td><td class="right">      only increment s.cep once (see next bullet).  Also, this limits</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the unnecessarily consumed initial values of the ACE field to two.</td><td> </td><td class="right">      the unnecessarily consumed initial values of the ACE field to two.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  If a TCP Server in AccECN mode and in SYN-RCVD state receives CE</td><td> </td><td class="right">   *  If a TCP Server in AccECN mode and in SYN-RCVD state receives CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback in the TCP flags of a pure ACK with no SACK blocks, it</td><td> </td><td class="right">      feedback in the TCP flags of a pure ACK with no SACK blocks, it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      MUST increment s.cep (from 5 to 6).  The TCP Server then triggers</td><td> </td><td class="right">      MUST increment s.cep (from 5 to 6).  The TCP Server then triggers</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the congestion control actions necessary to respond to the CE</td><td> </td><td class="right">      the congestion control actions necessary to respond to the CE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      feedback.</td><td> </td><td class="right">      feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Reasoning: The TCP Server can only increment s.cep once, because</td><td> </td><td class="right">      Reasoning: The TCP Server can only increment s.cep once, because</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the first ACK it receives will cause it to transition out of SYN-</td><td> </td><td class="right">      the first ACK it receives will cause it to transition out of SYN-</td><td class="lineno"><br></td></tr>
      <tr id="diff0082"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      RCVD state.  The <span class="delete">s</span>erver's congestion response would be no</td><td> </td><td class="rblock">      RCVD state.  The <span class="insert">S</span>erver's congestion response would be no</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      different even if it could receive feedback of more than one CE-</td><td> </td><td class="right">      different even if it could receive feedback of more than one CE-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      marked SYN/ACK.</td><td> </td><td class="right">      marked SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Once the TCP Server transitions to ESTABLISHED state, it might</td><td> </td><td class="right">      Once the TCP Server transitions to ESTABLISHED state, it might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      later receive other pure ACK(s) with the handshake encoding in the</td><td> </td><td class="right">      later receive other pure ACK(s) with the handshake encoding in the</td><td class="lineno"><br></td></tr>
      <tr id="diff0083"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      ACE field.  A <span class="delete">s</span>erver MAY implement a test for such a case, but it</td><td> </td><td class="rblock">      ACE field.  A <span class="insert">S</span>erver MAY implement a test for such a case, but it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      is not required.  Therefore, once in the ESTABLISHED state, it</td><td> </td><td class="right">      is not required.  Therefore, once in the ESTABLISHED state, it</td><td class="lineno"><br></td></tr>
      <tr id="diff0084"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      will be sufficient for the <span class="delete">s</span>erver to consider the ACE field to be</td><td> </td><td class="rblock">      will be sufficient for the <span class="insert">S</span>erver to consider the ACE field to be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      encoded as the normal ACE counter on all packets with SYN=0.</td><td> </td><td class="right">      encoded as the normal ACE counter on all packets with SYN=0.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Reasoning: Such ACKs will be quite unusual, e.g. a SYN/ACK (or ACK</td><td> </td><td class="right">      Reasoning: Such ACKs will be quite unusual, e.g. a SYN/ACK (or ACK</td><td class="lineno"><br></td></tr>
      <tr id="diff0085"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      of the SYN/ACK) that is delayed for longer than the <span class="delete">s</span>erver's</td><td> </td><td class="rblock">      of the SYN/ACK) that is delayed for longer than the <span class="insert">S</span>erver's</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      retransmission timeout; or packet duplication by the network.  And</td><td> </td><td class="right">      retransmission timeout; or packet duplication by the network.  And</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the impact of any error in the feedback on such ACKs will only be</td><td> </td><td class="right">      the impact of any error in the feedback on such ACKs will only be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      temporary.</td><td> </td><td class="right">      temporary.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.2.3.  Testing for Mangling of the IP/ECN Field</td><td> </td><td class="right">3.2.2.3.  Testing for Mangling of the IP/ECN Field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0086"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The value of the <span class="delete">ACE field</span> on the SYN/ACK indicates the value of the</td><td> </td><td class="rblock">   The value of the <span class="insert">TCP-ECN flags</span> on the SYN/ACK indicates the value of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">IP/ECN</span> field when the SYN arrived at the <span class="delete">server.</span>  The TCP Client can</td><td> </td><td class="rblock">   the <span class="insert">IP-ECN</span> field when the SYN arrived at the <span class="insert">Server.</span>  The TCP Client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   compare this with how it originally set the <span class="delete">IP/ECN</span> field on the SYN.</td><td> </td><td class="rblock">   can compare this with how it originally set the <span class="insert">IP-ECN</span> field on the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   If this comparison implies an invalid transition (defined below) of</td><td> </td><td class="rblock">   SYN.  If this comparison implies an invalid transition (defined</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the <span class="delete">IP/ECN</span> field, for the remainder of the half-connection the <span class="delete">client</span></td><td> </td><td class="rblock">   below) of the <span class="insert">IP-ECN</span> field, for the remainder of the half-connection</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   is advised to send non-ECN-capable packets, but it still ought to</td><td> </td><td class="rblock">   the <span class="insert">Client</span> is advised to send non-ECN-capable packets, but it still</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   respond to any feedback of CE markings (explained below).  However,</td><td> </td><td class="rblock">   ought to respond to any feedback of CE markings (explained below).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the TCP Client MUST remain in the AccECN feedback mode and it MUST</td><td> </td><td class="rblock">   However, the TCP Client MUST remain in the AccECN feedback mode and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   continue to feed back any ECN markings on arriving packets (in its</td><td> </td><td class="rblock">   it MUST continue to feed back any ECN markings on arriving packets</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   role as Data Receiver).</td><td> </td><td class="rblock">   (in its role as Data Receiver).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The value of the ACE field on the last ACK of the 3WHS indicates the</td><td> </td><td class="right">   The value of the ACE field on the last ACK of the 3WHS indicates the</td><td class="lineno"><br></td></tr>
      <tr id="diff0087"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   value of the <span class="delete">IP/ECN</span> field when the SYN/ACK arrived at the TCP Client.</td><td> </td><td class="rblock">   value of the <span class="insert">IP-ECN</span> field when the SYN/ACK arrived at the TCP Client.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   The <span class="delete">server</span> can compare this with how it originally set the <span class="delete">IP/ECN</span></td><td> </td><td class="rblock">   The <span class="insert">Server</span> can compare this with how it originally set the <span class="insert">IP-ECN</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field on the SYN/ACK.  If this comparison implies an invalid</td><td> </td><td class="right">   field on the SYN/ACK.  If this comparison implies an invalid</td><td class="lineno"><br></td></tr>
      <tr id="diff0088"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   transition of the <span class="delete">IP/ECN</span> field, for the remainder of the half-</td><td> </td><td class="rblock">   transition of the <span class="insert">IP-ECN</span> field, for the remainder of the half-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   connection the <span class="delete">server</span> is advised to send non-ECN-capable packets, but</td><td> </td><td class="rblock">   connection the <span class="insert">Server</span> is advised to send non-ECN-capable packets, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it still ought to respond to any feedback of CE markings (explained</td><td> </td><td class="right">   it still ought to respond to any feedback of CE markings (explained</td><td class="lineno"><br></td></tr>
      <tr id="diff0089"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   below).  However, the <span class="delete">s</span>erver MUST remain in the AccECN feedback mode</td><td> </td><td class="rblock">   below).  However, the <span class="insert">S</span>erver MUST remain in the AccECN feedback mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and it MUST continue to feed back any ECN markings on arriving</td><td> </td><td class="right">   and it MUST continue to feed back any ECN markings on arriving</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets (in its role as Data Receiver).</td><td> </td><td class="right">   packets (in its role as Data Receiver).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If a Data Sender in AccECN mode starts sending non-ECN-capable</td><td> </td><td class="right">   If a Data Sender in AccECN mode starts sending non-ECN-capable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets because it has detected mangling, it is still advised to</td><td> </td><td class="right">   packets because it has detected mangling, it is still advised to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   respond to CE feedback.  Reason: any CE-marking arriving at the Data</td><td> </td><td class="right">   respond to CE feedback.  Reason: any CE-marking arriving at the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Receiver could be due to something early in the path mangling the</td><td> </td><td class="right">   Receiver could be due to something early in the path mangling the</td><td class="lineno"><br></td></tr>
      <tr id="diff0090"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   non-ECN-capable IP<span class="delete">/</span>ECN field into an ECN-capable codepoint and then,</td><td> </td><td class="rblock">   non-ECN-capable IP<span class="insert">-</span>ECN field into an ECN-capable codepoint and then,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   later in the path, a network bottleneck might be applying CE-markings</td><td> </td><td class="right">   later in the path, a network bottleneck might be applying CE-markings</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to indicate genuine congestion.  This argument applies whether the</td><td> </td><td class="right">   to indicate genuine congestion.  This argument applies whether the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   handshake packet originally sent by the TCP Client or Server was non-</td><td> </td><td class="right">   handshake packet originally sent by the TCP Client or Server was non-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN-capable or ECN-capable because, in either case, an unsafe</td><td> </td><td class="right">   ECN-capable or ECN-capable because, in either case, an unsafe</td><td class="lineno"><br></td></tr>
      <tr id="diff0091"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   transition could imply that <span class="delete">future</span> non-ECN-capable packets might get</td><td> </td><td class="rblock">   transition could imply that non-ECN-capable packets <span class="insert">later in the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   mangled.</td><td> </td><td class="rblock"><span class="insert">   connection</span> might get mangled.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Once a Data Sender has entered AccECN mode it is advised to check</td><td> </td><td class="right">   Once a Data Sender has entered AccECN mode it is advised to check</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   whether it is receiving continuous CE marking.  Specifying exactly</td><td> </td><td class="right">   whether it is receiving continuous CE marking.  Specifying exactly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   how to do this is beyond the scope of the present specification, but</td><td> </td><td class="right">   how to do this is beyond the scope of the present specification, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the sender might check whether the feedback for every packet it sends</td><td> </td><td class="right">   the sender might check whether the feedback for every packet it sends</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   for the first three or four rounds indicates CE-marking.  If</td><td> </td><td class="right">   for the first three or four rounds indicates CE-marking.  If</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   continuous CE-marking is detected, for the remainder of the half-</td><td> </td><td class="right">   continuous CE-marking is detected, for the remainder of the half-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection, the Data Sender ought to send non-ECN-capable packets and</td><td> </td><td class="right">   connection, the Data Sender ought to send non-ECN-capable packets and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it is advised not to respond to any feedback of CE markings.  The</td><td> </td><td class="right">   it is advised not to respond to any feedback of CE markings.  The</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Data Sender might occasionally test whether it can resume sending</td><td> </td><td class="right">   Data Sender might occasionally test whether it can resume sending</td><td class="lineno"><br></td></tr>
      <tr id="diff0092"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN-capable packets.  <span class="delete">As always, once a host has entered AccECN mode,</span></td><td> </td><td class="rblock">   ECN-capable packets.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   it MUST remain in the same feedback mode and it MUST continue to feed</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   back any ECN markings on arriving packets.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The above advice on switching to sending non-ECN-capable packets but</td><td> </td><td class="right">   The above advice on switching to sending non-ECN-capable packets but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   still responding to CE-markings unless they become continuous is not</td><td> </td><td class="right">   still responding to CE-markings unless they become continuous is not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   stated normatively (in capitals), because the best strategy might</td><td> </td><td class="right">   stated normatively (in capitals), because the best strategy might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   depend on experience of the most likely types of mangling, which can</td><td> </td><td class="right">   depend on experience of the most likely types of mangling, which can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   only be known at the time of deployment.</td><td> </td><td class="right">   only be known at the time of deployment.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0093"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   <span class="insert">As always, once a host has entered AccECN mode, it follows the</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   general mandatory requirements (Section 3.1.5) to remain in the same</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   feedback mode and to continue feeding back any ECN markings on</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   arriving packets using AccECN feedback.  This follows the general</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   approach where an AccECN Data Receiver mechanistically reflects</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock"><span class="insert">   whatever it receives (Section 2.5).</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The ACK of the SYN/ACK is not reliably delivered (nonetheless, the</td><td> </td><td class="right">   The ACK of the SYN/ACK is not reliably delivered (nonetheless, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   count of CE marks is still eventually delivered reliably).  If this</td><td> </td><td class="right">   count of CE marks is still eventually delivered reliably).  If this</td><td class="lineno"><br></td></tr>
      <tr id="diff0094"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ACK does not arrive, the <span class="delete">server</span> is advised to continue to send ECN-</td><td> </td><td class="rblock">   ACK does not arrive, the <span class="insert">Server</span> is advised to continue to send ECN-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   capable packets without having tested for mangling of the <span class="delete">IP/ECN</span></td><td> </td><td class="rblock">   capable packets without having tested for mangling of the <span class="insert">IP-ECN</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   field on the SYN/ACK.</td><td> </td><td class="right">   field on the SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   All the fall-back behaviours in this section are necessary in case</td><td> </td><td class="right">   All the fall-back behaviours in this section are necessary in case</td><td class="lineno"><br></td></tr>
      <tr id="diff0095"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   mangling of the IP<span class="delete">/</span>ECN field is asymmetric, which is currently common</td><td> </td><td class="rblock">   mangling of the IP<span class="insert">-</span>ECN field is asymmetric, which is currently common</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   over some mobile networks [Mandalari18].  Then one end might see no</td><td> </td><td class="right">   over some mobile networks [Mandalari18].  Then one end might see no</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   unsafe transition and continue sending ECN-capable packets, while the</td><td> </td><td class="right">   unsafe transition and continue sending ECN-capable packets, while the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   other end sees an unsafe transition and stops sending ECN-capable</td><td> </td><td class="right">   other end sees an unsafe transition and stops sending ECN-capable</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets.</td><td> </td><td class="right">   packets.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0096"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Invalid transitions of the IP<span class="delete">/</span>ECN field are defined in section 18 of</td><td> </td><td class="rblock">   Invalid transitions of the IP<span class="insert">-</span>ECN field are defined in section 18 of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   [RFC3168] and repeated here for convenience:</td><td> </td><td class="right">   [RFC3168] and repeated here for convenience:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  the not-ECT codepoint changes;</td><td> </td><td class="right">   *  the not-ECT codepoint changes;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  either ECT codepoint transitions to not-ECT;</td><td> </td><td class="right">   *  either ECT codepoint transitions to not-ECT;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  the CE codepoint changes.</td><td> </td><td class="right">   *  the CE codepoint changes.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   RFC 3168 says that a router that changes ECT to not-ECT is invalid</td><td> </td><td class="right">   RFC 3168 says that a router that changes ECT to not-ECT is invalid</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   but safe.  However, from a host's viewpoint, this transition is</td><td> </td><td class="right">   but safe.  However, from a host's viewpoint, this transition is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-14" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-14"><em> page 28, line 16<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-14"><em> page 28, line 14<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   not stated normatively (in capitals), because the best strategy might</td><td> </td><td class="right">   not stated normatively (in capitals), because the best strategy might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   depend on experience of the most likely types of mangling, which can</td><td> </td><td class="right">   depend on experience of the most likely types of mangling, which can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   only be known at the time of deployment.</td><td> </td><td class="right">   only be known at the time of deployment.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If reordering occurs, "the first packet ... that arrives" will not</td><td> </td><td class="right">   If reordering occurs, "the first packet ... that arrives" will not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   necessarily be the same as the first packet in sequence order.  The</td><td> </td><td class="right">   necessarily be the same as the first packet in sequence order.  The</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   test has been specified loosely like this to simplify implementation,</td><td> </td><td class="right">   test has been specified loosely like this to simplify implementation,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and because it would not have been any more precise to have specified</td><td> </td><td class="right">   and because it would not have been any more precise to have specified</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the first packet in sequence order, which would not necessarily be</td><td> </td><td class="right">   the first packet in sequence order, which would not necessarily be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the first ACE counter that the Data Receiver fed back anyway, given</td><td> </td><td class="right">   the first ACE counter that the Data Receiver fed back anyway, given</td><td class="lineno"><br></td></tr>
      <tr id="diff0097"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   it might have been a retransmission.  Usually, the <span class="delete">server</span> checks the</td><td> </td><td class="rblock">   it might have been a retransmission.  Usually, the <span class="insert">Server</span> checks the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ACK of the SYN/ACK from the <span class="delete">client,</span> while the <span class="delete">client</span> checks the first</td><td> </td><td class="rblock">   ACK of the SYN/ACK from the <span class="insert">Client,</span> while the <span class="insert">Client</span> checks the first</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   data segment from the <span class="delete">server.</span></td><td> </td><td class="rblock">   data segment from the <span class="insert">Server.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The possibility of re-ordering means that there is a small chance</td><td> </td><td class="right">   The possibility of re-ordering means that there is a small chance</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that the ACE field on the first packet to arrive is genuinely zero</td><td> </td><td class="right">   that the ACE field on the first packet to arrive is genuinely zero</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (without middlebox interference).  This would cause a host to</td><td> </td><td class="right">   (without middlebox interference).  This would cause a host to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   unnecessarily disable ECN for a half connection.  Therefore, in</td><td> </td><td class="right">   unnecessarily disable ECN for a half connection.  Therefore, in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   environments where there is no evidence of the ACE field being</td><td> </td><td class="right">   environments where there is no evidence of the ACE field being</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   zeroed, implementations can skip this test.</td><td> </td><td class="right">   zeroed, implementations can skip this test.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Note that the Data Sender MUST NOT test whether the arriving counter</td><td> </td><td class="right">   Note that the Data Sender MUST NOT test whether the arriving counter</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in the initial ACE field has been initialized to a specific valid</td><td> </td><td class="right">   in the initial ACE field has been initialized to a specific valid</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-15" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-15"><em> page 31, line 38<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-15"><em> page 31, line 38<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">    0                   1                   2                   3</td><td> </td><td class="right">    0                   1                   2                   3</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</td><td> </td><td class="right">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   |  Kind = 173   |  Length = 11  |          EE1B field           |</td><td> </td><td class="right">   |  Kind = 173   |  Length = 11  |          EE1B field           |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   | EE1B (cont'd) |           ECEB field                          |</td><td> </td><td class="right">   | EE1B (cont'd) |           ECEB field                          |</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   |                  EE0B field                   |             Order 1</td><td> </td><td class="right">   |                  EE0B field                   |             Order 1</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td> </td><td class="right">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0098"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">              <span class="delete">        Figure 4: The AccECN TCP Option</span></td><td> </td><td class="rblock">              <span class="insert">Figure 4: The Two Alternative AccECN TCP Options</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Figure 4 shows two option field orders; order 0 and order 1.  They</td><td> </td><td class="right">   Figure 4 shows two option field orders; order 0 and order 1.  They</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   both consists of three 24-bit fields.  Order 0 provides the 24 least</td><td> </td><td class="right">   both consists of three 24-bit fields.  Order 0 provides the 24 least</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   significant bits of the r.e0b, r.ceb and r.e1b counters,</td><td> </td><td class="right">   significant bits of the r.e0b, r.ceb and r.e1b counters,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   respectively.  Order 1 provides the same fields, but in the opposite</td><td> </td><td class="right">   respectively.  Order 1 provides the same fields, but in the opposite</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   order.  On each packet, the Data Receiver can use whichever order is</td><td> </td><td class="right">   order.  On each packet, the Data Receiver can use whichever order is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   more efficient.  In either case, the bytes within the fields are in</td><td> </td><td class="right">   more efficient.  In either case, the bytes within the fields are in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   network byte order (big-endian).</td><td> </td><td class="right">   network byte order (big-endian).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When a Data Receiver sends an AccECN Option, it MUST set the Kind</td><td> </td><td class="right">   When a Data Receiver sends an AccECN Option, it MUST set the Kind</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-16" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-16"><em> page 33, line 47<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-16"><em> page 33, line 47<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Note that, as specified in Section 3.2, any data on the SYN (SYN=1,</td><td> </td><td class="right">   Note that, as specified in Section 3.2, any data on the SYN (SYN=1,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACK=0) is not included in any of the byte counters held locally for</td><td> </td><td class="right">   ACK=0) is not included in any of the byte counters held locally for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   each ECN marking nor in an AccECN Option on the wire.</td><td> </td><td class="right">   each ECN marking nor in an AccECN Option on the wire.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.  Path Traversal of the AccECN Option</td><td> </td><td class="right">3.2.3.2.  Path Traversal of the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.1.  Testing the AccECN Option during the Handshake</td><td> </td><td class="right">3.2.3.2.1.  Testing the AccECN Option during the Handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The TCP Client MUST NOT include an AccECN TCP Option on the SYN.  If</td><td> </td><td class="right">   The TCP Client MUST NOT include an AccECN TCP Option on the SYN.  If</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   there is somehow an AccECN Option on a SYN, it MUST be ignored when</td><td> </td><td class="right">   there is somehow an AccECN Option on a SYN, it MUST be ignored when</td><td class="lineno"><br></td></tr>
      <tr id="diff0099"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   forwarded or received.  <span class="delete">(A fall-back strategy for the loss of the</span></td><td> </td><td class="rblock">   forwarded or received.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   SYN, possibly due to middlebox interference, is specified in</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Section 3.1.4.)</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A TCP Server that confirms its support for AccECN (in response to an</td><td> </td><td class="right">   A TCP Server that confirms its support for AccECN (in response to an</td><td class="lineno"><br></td></tr>
      <tr id="diff0100"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   AccECN SYN from the <span class="delete">c</span>lient as described in Section 3.1) SHOULD</td><td> </td><td class="rblock">   AccECN SYN from the <span class="insert">C</span>lient as described in Section 3.1) SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   include an AccECN TCP Option on the SYN/ACK.</td><td> </td><td class="right">   include an AccECN TCP Option on the SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A TCP Client that has successfully negotiated AccECN SHOULD include</td><td> </td><td class="right">   A TCP Client that has successfully negotiated AccECN SHOULD include</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   an AccECN Option in the first ACK at the end of the 3WHS.  However,</td><td> </td><td class="right">   an AccECN Option in the first ACK at the end of the 3WHS.  However,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this first ACK is not delivered reliably, so the TCP Client SHOULD</td><td> </td><td class="right">   this first ACK is not delivered reliably, so the TCP Client SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   also include an AccECN Option on the first data segment it sends (if</td><td> </td><td class="right">   also include an AccECN Option on the first data segment it sends (if</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   it ever sends one).</td><td> </td><td class="right">   it ever sends one).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A host MAY omit an AccECN Option in any of the above three cases due</td><td> </td><td class="right">   A host MAY omit an AccECN Option in any of the above three cases due</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to insufficient option space or if it has cached knowledge that the</td><td> </td><td class="right">   to insufficient option space or if it has cached knowledge that the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-17" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-17"><em> page 34, line 30<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-17"><em> page 34, line 31<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the TCP Server has not received an ACK to acknowledge its SYN/ACK</td><td> </td><td class="right">   If the TCP Server has not received an ACK to acknowledge its SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   after the normal TCP timeout or it receives a second SYN with a</td><td> </td><td class="right">   after the normal TCP timeout or it receives a second SYN with a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   request for AccECN support, then either the SYN/ACK might just have</td><td> </td><td class="right">   request for AccECN support, then either the SYN/ACK might just have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   been lost, e.g. due to congestion, or a middlebox might be blocking</td><td> </td><td class="right">   been lost, e.g. due to congestion, or a middlebox might be blocking</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN Options.  To expedite connection setup, the TCP Server SHOULD</td><td> </td><td class="right">   AccECN Options.  To expedite connection setup, the TCP Server SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   retransmit the SYN/ACK repeating the same AE, CWR and ECE TCP flags</td><td> </td><td class="right">   retransmit the SYN/ACK repeating the same AE, CWR and ECE TCP flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   as on the original SYN/ACK but with no AccECN Option.  If this</td><td> </td><td class="right">   as on the original SYN/ACK but with no AccECN Option.  If this</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   retransmission times out, to expedite connection setup, the TCP</td><td> </td><td class="right">   retransmission times out, to expedite connection setup, the TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Server SHOULD disable AccECN and ECN for this connection by</td><td> </td><td class="right">   Server SHOULD disable AccECN and ECN for this connection by</td><td class="lineno"><br></td></tr>
      <tr id="diff0101"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   retransmitting the SYN/ACK with <span class="delete">AE=CWR=ECE=0</span> and no AccECN Option.</td><td> </td><td class="rblock">   retransmitting the SYN/ACK with <span class="insert">(AE,CWR,ECE) = (0,0,0)</span> and no AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   Option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0102"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">This</span> approach limits any interference by middleboxes that might drop</td><td> </td><td class="rblock">   <span class="insert">The above fall-back</span> approach limits any interference by middleboxes</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   packets with unknown options, even though it is more likely that <span class="delete">SYN/</span></td><td> </td><td class="rblock">   that might drop packets with unknown options, even though it is more</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   ACK</span> loss is due to congestion.  The TCP Server MAY try to send</td><td> </td><td class="rblock">   likely that <span class="insert">SYN/ACK</span> loss is due to congestion.  The TCP Server MAY</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   another packet with an AccECN Option at a later point during the</td><td> </td><td class="rblock">   try to send another packet with an AccECN Option at a later point</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   connection but it ought to monitor if that packet got lost as well,</td><td> </td><td class="rblock">   during the connection but it ought to monitor if that packet got lost</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   in which case it SHOULD disable the sending of AccECN Options for</td><td> </td><td class="rblock">   as well, in which case it SHOULD disable the sending of AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   this half-connection.</td><td> </td><td class="rblock">   Options for this half-connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Implementers MAY use other fall-back strategies if they are found to</td><td> </td><td class="right">   Implementers MAY use other fall-back strategies if they are found to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   be more effective (e.g. retrying an AccECN Option for a second time</td><td> </td><td class="right">   be more effective (e.g. retrying an AccECN Option for a second time</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   before fall-back - most appropriate during high levels of</td><td> </td><td class="right">   before fall-back - most appropriate during high levels of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   congestion).  However, other fall-back strategies will need to follow</td><td> </td><td class="right">   congestion).  However, other fall-back strategies will need to follow</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   all the rules in Section 3.1.5, which concern behaviour when SYNs or</td><td> </td><td class="right">   all the rules in Section 3.1.5, which concern behaviour when SYNs or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   SYN/ACKs negotiating different types of feedback have been sent</td><td> </td><td class="right">   SYN/ACKs negotiating different types of feedback have been sent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   within the same connection.</td><td> </td><td class="right">   within the same connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the TCP Client detects that the first data segment it sent with an</td><td> </td><td class="right">   If the TCP Client detects that the first data segment it sent with an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-18" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-18"><em> page 35, line 31<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-18"><em> page 35, line 32<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Similarly, an AccECN endpoint MAY separately memorize which data</td><td> </td><td class="right">   Similarly, an AccECN endpoint MAY separately memorize which data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   packets carried an AccECN Option and disable the sending of AccECN</td><td> </td><td class="right">   packets carried an AccECN Option and disable the sending of AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Options if the loss probability of those packets is significantly</td><td> </td><td class="right">   Options if the loss probability of those packets is significantly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   higher than that of all other data packets in the same connection.</td><td> </td><td class="right">   higher than that of all other data packets in the same connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.2.3.  Testing for Absence of the AccECN Option</td><td> </td><td class="right">3.2.3.2.3.  Testing for Absence of the AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the TCP Client has successfully negotiated AccECN but does not</td><td> </td><td class="right">   If the TCP Client has successfully negotiated AccECN but does not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   receive an AccECN Option on the SYN/ACK (e.g. because is has been</td><td> </td><td class="right">   receive an AccECN Option on the SYN/ACK (e.g. because is has been</td><td class="lineno"><br></td></tr>
      <tr id="diff0103"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   stripped by a middlebox or not sent by the <span class="delete">server), the c</span>lient</td><td> </td><td class="rblock">   stripped by a middlebox or not sent by the <span class="insert">Server), the C</span>lient</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   switches into a mode that assumes that the AccECN Option is not</td><td> </td><td class="right">   switches into a mode that assumes that the AccECN Option is not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available for this half connection.</td><td> </td><td class="right">   available for this half connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Similarly, if the TCP Server has successfully negotiated AccECN but</td><td> </td><td class="right">   Similarly, if the TCP Server has successfully negotiated AccECN but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   does not receive an AccECN Option on the first segment that</td><td> </td><td class="right">   does not receive an AccECN Option on the first segment that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   acknowledges sequence space at least covering the ISN, it switches</td><td> </td><td class="right">   acknowledges sequence space at least covering the ISN, it switches</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   into a mode that assumes that the AccECN Option is not available for</td><td> </td><td class="right">   into a mode that assumes that the AccECN Option is not available for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this half connection.</td><td> </td><td class="right">   this half connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   While a host is in this mode that assumes incoming AccECN Options are</td><td> </td><td class="right">   While a host is in this mode that assumes incoming AccECN Options are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-19" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-19"><em> page 36, line 21<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-19"><em> page 36, line 25<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.2.4</td><td> </td><td class="right">   Section 3.2.2.4</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.1 required the Data Receiver to initialize the r.e0b and</td><td> </td><td class="right">   Section 3.2.1 required the Data Receiver to initialize the r.e0b and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   r.e1b counters to a non-zero value.  Therefore, in either direction</td><td> </td><td class="right">   r.e1b counters to a non-zero value.  Therefore, in either direction</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the initial value of the EE0B field or EE1B field in an AccECN Option</td><td> </td><td class="right">   the initial value of the EE0B field or EE1B field in an AccECN Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   (if one exists) ought to be non-zero.  If AccECN has been negotiated:</td><td> </td><td class="right">   (if one exists) ought to be non-zero.  If AccECN has been negotiated:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  the TCP Server MAY check that the initial value of the EE0B field</td><td> </td><td class="right">   *  the TCP Server MAY check that the initial value of the EE0B field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      or the EE1B field is non-zero in the first segment that</td><td> </td><td class="right">      or the EE1B field is non-zero in the first segment that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      acknowledges sequence space that at least covers the ISN plus 1.</td><td> </td><td class="right">      acknowledges sequence space that at least covers the ISN plus 1.</td><td class="lineno"><br></td></tr>
      <tr id="diff0104"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      If it runs a test and either initial value is zero, the <span class="delete">s</span>erver</td><td> </td><td class="rblock">      If it runs a test and either initial value is zero, the <span class="insert">S</span>erver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      will switch into a mode that ignores AccECN Options for this half</td><td> </td><td class="right">      will switch into a mode that ignores AccECN Options for this half</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      connection.</td><td> </td><td class="right">      connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  the TCP Client MAY check the initial value of the EE0B field or</td><td> </td><td class="right">   *  the TCP Client MAY check the initial value of the EE0B field or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the EE1B field is non-zero on the SYN/ACK.  If it runs a test and</td><td> </td><td class="right">      the EE1B field is non-zero on the SYN/ACK.  If it runs a test and</td><td class="lineno"><br></td></tr>
      <tr id="diff0105"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      either initial value is zero, the <span class="delete">c</span>lient will switch into a mode</td><td> </td><td class="rblock">      either initial value is zero, the <span class="insert">C</span>lient will switch into a mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      that ignores AccECN Options for this half connection.</td><td> </td><td class="right">      that ignores AccECN Options for this half connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   While a host is in the mode that ignores AccECN Options it MUST adopt</td><td> </td><td class="right">   While a host is in the mode that ignores AccECN Options it MUST adopt</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the conservative interpretation of the ACE field discussed in</td><td> </td><td class="right">   the conservative interpretation of the ACE field discussed in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.2.5.</td><td> </td><td class="right">   Section 3.2.2.5.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Note that the Data Sender MUST NOT test whether the arriving byte</td><td> </td><td class="right">   Note that the Data Sender MUST NOT test whether the arriving byte</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counters in an initial AccECN Option have been initialized to</td><td> </td><td class="right">   counters in an initial AccECN Option have been initialized to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   specific valid values - the above checks solely test whether these</td><td> </td><td class="right">   specific valid values - the above checks solely test whether these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   fields have been incorrectly zeroed.  This allows hosts to use</td><td> </td><td class="right">   fields have been incorrectly zeroed.  This allows hosts to use</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-20" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-20"><em> page 37, line 29<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-20"><em> page 37, line 29<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   could also occur if a middlebox mangled an AccECN Option but not the</td><td> </td><td class="right">   could also occur if a middlebox mangled an AccECN Option but not the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACE field.  However, the Data Sender has to assume that the integrity</td><td> </td><td class="right">   ACE field.  However, the Data Sender has to assume that the integrity</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of AccECN Options is sound, based on the above test of the well-known</td><td> </td><td class="right">   of AccECN Options is sound, based on the above test of the well-known</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   initial values and optionally other integrity tests (Section 5.3).</td><td> </td><td class="right">   initial values and optionally other integrity tests (Section 5.3).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If either endpoint detects that the s.ceb counter has increased but</td><td> </td><td class="right">   If either endpoint detects that the s.ceb counter has increased but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the s.cep has not (and by testing ACK coverage it is certain how much</td><td> </td><td class="right">   the s.cep has not (and by testing ACK coverage it is certain how much</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the ACE field has wrapped), and if there is no explanation other than</td><td> </td><td class="right">   the ACE field has wrapped), and if there is no explanation other than</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   an invalid protocol transition due to some form of feedback mangling,</td><td> </td><td class="right">   an invalid protocol transition due to some form of feedback mangling,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the Data Sender MUST disable sending ECN-capable packets for the</td><td> </td><td class="right">   the Data Sender MUST disable sending ECN-capable packets for the</td><td class="lineno"><br></td></tr>
      <tr id="diff0106"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   remainder of the half-connection by setting the IP<span class="delete">/</span>ECN field in all</td><td> </td><td class="rblock">   remainder of the half-connection by setting the IP<span class="insert">-</span>ECN field in all</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   subsequent packets to Not-ECT.</td><td> </td><td class="right">   subsequent packets to Not-ECT.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">3.2.3.3.  Usage of the AccECN TCP Option</td><td> </td><td class="right">3.2.3.3.  Usage of the AccECN TCP Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If a Data Receiver in AccECN mode intends to use AccECN TCP Options</td><td> </td><td class="right">   If a Data Receiver in AccECN mode intends to use AccECN TCP Options</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to provide feedback, the rules below determine when it includes an</td><td> </td><td class="right">   to provide feedback, the rules below determine when it includes an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN TCP Option, and which fields to include, given other options</td><td> </td><td class="right">   AccECN TCP Option, and which fields to include, given other options</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   might be competing for limited option space:</td><td> </td><td class="right">   might be competing for limited option space:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Importance of Congestion Control:  AccECN is for congestion control,</td><td> </td><td class="right">   Importance of Congestion Control:  AccECN is for congestion control,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      which implementations SHOULD generally prioritize over other TCP</td><td> </td><td class="right">      which implementations SHOULD generally prioritize over other TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      options when there is insufficient space for all the options in</td><td> </td><td class="right">      options when there is insufficient space for all the options in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      use.</td><td> </td><td class="right">      use.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0107"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      If SACK has been <span class="delete">negotiated,</span> and the smallest recommended AccECN</td><td> </td><td class="rblock">      If SACK has been <span class="insert">negotiated [RFC2018],</span> and the smallest</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Option would leave insufficient space for two SACK blocks on a</td><td> </td><td class="rblock">      recommended AccECN Option would leave insufficient space for two</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      particular ACK, the Data Receiver MUST give precedence to the SACK</td><td> </td><td class="rblock">      SACK blocks on a particular ACK, the Data Receiver MUST give</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      option (total 18 octets), because loss feedback is more critical.</td><td> </td><td class="rblock">      precedence to the SACK option (total 18 octets), because loss</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">      feedback is more critical.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Recommended Simple Scheme:  The Data Receiver SHOULD include an</td><td> </td><td class="right">   Recommended Simple Scheme:  The Data Receiver SHOULD include an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      AccECN TCP Option on every scheduled ACK if any byte counter has</td><td> </td><td class="right">      AccECN TCP Option on every scheduled ACK if any byte counter has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      incremented since the last ACK.  Whenever possible, it SHOULD</td><td> </td><td class="right">      incremented since the last ACK.  Whenever possible, it SHOULD</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      include a field for every byte counter that has changed at some</td><td> </td><td class="right">      include a field for every byte counter that has changed at some</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      time during the connection (see examples later).</td><td> </td><td class="right">      time during the connection (see examples later).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      A scheduled ACK means an ACK that the Data Receiver would send by</td><td> </td><td class="right">      A scheduled ACK means an ACK that the Data Receiver would send by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      its regular delayed ACK rules.  Recall that Section 1.3 defines an</td><td> </td><td class="right">      its regular delayed ACK rules.  Recall that Section 1.3 defines an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      'ACK' as either with data payload or without.  But the above rule</td><td> </td><td class="right">      'ACK' as either with data payload or without.  But the above rule</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      is worded so that, in the common case when most of the data is</td><td> </td><td class="right">      is worded so that, in the common case when most of the data is</td><td class="lineno"><br></td></tr>
      <tr id="diff0108"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      from a <span class="delete">server</span> to a <span class="delete">client,</span> the <span class="delete">server</span> only includes an AccECN TCP</td><td> </td><td class="rblock">      from a <span class="insert">Server</span> to a <span class="insert">Client,</span> the <span class="insert">Server</span> only includes an AccECN TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Option while it is acknowledging data from the <span class="delete">client.</span></td><td> </td><td class="rblock">      Option while it is acknowledging data from the <span class="insert">Client.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When available TCP option space is limited on particular packets, the</td><td> </td><td class="right">   When available TCP option space is limited on particular packets, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   recommended scheme will need to include compromises.  To guide the</td><td> </td><td class="right">   recommended scheme will need to include compromises.  To guide the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   implementer the rules below are ranked in order of importance, but</td><td> </td><td class="right">   implementer the rules below are ranked in order of importance, but</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the final decision has to be implementation-dependent, because</td><td> </td><td class="right">   the final decision has to be implementation-dependent, because</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   tradeoffs will alter as new TCP options are defined and new use-cases</td><td> </td><td class="right">   tradeoffs will alter as new TCP options are defined and new use-cases</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   arise.</td><td> </td><td class="right">   arise.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Necessary Option Length:  The Data Receiver MUST only include an</td><td> </td><td class="right">   Necessary Option Length:  The Data Receiver MUST only include an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      AccECN TCP Option on a packet if it includes all the counter(s)</td><td> </td><td class="right">      AccECN TCP Option on a packet if it includes all the counter(s)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-21" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-21"><em> page 39, line 27<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-21"><em> page 39, line 27<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The recommended scheme is intended as a simple way to ensure that all</td><td> </td><td class="right">   The recommended scheme is intended as a simple way to ensure that all</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the relevant byte counters will be carried on any ACK that reaches</td><td> </td><td class="right">   the relevant byte counters will be carried on any ACK that reaches</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the Data Sender, no matter how many pure ACKs are filtered or</td><td> </td><td class="right">   the Data Sender, no matter how many pure ACKs are filtered or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   coalesced along the network path, and without consuming the space</td><td> </td><td class="right">   coalesced along the network path, and without consuming the space</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   available for payload data with counter field(s) that have never</td><td> </td><td class="right">   available for payload data with counter field(s) that have never</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   changed.</td><td> </td><td class="right">   changed.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   As an example of the recommended scheme, if ECT(0) is the only</td><td> </td><td class="right">   As an example of the recommended scheme, if ECT(0) is the only</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   codepoint that has ever arrived in the IP-ECN field, the Data</td><td> </td><td class="right">   codepoint that has ever arrived in the IP-ECN field, the Data</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Receiver will feed back an AccECN0 TCP Option with only the EE0B</td><td> </td><td class="right">   Receiver will feed back an AccECN0 TCP Option with only the EE0B</td><td class="lineno"><br></td></tr>
      <tr id="diff0109"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   field on every <span class="delete">packet.</span>  However, as soon as even one CE-marked packet</td><td> </td><td class="rblock">   field on every <span class="insert">packet that acknowledges new data.</span>  However, as soon</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   arrives, on every packet that acknowledges new data it will start to</td><td> </td><td class="rblock">   as even one CE-marked packet arrives, on every packet that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   include an option with two fields, EE0B and ECEB.  As a second</td><td> </td><td class="rblock">   acknowledges new data it will start to include an option with two</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   example, if the first packet to arrive happens to be CE-marked, the</td><td> </td><td class="rblock">   fields, EE0B and ECEB.  As a second example, if the first packet to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Data Receiver will have to arbitrarily choose whether to precede the</td><td> </td><td class="rblock">   arrive happens to be CE-marked, the Data Receiver will have to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECEB field with an EE0B field or an EE1B field.  If it chooses, say,</td><td> </td><td class="rblock">   arbitrarily choose whether to precede the ECEB field with an EE0B</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   EEB0 but it turns out never to receive ECT(0), it can start sending</td><td> </td><td class="rblock">   field or an EE1B field.  If it chooses, say, EEB0 but it turns out</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   EE1B and ECEB instead - it does not have to include the EE0B field if</td><td> </td><td class="rblock">   never to receive ECT(0), it can start sending EE1B and ECEB instead -</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the r.e0b counter has never changed during the connection.</td><td> </td><td class="rblock">   it does not have to include the EE0B field if the r.e0b counter has</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">   never changed during the connection.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   With the recommended scheme, if the data sending direction switches</td><td> </td><td class="right">   With the recommended scheme, if the data sending direction switches</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   during a connection, there can be cases where the AccECN TCP Option</td><td> </td><td class="right">   during a connection, there can be cases where the AccECN TCP Option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that is meant to feed back the counter values at the end of a volley</td><td> </td><td class="right">   that is meant to feed back the counter values at the end of a volley</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in one direction never reaches the other peer, due to packet loss.</td><td> </td><td class="right">   in one direction never reaches the other peer, due to packet loss.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ACE feedback ought to be sufficient to fill this gap, given accurate</td><td> </td><td class="right">   ACE feedback ought to be sufficient to fill this gap, given accurate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feedback becomes moot after data transmission has paused.</td><td> </td><td class="right">   feedback becomes moot after data transmission has paused.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Appendix A.3 gives an example algorithm to estimate the number of</td><td> </td><td class="right">   Appendix A.3 gives an example algorithm to estimate the number of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   marked bytes from the ACE field alone, if AccECN Options are not</td><td> </td><td class="right">   marked bytes from the ACE field alone, if AccECN Options are not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-22" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-22"><em> page 44, line 26<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-22"><em> page 44, line 26<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This section is informative, not normative.</td><td> </td><td class="right">   This section is informative, not normative.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">5.1.  Compatibility with SYN Cookies</td><td> </td><td class="right">5.1.  Compatibility with SYN Cookies</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   A TCP Server can use SYN Cookies (see Appendix A of [RFC4987]) to</td><td> </td><td class="right">   A TCP Server can use SYN Cookies (see Appendix A of [RFC4987]) to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   protect itself from SYN flooding attacks.  It places minimal commonly</td><td> </td><td class="right">   protect itself from SYN flooding attacks.  It places minimal commonly</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   used connection state in the SYN/ACK, and deliberately does not hold</td><td> </td><td class="right">   used connection state in the SYN/ACK, and deliberately does not hold</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   any state while waiting for the subsequent ACK (e.g. it closes the</td><td> </td><td class="right">   any state while waiting for the subsequent ACK (e.g. it closes the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   thread).  Therefore it cannot record the fact that it entered AccECN</td><td> </td><td class="right">   thread).  Therefore it cannot record the fact that it entered AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   mode for both half-connections.  Indeed, it cannot even remember</td><td> </td><td class="right">   mode for both half-connections.  Indeed, it cannot even remember</td><td class="lineno"><br></td></tr>
      <tr id="diff0110"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   whether it negotiated the use of <span class="delete">c</span>lassic ECN [RFC3168].</td><td> </td><td class="rblock">   whether it negotiated the use of <span class="insert">C</span>lassic ECN [RFC3168].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0111"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Nonetheless, such a <span class="delete">s</span>erver can determine that it negotiated AccECN as</td><td> </td><td class="rblock">   Nonetheless, such a <span class="insert">S</span>erver can determine that it negotiated AccECN as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   follows.  If a TCP Server using SYN Cookies supports AccECN and if it</td><td> </td><td class="right">   follows.  If a TCP Server using SYN Cookies supports AccECN and if it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   receives a pure ACK that acknowledges an ISN that is a valid SYN</td><td> </td><td class="right">   receives a pure ACK that acknowledges an ISN that is a valid SYN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   cookie, and if the ACK contains an ACE field with the value 0b010 to</td><td> </td><td class="right">   cookie, and if the ACK contains an ACE field with the value 0b010 to</td><td class="lineno"><br></td></tr>
      <tr id="diff0112"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   0b111 (decimal 2 to 7), the <span class="delete">s</span>erver can infer the first two stages of</td><td> </td><td class="rblock">   0b111 (decimal 2 to 7), the <span class="insert">S</span>erver can infer the first two stages of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the handshake:</td><td> </td><td class="right">   the handshake:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   *  the TCP Client has to have requested AccECN support on the SYN;</td><td> </td><td class="right">   *  the TCP Client has to have requested AccECN support on the SYN;</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0113"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   *  then, even though the <span class="delete">s</span>erver kept no state, it has to have</td><td> </td><td class="rblock">   *  then, even though the <span class="insert">S</span>erver kept no state, it has to have</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      confirmed that it supported AccECN.</td><td> </td><td class="right">      confirmed that it supported AccECN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0114"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Therefore the <span class="delete">s</span>erver can switch itself into AccECN mode, and continue</td><td> </td><td class="rblock">   Therefore the <span class="insert">S</span>erver can switch itself into AccECN mode, and continue</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   as if it had never forgotten that it switched itself into AccECN mode</td><td> </td><td class="right">   as if it had never forgotten that it switched itself into AccECN mode</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   earlier.</td><td> </td><td class="right">   earlier.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If the pure ACK that acknowledges a SYN cookie contains an ACE field</td><td> </td><td class="right">   If the pure ACK that acknowledges a SYN cookie contains an ACE field</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   with the value 0b000 or 0b001, these values indicate that the TCP</td><td> </td><td class="right">   with the value 0b000 or 0b001, these values indicate that the TCP</td><td class="lineno"><br></td></tr>
      <tr id="diff0115"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Client did not request support for AccECN and therefore the <span class="delete">s</span>erver</td><td> </td><td class="rblock">   Client did not request support for AccECN and therefore the <span class="insert">S</span>erver</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   does not enter AccECN mode for this connection.  Further, 0b001 on</td><td> </td><td class="right">   does not enter AccECN mode for this connection.  Further, 0b001 on</td><td class="lineno"><br></td></tr>
      <tr id="diff0116"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the ACK implies that the <span class="delete">s</span>erver sent an ECN-capable SYN/ACK, which</td><td> </td><td class="rblock">   the ACK implies that the <span class="insert">S</span>erver sent an ECN-capable SYN/ACK, which</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   was marked CE in the network, and the non-AccECN TCP Client fed this</td><td> </td><td class="right">   was marked CE in the network, and the non-AccECN TCP Client fed this</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   back by setting ECE on the ACK of the SYN/ACK.</td><td> </td><td class="right">   back by setting ECE on the ACK of the SYN/ACK.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">5.2.  Compatibility with TCP Experiments and Common TCP Options</td><td> </td><td class="right">5.2.  Compatibility with TCP Experiments and Common TCP Options</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN is compatible (at least on paper) with the most commonly used</td><td> </td><td class="right">   AccECN is compatible (at least on paper) with the most commonly used</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   TCP options: MSS, time-stamp, window scaling, SACK and TCP-AO.  It is</td><td> </td><td class="right">   TCP options: MSS, time-stamp, window scaling, SACK and TCP-AO.  It is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   also compatible with Multipath TCP (MPTCP [RFC8684]) and the</td><td> </td><td class="right">   also compatible with Multipath TCP (MPTCP [RFC8684]) and the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   experimental TCP option TCP Fast Open (TFO [RFC7413]).  AccECN is</td><td> </td><td class="right">   experimental TCP option TCP Fast Open (TFO [RFC7413]).  AccECN is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   friendly to all these protocols, because space for TCP options is</td><td> </td><td class="right">   friendly to all these protocols, because space for TCP options is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-23" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-23"><em> page 45, line 25<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-23"><em> page 45, line 25<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   When option space is under pressure from other options,</td><td> </td><td class="right">   When option space is under pressure from other options,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 3.2.3.3 provides guidance on how important it is to send an</td><td> </td><td class="right">   Section 3.2.3.3 provides guidance on how important it is to send an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN Option relative to other options, and which fields are more</td><td> </td><td class="right">   AccECN Option relative to other options, and which fields are more</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   important to include.</td><td> </td><td class="right">   important to include.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Implementers of TFO need to take careful note of the recommendation</td><td> </td><td class="right">   Implementers of TFO need to take careful note of the recommendation</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   in Section 3.2.2.1.  That section recommends that, if the TCP Client</td><td> </td><td class="right">   in Section 3.2.2.1.  That section recommends that, if the TCP Client</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   has successfully negotiated AccECN, when acknowledging the SYN/ACK,</td><td> </td><td class="right">   has successfully negotiated AccECN, when acknowledging the SYN/ACK,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   even if it has data to send, it sends a pure ACK immediately before</td><td> </td><td class="right">   even if it has data to send, it sends a pure ACK immediately before</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the data.  Then it can reflect the IP-ECN field of the SYN/ACK on</td><td> </td><td class="right">   the data.  Then it can reflect the IP-ECN field of the SYN/ACK on</td><td class="lineno"><br></td></tr>
      <tr id="diff0117"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   this pure ACK, which allows the <span class="delete">s</span>erver to detect ECN mangling.  Note</td><td> </td><td class="rblock">   this pure ACK, which allows the <span class="insert">S</span>erver to detect ECN mangling.  Note</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that, as specified in Section 3.2, any data on the SYN (SYN=1, ACK=0)</td><td> </td><td class="right">   that, as specified in Section 3.2, any data on the SYN (SYN=1, ACK=0)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   is not included in any of the byte counters held locally for each ECN</td><td> </td><td class="right">   is not included in any of the byte counters held locally for each ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   marking, nor in the AccECN Option on the wire.</td><td> </td><td class="right">   marking, nor in the AccECN Option on the wire.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">5.3.  Compatibility with Feedback Integrity Mechanisms</td><td> </td><td class="right">5.3.  Compatibility with Feedback Integrity Mechanisms</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Three alternative mechanisms are available to assure the integrity of</td><td> </td><td class="right">   Three alternative mechanisms are available to assure the integrity of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN and/or loss signals.  AccECN is compatible with any of these</td><td> </td><td class="right">   ECN and/or loss signals.  AccECN is compatible with any of these</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   approaches:</td><td> </td><td class="right">   approaches:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-24" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-24"><em> page 46, line 26<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-24"><em> page 46, line 26<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      can be used to detect any tampering with AccECN feedback between</td><td> </td><td class="right">      can be used to detect any tampering with AccECN feedback between</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the Data Receiver and the Data Sender (whether malicious or</td><td> </td><td class="right">      the Data Receiver and the Data Sender (whether malicious or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      accidental).  The AccECN fields are immutable end-to-end, so they</td><td> </td><td class="right">      accidental).  The AccECN fields are immutable end-to-end, so they</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      are amenable to TCP-AO protection, which covers TCP options by</td><td> </td><td class="right">      are amenable to TCP-AO protection, which covers TCP options by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      default.  However, TCP-AO is often too brittle to use on many end-</td><td> </td><td class="right">      default.  However, TCP-AO is often too brittle to use on many end-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      to-end paths, where middleboxes can make verification fail in</td><td> </td><td class="right">      to-end paths, where middleboxes can make verification fail in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      their attempts to improve performance or security, e.g. Network</td><td> </td><td class="right">      their attempts to improve performance or security, e.g. Network</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Address (and Port) Translation (NAT/NAPT), resegmentation or</td><td> </td><td class="right">      Address (and Port) Translation (NAT/NAPT), resegmentation or</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      shifting the sequence space.</td><td> </td><td class="right">      shifting the sequence space.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0118"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   <span class="delete">Originally the ECN Nonce [RFC3540] was proposed to ensure integrity</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   of congestion feedback.  With minor changes AccECN could be optimized</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   for the possibility that the ECT(1) codepoint might be used as an ECN</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   Nonce.  However, given RFC 3540 has been reclassified as historic,</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   the AccECN design has been generalized so that it ought to be able to</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   support other possible uses of the ECT(1) codepoint, such as a lower</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">   severity or a more instant congestion signal than CE.</span></td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">                                                                         </td><td> </td><td class="rblock"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">6.  Summary: Protocol Properties</td><td> </td><td class="right">6.  Summary: Protocol Properties</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   This section is informative not normative.  It describes how well the</td><td> </td><td class="right">   This section is informative not normative.  It describes how well the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   protocol satisfies the agreed requirements for a more accurate ECN</td><td> </td><td class="right">   protocol satisfies the agreed requirements for a more accurate ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   feedback protocol [RFC7560].</td><td> </td><td class="right">   feedback protocol [RFC7560].</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Accuracy:  From each ACK, the Data Sender can infer the number of new</td><td> </td><td class="right">   Accuracy:  From each ACK, the Data Sender can infer the number of new</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      CE marked segments since the previous ACK.  This provides better</td><td> </td><td class="right">      CE marked segments since the previous ACK.  This provides better</td><td class="lineno"><br></td></tr>
      <tr id="diff0119"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      accuracy on CE feedback than <span class="delete">c</span>lassic ECN.  In addition if an</td><td> </td><td class="rblock">      accuracy on CE feedback than <span class="insert">C</span>lassic ECN.  In addition if an</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      AccECN Option is present (not blocked by the network path) the</td><td> </td><td class="right">      AccECN Option is present (not blocked by the network path) the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      number of bytes marked with CE, ECT(1) and ECT(0) are provided.</td><td> </td><td class="right">      number of bytes marked with CE, ECT(1) and ECT(0) are provided.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Overhead:  The AccECN scheme is divided into two parts.  The</td><td> </td><td class="right">   Overhead:  The AccECN scheme is divided into two parts.  The</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      essential part reuses the 3 flags already assigned to ECN in the</td><td> </td><td class="right">      essential part reuses the 3 flags already assigned to ECN in the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      TCP header.  The supplementary part adds an additional TCP option</td><td> </td><td class="right">      TCP header.  The supplementary part adds an additional TCP option</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      consuming up to 11 bytes.  However, no TCP option space is</td><td> </td><td class="right">      consuming up to 11 bytes.  However, no TCP option space is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      consumed in the SYN.</td><td> </td><td class="right">      consumed in the SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Ordering:  The order in which marks arrive at the Data Receiver is</td><td> </td><td class="right">   Ordering:  The order in which marks arrive at the Data Receiver is</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-25" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-25"><em> page 47, line 40<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-25"><em> page 47, line 33<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Resilience against Bias:  Because feedback is based on repetition of</td><td> </td><td class="right">   Resilience against Bias:  Because feedback is based on repetition of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      counters, random losses do not remove any information, they only</td><td> </td><td class="right">      counters, random losses do not remove any information, they only</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      delay it.  Therefore, even though some ACKs are change-triggered,</td><td> </td><td class="right">      delay it.  Therefore, even though some ACKs are change-triggered,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      random losses will not alter the proportions of the different ECN</td><td> </td><td class="right">      random losses will not alter the proportions of the different ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      markings in the feedback.</td><td> </td><td class="right">      markings in the feedback.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Resilience vs Overhead:  If space is limited in some segments</td><td> </td><td class="right">   Resilience vs Overhead:  If space is limited in some segments</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      (e.g. because more options are needed on some segments, such as</td><td> </td><td class="right">      (e.g. because more options are needed on some segments, such as</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the SACK option after loss), the Data Receiver can send AccECN</td><td> </td><td class="right">      the SACK option after loss), the Data Receiver can send AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Options less frequently or truncate fields that have not changed,</td><td> </td><td class="right">      Options less frequently or truncate fields that have not changed,</td><td class="lineno"><br></td></tr>
      <tr id="diff0120"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      usually down to as little as 5 bytes.  <span class="delete">However, it has to send a</span></td><td> </td><td class="rblock">      usually down to as little as 5 bytes.</td><td class="lineno">!!<br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      full-sized AccECN Option at least three times per RTT, which the</span></td><td> </td><td class="rblock"><br></td><td class="lineno">!!<br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><span class="delete">      Data Sender can rely on as a regular beacon or checkpoint.</span></td><td> </td><td class="rblock"><br></td><td class="lineno">!!<br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Resilience vs Timeliness and Ordering:  Ordering information and the</td><td> </td><td class="right">   Resilience vs Timeliness and Ordering:  Ordering information and the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      timing of transitions cannot be communicated in three cases: i)</td><td> </td><td class="right">      timing of transitions cannot be communicated in three cases: i)</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      during ACK loss; ii) if something on the path strips AccECN</td><td> </td><td class="right">      during ACK loss; ii) if something on the path strips AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Options; or iii) if the Data Receiver is unable to support Change-</td><td> </td><td class="right">      Options; or iii) if the Data Receiver is unable to support Change-</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Triggered ACKs.  Following ACK reordering, the Data Sender can</td><td> </td><td class="right">      Triggered ACKs.  Following ACK reordering, the Data Sender can</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      reconstruct the order in which feedback was sent, but not until</td><td> </td><td class="right">      reconstruct the order in which feedback was sent, but not until</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      all the missing feedback has arrived.</td><td> </td><td class="right">      all the missing feedback has arrived.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Complexity:  An AccECN implementation solely involves simple counter</td><td> </td><td class="right">   Complexity:  An AccECN implementation solely involves simple counter</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-26" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-26"><em> page 60, line 44<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-26"><em> page 60, line 44<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   bytes arrive marked as Not-ECT.  Therefore there ought to be no need</td><td> </td><td class="right">   bytes arrive marked as Not-ECT.  Therefore there ought to be no need</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to keep track of the details of retransmissions.</td><td> </td><td class="right">   to keep track of the details of retransmissions.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Appendix B.  Rationale for Usage of TCP Header Flags</td><td> </td><td class="right">Appendix B.  Rationale for Usage of TCP Header Flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">B.1.  Three TCP Header Flags in the SYN-SYN/ACK Handshake</td><td> </td><td class="right">B.1.  Three TCP Header Flags in the SYN-SYN/ACK Handshake</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN uses a rather unorthodox approach to negotiate the highest</td><td> </td><td class="right">   AccECN uses a rather unorthodox approach to negotiate the highest</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   version TCP ECN feedback scheme that both ends support, as justified</td><td> </td><td class="right">   version TCP ECN feedback scheme that both ends support, as justified</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   below.  It follows from the original TCP ECN capability negotiation</td><td> </td><td class="right">   below.  It follows from the original TCP ECN capability negotiation</td><td class="lineno"><br></td></tr>
      <tr id="diff0121"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   [RFC3168], in which the <span class="delete">c</span>lient set the 2 least significant of the</td><td> </td><td class="rblock">   [RFC3168], in which the <span class="insert">C</span>lient set the 2 least significant of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   original reserved flags in the TCP header, and fell back to no ECN</td><td> </td><td class="right">   original reserved flags in the TCP header, and fell back to no ECN</td><td class="lineno"><br></td></tr>
      <tr id="diff0122"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   support if the <span class="delete">s</span>erver responded with the 2 flags cleared, which had</td><td> </td><td class="rblock">   support if the <span class="insert">S</span>erver responded with the 2 flags cleared, which had</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   previously been the default.</td><td> </td><td class="right">   previously been the default.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Classic ECN used header flags rather than a TCP option because it was</td><td> </td><td class="right">   Classic ECN used header flags rather than a TCP option because it was</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   considered more efficient to use a header flag for 1 bit of feedback</td><td> </td><td class="right">   considered more efficient to use a header flag for 1 bit of feedback</td><td class="lineno"><br></td></tr>
      <tr id="diff0123"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   per ACK, and this bit could be overloaded to indicate support for ECN</td><td> </td><td class="rblock">   per ACK, and this bit could be overloaded to indicate support for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   during the handshake.  During the development of ECN, 1 bit crept up</td><td> </td><td class="rblock">   <span class="insert">Classic</span> ECN during the handshake.  During the development of ECN, 1</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   to 2, in order to deliver the feedback reliably and to work round</td><td> </td><td class="rblock">   bit crept up to 2, in order to deliver the feedback reliably and to</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   some broken hosts that reflected the reserved flags during the</td><td> </td><td class="rblock">   work round some broken hosts that reflected the reserved flags during</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   handshake.</td><td> </td><td class="rblock">   the handshake.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   In order to be backward compatible with RFC 3168, AccECN continues</td><td> </td><td class="right">   In order to be backward compatible with RFC 3168, AccECN continues</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   this approach, using the 3rd least significant TCP header flag that</td><td> </td><td class="right">   this approach, using the 3rd least significant TCP header flag that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   had previously been allocated for the ECN nonce (now historic).</td><td> </td><td class="right">   had previously been allocated for the ECN nonce (now historic).</td><td class="lineno"><br></td></tr>
      <tr id="diff0124"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Then, whatever form of <span class="delete">server an AccECN c</span>lient encounters, the</td><td> </td><td class="rblock">   Then, whatever form of <span class="insert">Server an AccECN C</span>lient encounters, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   connection can fall back to the highest version of feedback protocol</td><td> </td><td class="right">   connection can fall back to the highest version of feedback protocol</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that both ends support, as explained in Section 3.1.</td><td> </td><td class="right">   that both ends support, as explained in Section 3.1.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   If AccECN capability negotiation had used the more orthodox approach</td><td> </td><td class="right">   If AccECN capability negotiation had used the more orthodox approach</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of a TCP option, it would still have had to set the two ECN flags in</td><td> </td><td class="right">   of a TCP option, it would still have had to set the two ECN flags in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the main TCP header, in order to be able to fall back to Classic RFC</td><td> </td><td class="right">   the main TCP header, in order to be able to fall back to Classic RFC</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   3168 ECN, or to disable ECN support, without another round of</td><td> </td><td class="right">   3168 ECN, or to disable ECN support, without another round of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   negotiation.  Then AccECN would also have had to handle all the</td><td> </td><td class="right">   negotiation.  Then AccECN would also have had to handle all the</td><td class="lineno"><br></td></tr>
      <tr id="diff0125"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   different ways that <span class="delete">s</span>ervers currently respond to settings of the ECN</td><td> </td><td class="rblock">   different ways that <span class="insert">S</span>ervers currently respond to settings of the ECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   flags in the main TCP header, including all the conflicting cases</td><td> </td><td class="right">   flags in the main TCP header, including all the conflicting cases</td><td class="lineno"><br></td></tr>
      <tr id="diff0126"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   where a <span class="delete">s</span>erver might have said it supported one approach in the flags</td><td> </td><td class="rblock">   where a <span class="insert">S</span>erver might have said it supported one approach in the flags</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   and another approach in a new TCP option.  And AccECN would have had</td><td> </td><td class="right">   and another approach in a new TCP option.  And AccECN would have had</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   to deal with all the additional possibilities where a middlebox might</td><td> </td><td class="right">   to deal with all the additional possibilities where a middlebox might</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   have mangled the ECN flags, or removed TCP options.  Thus, usage of</td><td> </td><td class="right">   have mangled the ECN flags, or removed TCP options.  Thus, usage of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the 3rd reserved TCP header flag simplified the protocol.</td><td> </td><td class="right">   the 3rd reserved TCP header flag simplified the protocol.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   The third flag was used in a way that could be distinguished from the</td><td> </td><td class="right">   The third flag was used in a way that could be distinguished from the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN nonce, in case any nonce deployment was encountered.  Previous</td><td> </td><td class="right">   ECN nonce, in case any nonce deployment was encountered.  Previous</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   usage of this flag for the ECN nonce was integrated into the original</td><td> </td><td class="right">   usage of this flag for the ECN nonce was integrated into the original</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN negotiation.  This further justified the 3rd flag's use for</td><td> </td><td class="right">   ECN negotiation.  This further justified the 3rd flag's use for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   AccECN, because a non-ECN usage of this flag would have had to use it</td><td> </td><td class="right">   AccECN, because a non-ECN usage of this flag would have had to use it</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="part-27" class="change"><td><br></td><th><small>skipping to change at</small><a href="#part-27"><em> page 61, line 44<span class="hide"> ¶</span></em></a></th><th> <br>
</th><th><small>skipping to change at</small><a href="#part-27"><em> page 61, line 44<span class="hide"> ¶</span></em></a></th><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   ECN flags.</td><td> </td><td class="right">   ECN flags.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Indeed, having overloaded the original uses of these three flags for</td><td> </td><td class="right">   Indeed, having overloaded the original uses of these three flags for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   its handshake, AccECN overloads all three bits again as a 3-bit</td><td> </td><td class="right">   its handshake, AccECN overloads all three bits again as a 3-bit</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   counter.</td><td> </td><td class="right">   counter.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">B.2.  Four Codepoints in the SYN/ACK</td><td> </td><td class="right">B.2.  Four Codepoints in the SYN/ACK</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Of the 8 possible codepoints that the 3 TCP header flags can indicate</td><td> </td><td class="right">   Of the 8 possible codepoints that the 3 TCP header flags can indicate</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   on the SYN/ACK, 4 already indicated earlier (or broken) versions of</td><td> </td><td class="right">   on the SYN/ACK, 4 already indicated earlier (or broken) versions of</td><td class="lineno"><br></td></tr>
      <tr id="diff0127"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   ECN support.  In the early design of AccECN, an AccECN <span class="delete">s</span>erver could</td><td> </td><td class="rblock">   ECN support.  In the early design of AccECN, an AccECN <span class="insert">S</span>erver could</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   use only 2 of the 4 remaining codepoints.  They both indicated AccECN</td><td> </td><td class="right">   use only 2 of the 4 remaining codepoints.  They both indicated AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   support, but one fed back that the SYN had arrived marked as CE.</td><td> </td><td class="right">   support, but one fed back that the SYN had arrived marked as CE.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Even though ECN support on a SYN is not yet on the standards track,</td><td> </td><td class="right">   Even though ECN support on a SYN is not yet on the standards track,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   the idea is for either end to act as a mechanistic reflector, so that</td><td> </td><td class="right">   the idea is for either end to act as a mechanistic reflector, so that</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   future capabilities can be unilaterally deployed without requiring</td><td> </td><td class="right">   future capabilities can be unilaterally deployed without requiring</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   2-ended deployment (justified in Section 2.5).</td><td> </td><td class="right">   2-ended deployment (justified in Section 2.5).</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr id="diff0128"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   During traversal testing it was discovered that the <span class="delete">ECN</span> field in the</td><td> </td><td class="rblock">   During traversal testing it was discovered that the <span class="insert">IP-ECN</span> field in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   SYN was mangled on a non-negligible proportion of paths.  Therefore</td><td> </td><td class="rblock">   the SYN was mangled on a non-negligible proportion of paths.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   it was necessary to allow the SYN/ACK to feed all four <span class="delete">IP/ECN</span></td><td> </td><td class="rblock">   Therefore it was necessary to allow the SYN/ACK to feed all four <span class="insert">IP-</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   codepoints that the SYN could arrive with back to the <span class="delete">client.</span></td><td> </td><td class="rblock"><span class="insert">   ECN</span> codepoints that the SYN could arrive with back to the <span class="insert">Client.</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Without this, the <span class="delete">client</span> could not know whether to disable ECN for</td><td> </td><td class="rblock">   Without this, the <span class="insert">Client</span> could not know whether to disable ECN for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   the connection due to mangling of the <span class="delete">IP/ECN</span> field (also explained in</td><td> </td><td class="rblock">   the connection due to mangling of the <span class="insert">IP-ECN</span> field (also explained in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Section 2.5).  This development consumed the remaining 2 codepoints</td><td> </td><td class="right">   Section 2.5).  This development consumed the remaining 2 codepoints</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   on the SYN/ACK that had been reserved for future use by AccECN in</td><td> </td><td class="right">   on the SYN/ACK that had been reserved for future use by AccECN in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   earlier versions.</td><td> </td><td class="right">   earlier versions.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">B.3.  Space for Future Evolution</td><td> </td><td class="right">B.3.  Space for Future Evolution</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Despite availability of usable TCP header space being extremely</td><td> </td><td class="right">   Despite availability of usable TCP header space being extremely</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   scarce, the AccECN protocol has taken all possible steps to ensure</td><td> </td><td class="right">   scarce, the AccECN protocol has taken all possible steps to ensure</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   that there is space to negotiate possible future variants of the</td><td> </td><td class="right">   that there is space to negotiate possible future variants of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   protocol, either if a variant of AccECN is required, or if a</td><td> </td><td class="right">   protocol, either if a variant of AccECN is required, or if a</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   completely different ECN feedback approach is needed:</td><td> </td><td class="right">   completely different ECN feedback approach is needed:</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Future AccECN variants:  When the AccECN capability is negotiated</td><td> </td><td class="right">   Future AccECN variants:  When the AccECN capability is negotiated</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      during TCP's 3WHS, the rows in Table 2 tagged as 'Nonce' and</td><td> </td><td class="right">      during TCP's 3WHS, the rows in Table 2 tagged as 'Nonce' and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      'Broken' in the column for the capability of node B are unused by</td><td> </td><td class="right">      'Broken' in the column for the capability of node B are unused by</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      any current protocol in the RFC series.  These could be used by</td><td> </td><td class="right">      any current protocol in the RFC series.  These could be used by</td><td class="lineno"><br></td></tr>
      <tr id="diff0129"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      TCP <span class="delete">s</span>ervers in future to indicate a variant of the AccECN</td><td> </td><td class="rblock">      TCP <span class="insert">S</span>ervers in future to indicate a variant of the AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      protocol.  In recent measurement studies in which the response of</td><td> </td><td class="right">      protocol.  In recent measurement studies in which the response of</td><td class="lineno"><br></td></tr>
      <tr id="diff0130"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      large numbers of <span class="delete">s</span>ervers to an AccECN SYN has been tested,</td><td> </td><td class="rblock">      large numbers of <span class="insert">S</span>ervers to an AccECN SYN has been tested,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      e.g. [Mandalari18], a very small number of SYN/ACKs arrive with</td><td> </td><td class="right">      e.g. [Mandalari18], a very small number of SYN/ACKs arrive with</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the pattern tagged as 'Nonce', and a small but more significant</td><td> </td><td class="right">      the pattern tagged as 'Nonce', and a small but more significant</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      number arrive with the pattern tagged as 'Broken'.  The 'Nonce'</td><td> </td><td class="right">      number arrive with the pattern tagged as 'Broken'.  The 'Nonce'</td><td class="lineno"><br></td></tr>
      <tr id="diff0131"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      pattern could be a sign that a few <span class="delete">s</span>ervers have implemented the</td><td> </td><td class="rblock">      pattern could be a sign that a few <span class="insert">S</span>ervers have implemented the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      ECN Nonce [RFC3540], which has now been reclassified as historic</td><td> </td><td class="right">      ECN Nonce [RFC3540], which has now been reclassified as historic</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      [RFC8311], or it could be the random result of some unknown</td><td> </td><td class="right">      [RFC8311], or it could be the random result of some unknown</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      middlebox behaviour.  The greater prevalence of the 'Broken'</td><td> </td><td class="right">      middlebox behaviour.  The greater prevalence of the 'Broken'</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      pattern suggests that some instances still exist of the broken</td><td> </td><td class="right">      pattern suggests that some instances still exist of the broken</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      code that reflects the reserved flags on the SYN.</td><td> </td><td class="right">      code that reflects the reserved flags on the SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      The requirement not to reject unexpected initial values of the ACE</td><td> </td><td class="right">      The requirement not to reject unexpected initial values of the ACE</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      counter (in the main TCP header) in the last paragraph of</td><td> </td><td class="right">      counter (in the main TCP header) in the last paragraph of</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Section 3.2.2.4 ensures that 3 unused codepoints on the ACK of the</td><td> </td><td class="right">      Section 3.2.2.4 ensures that 3 unused codepoints on the ACK of the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      SYN/ACK, 6 unused values on the first SYN=0 data packet from the</td><td> </td><td class="right">      SYN/ACK, 6 unused values on the first SYN=0 data packet from the</td><td class="lineno"><br></td></tr>
      <tr id="diff0132"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">client</span> and 7 unused values on the first SYN=0 data packet from the</td><td> </td><td class="rblock">      <span class="insert">Client</span> and 7 unused values on the first SYN=0 data packet from the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">server</span> could be used to declare future variants of the AccECN</td><td> </td><td class="rblock">      <span class="insert">Server</span> could be used to declare future variants of the AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      protocol.  The word 'declare' is used rather than 'negotiate'</td><td> </td><td class="right">      protocol.  The word 'declare' is used rather than 'negotiate'</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      because, at this late stage in the 3WHS, it would be too late for</td><td> </td><td class="right">      because, at this late stage in the 3WHS, it would be too late for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      a negotiation between the endpoints to be completed.  A similar</td><td> </td><td class="right">      a negotiation between the endpoints to be completed.  A similar</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      requirement not to reject unexpected initial values in AccECN TCP</td><td> </td><td class="right">      requirement not to reject unexpected initial values in AccECN TCP</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Options (Section 3.2.3.2.4) is for the same purpose.  If traversal</td><td> </td><td class="right">      Options (Section 3.2.3.2.4) is for the same purpose.  If traversal</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      of AccECN TCP Options were reliable, this would have enabled a far</td><td> </td><td class="right">      of AccECN TCP Options were reliable, this would have enabled a far</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      wider range of future variation of the whole AccECN protocol.</td><td> </td><td class="right">      wider range of future variation of the whole AccECN protocol.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      Nonetheless, it could be used to reliably negotiate a wide range</td><td> </td><td class="right">      Nonetheless, it could be used to reliably negotiate a wide range</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      of variation in the semantics of the AccECN Option.</td><td> </td><td class="right">      of variation in the semantics of the AccECN Option.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Future non-AccECN variants:  Five codepoints out of the 8 possible in</td><td> </td><td class="right">   Future non-AccECN variants:  Five codepoints out of the 8 possible in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      the 3 TCP header flags used by AccECN are unused on the initial</td><td> </td><td class="right">      the 3 TCP header flags used by AccECN are unused on the initial</td><td class="lineno"><br></td></tr>
      <tr id="diff0133"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      SYN (in the order <span class="delete">AE,CWR,ECE): 001, 010, 100, 101, 110.</span></td><td> </td><td class="rblock">      SYN (in the order <span class="insert">(AE,CWR,ECE)): (0,0,1), (0,1,0), (1,0,0),</span></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Section 3.1.3 ensures that the installed base of AccECN <span class="delete">servers</span></td><td> </td><td class="rblock"><span class="insert">      (1,0,1), (1,1,0).</span>  Section 3.1.3 ensures that the installed base</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      will all assume these are equivalent to AccECN negotiation with</td><td> </td><td class="rblock">      of AccECN <span class="insert">Servers</span> will all assume these are equivalent to AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">111</span> on the SYN.  These codepoints would not allow fall-back to</td><td> </td><td class="rblock">      negotiation with <span class="insert">(1,1,1)</span> on the SYN.  These codepoints would not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      Classic ECN support for a <span class="delete">server</span> that did not understand them, but</td><td> </td><td class="rblock">      allow fall-back to Classic ECN support for a <span class="insert">Server</span> that did not</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      this approach ensures they are available in future, perhaps for</td><td> </td><td class="rblock">      understand them, but this approach ensures they are available in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      uses other than ECN alongside the AccECN scheme.  All possible</td><td> </td><td class="rblock">      future, perhaps for uses other than ECN alongside the AccECN</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      combinations of SYN/ACK could be used in response except either</td><td> </td><td class="rblock">      scheme.  All possible combinations of SYN/ACK could be used in</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">      <span class="delete">000</span> or reflection of the same values sent on the SYN.</td><td> </td><td class="rblock">      response except either <span class="insert">(0,0,0)</span> or reflection of the same values</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock"><br></td><td> </td><td class="rblock">      sent on the SYN.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      In order to extend AccECN or ECN in future, other ways could be</td><td> </td><td class="right">      In order to extend AccECN or ECN in future, other ways could be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      resorted to, although their traversal properties are likely to be</td><td> </td><td class="right">      resorted to, although their traversal properties are likely to be</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      inferior.  They include a new TCP option; using the remaining</td><td> </td><td class="right">      inferior.  They include a new TCP option; using the remaining</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      reserved flags in the main TCP header (preferably extending the</td><td> </td><td class="right">      reserved flags in the main TCP header (preferably extending the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      3-bit combinations used by AccECN to 4-bit combinations, rather</td><td> </td><td class="right">      3-bit combinations used by AccECN to 4-bit combinations, rather</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      than burning one bit for just one state); a non-zero urgent</td><td> </td><td class="right">      than burning one bit for just one state); a non-zero urgent</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      pointer in combination with the URG flag cleared; or some other</td><td> </td><td class="right">      pointer in combination with the URG flag cleared; or some other</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">      unexpected combination of fields yet to be invented.</td><td> </td><td class="right">      unexpected combination of fields yet to be invented.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">Acknowledgements</td><td> </td><td class="right">Acknowledgements</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   We want to thank Koen De Schepper, Praveen Balasubramanian, Michael</td><td> </td><td class="right">   We want to thank Koen De Schepper, Praveen Balasubramanian, Michael</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Welzl, Gorry Fairhurst, David Black, Spencer Dawkins, Michael Scharf,</td><td> </td><td class="right">   Welzl, Gorry Fairhurst, David Black, Spencer Dawkins, Michael Scharf,</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Michael Tüxen, Yuchung Cheng, Kenjiro Cho, Olivier Tilmans, Ilpo</td><td> </td><td class="right">   Michael Tüxen, Yuchung Cheng, Kenjiro Cho, Olivier Tilmans, Ilpo</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Järvinen, Neal Cardwell, Yoshifumi Nishida, Martin Duke, Jonathan</td><td> </td><td class="right">   Järvinen, Neal Cardwell, Yoshifumi Nishida, Martin Duke, Jonathan</td><td class="lineno"><br></td></tr>
      <tr id="diff0134"><td><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   Morton, Vidhi Goel, Alex <span class="delete">Burr and</span> Markku Kojo for their input and</td><td> </td><td class="rblock">   Morton, Vidhi Goel, Alex <span class="insert">Burr,</span> Markku Kojo <span class="insert">and Grenville Armitage</span> for</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   discussion.  The idea of using the three ECN-related TCP flags as one</td><td> </td><td class="rblock">   their input and discussion.  The idea of using the three ECN-related</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   field for more accurate TCP-ECN feedback was first introduced in the</td><td> </td><td class="rblock">   TCP flags as one field for more accurate TCP-ECN feedback was first</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="lblock">   re-ECN protocol that was the ancestor of ConEx.</td><td> </td><td class="rblock">   introduced in the re-ECN protocol that was the ancestor of ConEx.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Bob Briscoe was part-funded by the Comcast Innovation Fund, the</td><td> </td><td class="right">   Bob Briscoe was part-funded by the Comcast Innovation Fund, the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   European Community under its Seventh Framework Programme through the</td><td> </td><td class="right">   European Community under its Seventh Framework Programme through the</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Reducing Internet Transport Latency (RITE) project (ICT-317700) and</td><td> </td><td class="right">   Reducing Internet Transport Latency (RITE) project (ICT-317700) and</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   through the Trilogy 2 project (ICT-317756), and the Research Council</td><td> </td><td class="right">   through the Trilogy 2 project (ICT-317756), and the Research Council</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   of Norway through the TimeIn project.  The views expressed here are</td><td> </td><td class="right">   of Norway through the TimeIn project.  The views expressed here are</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   solely those of the authors.</td><td> </td><td class="right">   solely those of the authors.</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Mirja Kühlewind was partly supported by the European Commission under</td><td> </td><td class="right">   Mirja Kühlewind was partly supported by the European Commission under</td><td class="lineno"><br></td></tr>
      <tr><td class="lineno"><br></td><td class="left">   Horizon 2020 grant agreement no. 688421 Measurement and Architecture</td><td> </td><td class="right">   Horizon 2020 grant agreement no. 688421 Measurement and Architecture</td><td class="lineno"><br></td></tr>

     <tr><td><br></td><td class="left"><br></td><td> </td><td class="right"><br></td><td><br></td></tr>
     <tr id="end" bgcolor="gray"><th colspan="5" align="center">&nbsp;End of changes. 134 change blocks.&nbsp;</th></tr>
     <tr class="stats"><td><br></td><th><i>313 lines changed or deleted</i></th><th><i> </i><br>
</th><th><i>329 lines changed or added</i></th><td><br></td></tr>
     <tr><td colspan="5" class="small" align="center"><br>This html diff was produced by rfcdiff 1.45. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/">http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </tbody></table>
   
   
</body></html>